/*!
 * UEditor
 * version: ueditor
 * build: Thu May 29 2014 16:47:49 GMT+0800 (\u4e2d\u56fd\u6807\u51c6\u65f6\u95f4)
 */
(function(){function v(n,t,i){var r;return t=t.toLowerCase(),(r=n.__allListeners||i&&(n.__allListeners={}))&&(r[t]||i&&(r[t]=[]))}function c(n,t,i,r,u,f){var e=r&&n[t],o;!e&&(e=n[i]);while(!e&&(o=(o||n).parentNode)){if(o.tagName=="BODY"||f&&!f(o))return null;e=o[i]}return e&&u&&!u(e)?c(e,t,i,!1,u):e}var l,f,d,p,w,a,s,u;UEDITOR_CONFIG=window.UEDITOR_CONFIG||{},u=window.baidu||{},window.baidu=u,window.UE=u.editor=window.UE||{},UE.plugins={},UE.commands={},UE.instants={},UE.I18N={},UE._customizeUI={},UE.version="1.4.3";var e=UE.dom={},r=UE.browser=function(){var i=navigator.userAgent.toLowerCase(),e=window.opera,n={ie:/(msie\s|trident.*rv:)([\w.]+)/.test(i),opera:!!e&&e.version,webkit:i.indexOf(" applewebkit/")>-1,mac:i.indexOf("macintosh")>-1,quirks:document.compatMode=="BackCompat"},t,f,r,u;return n.gecko=navigator.product=="Gecko"&&!n.webkit&&!n.opera&&!n.ie,t=0,n.ie&&(f=i.match(/(?:msie\s([\w.]+))/),r=i.match(/(?:trident.*rv:([\w.]+))/),t=f&&r&&f[1]&&r[1]?Math.max(f[1]*1,r[1]*1):f&&f[1]?f[1]*1:r&&r[1]?r[1]*1:0,n.ie11Compat=document.documentMode==11,n.ie9Compat=document.documentMode==9,n.ie8=!!document.documentMode,n.ie8Compat=document.documentMode==8,n.ie7Compat=t==7&&!document.documentMode||document.documentMode==7,n.ie6Compat=t<7||n.quirks,n.ie9above=t>8,n.ie9below=t<9,n.ie11above=t>10,n.ie11below=t<11),n.gecko&&(u=i.match(/rv:([\d\.]+)/),u&&(u=u[1].split("."),t=u[0]*1e4+(u[1]||0)*100+(u[2]||0)*1)),/chrome\/(\d+\.\d)/i.test(i)&&(n.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(i)&&!/chrome/i.test(i)&&(n.safari=+(RegExp.$1||RegExp.$2)),n.opera&&(t=parseFloat(e.version())),n.webkit&&(t=parseFloat(i.match(/ applewebkit\/(\d+)/)[1])),n.version=t,n.isCompatible=!n.mobile&&(n.ie&&t>=6||n.gecko&&t>=10801||n.opera&&t>=9.5||n.air&&t>=1||n.webkit&&t>=522||!1),n}(),o=r.ie,nt=r.webkit,g=r.gecko,b=r.opera,t=UE.utils={each:function(n,t,i){var r,f,u;if(n==null)return;if(n.length===+n.length){for(r=0,f=n.length;r<f;r++)if(t.call(i,n[r],r,n)===!1)return!1}else for(u in n)if(n.hasOwnProperty(u))if(t.call(i,n[u],u,n)===!1)return!1},makeInstance:function(n){var t=new Function;return t.prototype=n,n=new t,t.prototype=null,n},extend:function(n,t,i){if(t)for(var r in t)(!i||!n.hasOwnProperty(r))&&(n[r]=t[r]);return n},extend2:function(n){for(var u=arguments,r,t,i=1;i<u.length;i++){r=u[i];for(t in r)n.hasOwnProperty(t)||(n[t]=r[t])}return n},inherits:function(n,i){var u=n.prototype,r=t.makeInstance(i.prototype);return t.extend(r,u,!0),n.prototype=r,r.constructor=n},bind:function(n,t){return function(){return n.apply(t,arguments)}},defer:function(n,t,i){var r;return function(){i&&clearTimeout(r),r=setTimeout(n,t)}},indexOf:function(n,t,i){var r=-1;return i=this.isNumber(i)?i:0,this.each(n,function(n,u){if(u>=i&&n===t)return r=u,!1}),r},removeItem:function(n,t){for(var i=0,r=n.length;i<r;i++)n[i]===t&&(n.splice(i,1),i--)},trim:function(n){return n.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(n){if(!n)return{};n=t.isArray(n)?n:n.split(",");for(var u=0,i,r={};i=n[u++];)r[i.toUpperCase()]=r[i]=1;return r},unhtml:function(n,t){return n?n.replace(t||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp|#\d+);)?/g,function(n,t){return t?n:({"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"})[n]}):""},html:function(n){return n?n.replace(/&((g|l|quo)t|amp|#39|nbsp);/g,function(n){return({"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'","&nbsp;":" "})[n]}):""},cssStyleToDomStyle:function(){var t=document.createElement("div").style,n={"float":t.cssFloat!=undefined?"cssFloat":t.styleFloat!=undefined?"styleFloat":"float"};return function(t){return n[t]||(n[t]=t.toLowerCase().replace(/-./g,function(n){return n.charAt(1).toUpperCase()}))}}(),loadFile:function(){function n(n,i){try{for(var u=0,r;r=t[u++];)if(r.doc===n&&r.url==(i.src||i.href))return r}catch(f){return null}}var t=[];return function(i,r,u){var e=n(i,r),s,f,o;if(e){e.ready?u&&u():e.funs.push(u);return}t.push({doc:i,url:r.src||r.href,funs:[u]});if(!i.body){s=[];for(o in r){if(o=="tag")continue;s.push(o+'="'+r[o]+'"')}i.write("<"+r.tag+" "+s.join(" ")+" ></"+r.tag+">");return}if(r.id&&i.getElementById(r.id))return;f=i.createElement(r.tag),delete r.tag;for(o in r)f.setAttribute(o,r[o]);f.onload=f.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){e=n(i,r);if(e.funs.length>0){e.ready=1;for(var t;t=e.funs.pop();)t()}f.onload=f.onreadystatechange=null}},f.onerror=function(){throw Error("The load "+(r.href||r.src)+" fails,check the url settings of file ueditor.config.js ");},i.getElementsByTagName("head")[0].appendChild(f)}}(),isEmptyObject:function(n){if(n==null)return!0;if(this.isArray(n)||this.isString(n))return n.length===0;for(var t in n)if(n.hasOwnProperty(t))return!1;return!0},fixColor:function(n,t){var r,u,i;if(/color/i.test(n)&&/rgba?/.test(t)){r=t.split(",");if(r.length>3)return"";for(t="#",u=0;i=r[u++];)i=parseInt(i.replace(/[^\d]/gi,""),10).toString(16),t+=i.length==1?"0"+i:i;t=t.toUpperCase()}return t},optCss:function(n){function r(n,t){var e;if(!n)return"";var r=n.top,u=n.bottom,i=n.left,f=n.right,o="";if(!r||!i||!u||!f)for(e in n)o+=";"+t+"-"+e+":"+n[e]+";";else o+=";"+t+":"+(r==u&&u==i&&i==f?r:r==u&&i==f?r+" "+i:i==f?r+" "+i+" "+u:r+" "+f+" "+u+" "+i)+";";return o}var i,t,u;return n=n.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(n,r,u,f){if(f.split(" ").length==1)switch(r){case"padding":return!i&&(i={}),i[u]=f,"";case"margin":return!t&&(t={}),t[u]=f,"";case"border":return f=="initial"?"":n}return n}),n+=r(i,"padding")+r(t,"margin"),n.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(n,t){return t?t+";;":";"})},clone:function(n,i){var u,r;i=i||{};for(r in n)n.hasOwnProperty(r)&&(u=n[r],typeof u=="object"?(i[r]=t.isArray(u)?[]:{},t.clone(n[r],i[r])):i[r]=u);return i},transUnitToPx:function(n){if(!/(pt|cm)/.test(n))return n;var t;n.replace(/([\d.]+)(\w+)/,function(i,r,u){n=r,t=u});switch(t){case"cm":n=parseFloat(n)*25;break;case"pt":n=Math.round(parseFloat(n)*96/72)}return n+(n?"px":"")},domReady:function(){function n(n){n.isReady=!0;for(var i;i=t.pop();i());}var t=[];return function(i,u){u=u||window;var f=u.document;i&&t.push(i),f.readyState==="complete"?n(f):(f.isReady&&n(f),r.ie&&r.version!=11?((function(){if(f.isReady)return;try{f.documentElement.doScroll("left")}catch(t){setTimeout(arguments.callee,0);return}n(f)})(),u.attachEvent("onload",function(){n(f)})):(f.addEventListener("DOMContentLoaded",function(){f.removeEventListener("DOMContentLoaded",arguments.callee,!1),n(f)},!1),u.addEventListener("load",function(){n(f)},!1)))}}(),cssRule:r.ie&&r.version!=11?function(n,t,i){var u,r;if(t===undefined||t&&t.nodeType&&t.nodeType==9)return i=t&&t.nodeType&&t.nodeType==9?t:i||document,u=i.indexList||(i.indexList={}),r=u[n],r!==undefined?i.styleSheets[r].cssText:undefined;i=i||document,u=i.indexList||(i.indexList={}),r=u[n];if(t==="")return r!==undefined?(i.styleSheets[r].cssText="",delete u[n],!0):!1;r!==undefined?sheetStyle=i.styleSheets[r]:(sheetStyle=i.createStyleSheet("",r=i.styleSheets.length),u[n]=r),sheetStyle.cssText=t}:function(n,t,i){var u,r;if(t===undefined||t&&t.nodeType&&t.nodeType==9)return i=t&&t.nodeType&&t.nodeType==9?t:i||document,r=i.getElementById(n),r?r.innerHTML:undefined;i=i||document,r=i.getElementById(n);if(t==="")return r?(r.parentNode.removeChild(r),!0):!1;r?r.innerHTML=t:(r=i.createElement("style"),r.id=n,r.innerHTML=t,i.getElementsByTagName("head")[0].appendChild(r))},sort:function(n,t){var i,e,r,f,u;for(t=t||function(n,t){return n.localeCompare(t)},i=0,e=n.length;i<e;i++)for(r=i,f=n.length;r<f;r++)t(n[i],n[r])>0&&(u=n[i],n[i]=n[r],n[r]=u);return n},serializeParam:function(n){var u=[],i,r;for(i in n){if(i=="method"||i=="timeout"||i=="async")continue;if((typeof n[i]).toLowerCase()=="function"||(typeof n[i]).toLowerCase()=="object"){if(t.isArray(n[i]))for(r=0;r<n[i].length;r++)u.push(encodeURIComponent(i)+"[]="+encodeURIComponent(n[i][r]))}else u.push(encodeURIComponent(i)+"="+encodeURIComponent(n[i]))}return u.join("&")},formatUrl:function(n){var t=n.replace(/&&/g,"&");return t=t.replace(/\?&/g,"?"),t=t.replace(/&$/g,""),t=t.replace(/&#/g,"#"),t=t.replace(/&+/g,"&")},isCrossDomainUrl:function(n){var t=document.createElement("a");return t.href=n,r.ie&&(t.href=t.href),!(t.protocol==location.protocol&&t.hostname==location.hostname&&(t.port==location.port||t.port=="80"&&location.port==""||t.port==""&&location.port=="80"))},clearEmptyAttrs:function(n){for(var t in n)n[t]===""&&delete n[t];return n},str2json:function(n){return t.isString(n)?window.JSON?JSON.parse(n):new Function("return "+t.trim(n||""))():null},json2str:function(){if(window.JSON)return JSON.stringify;var u={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function f(n){return/["\\\x00-\x1f]/.test(n)&&(n=n.replace(/["\\\x00-\x1f]/g,function(n){var t=u[n];return t?t:(t=n.charCodeAt(),"\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16))})),'"'+n+'"'}function r(n){for(var r=["["],e=n.length,f,u,i=0;i<e;i++){u=n[i];switch(typeof u){case"undefined":case"function":case"unknown":break;default:f&&r.push(","),r.push(t.json2str(u)),f=1}}return r.push("]"),r.join("")}function n(n){return n<10?"0"+n:n}function i(t){return'"'+t.getFullYear()+"-"+n(t.getMonth()+1)+"-"+n(t.getDate())+"T"+n(t.getHours())+":"+n(t.getMinutes())+":"+n(t.getSeconds())+'"'}return function(n){var u,o,h,s,e;switch(typeof n){case"undefined":return"undefined";case"number":return isFinite(n)?String(n):"null";case"string":return f(n);case"boolean":return String(n);default:if(n===null)return"null";if(t.isArray(n))return r(n);if(t.isDate(n))return i(n);u=["{"],o=t.json2str;for(e in n)if(Object.prototype.hasOwnProperty.call(n,e)){s=n[e];switch(typeof s){case"undefined":case"unknown":case"function":break;default:h&&u.push(","),h=1,u.push(o(e)+":"+o(s))}}return u.push("}"),u.join("")}}}()};t.each(["String","Function","Array","Number","RegExp","Object","Date"],function(n){UE.utils["is"+n]=function(t){return Object.prototype.toString.apply(t)=="[object "+n+"]"}}),l=UE.EventBase=function(){},l.prototype={addListener:function(n,i){n=t.trim(n).split(/\s+/);for(var u=0,r;r=n[u++];)v(this,r,!0).push(i)},on:function(n,t){return this.addListener(n,t)},off:function(n,t){return this.removeListener(n,t)},trigger:function(){return this.fireEvent.apply(this,arguments)},removeListener:function(n,i){n=t.trim(n).split(/\s+/);for(var u=0,r;r=n[u++];)t.removeItem(v(this,r)||[],i)},fireEvent:function(){for(var u=arguments[0],e,i,f,n,r,u=t.trim(u).split(" "),o=0;e=u[o++];){i=v(this,e);if(i){r=i.length;while(r--){if(!i[r])continue;n=i[r].apply(this,arguments);if(n===!0)return n;n!==undefined&&(f=n)}}(n=this["on"+e.toLowerCase()])&&(f=n.apply(this,arguments))}return f}},f=e.dtd=function(){function n(n){for(var t in n)n[t.toUpperCase()]=n[t];return n}var r=t.extend2,h=n({isindex:1,fieldset:1}),k=n({input:1,button:1,select:1,textarea:1,label:1}),b=r(n({a:1}),k),c=r({iframe:1},b),o=n({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),w=n({ins:1,del:1,script:1,style:1}),d=r(n({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),w),nt=r(n({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),d),s=r(n({p:1}),nt),tt=r(n({iframe:1}),nt,k),g=n({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),i=r(n({a:0}),tt),l=n({tr:1}),f=n({"#":1}),p=r(n({param:1}),g),u=r(n({form:1}),h,c,o,s),e=n({li:1,ol:1,ul:1}),ft=n({style:1,script:1}),a=n({base:1,link:1,meta:1,title:1}),ut=r(a,ft),y=n({head:1,body:1}),rt=n({html:1}),v=n({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),it=n({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});return n({$nonBodyContent:r(rt,y,a),$block:v,$inline:i,$inlineWithA:r(n({a:1}),i),$body:r(n({script:1,style:1}),v),$cdata:n({script:1,style:1}),$empty:it,$nonChild:n({iframe:1,textarea:1}),$listItem:n({dd:1,dt:1,li:1}),$list:n({ul:1,ol:1,dl:1}),$isNotEmpty:n({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:n({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:n({p:1,div:1}),$tableContent:n({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:n({pre:1,script:1,style:1,textarea:1}),html:y,head:ut,style:f,script:f,body:u,base:{},link:{},meta:{},title:f,col:{},tr:n({td:1,th:1}),img:{},embed:{},colgroup:n({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:u,td:u,br:{},th:u,center:u,kbd:i,button:r(s,o),basefont:{},h5:i,h4:i,samp:i,h6:i,ol:e,h1:i,h3:i,option:f,h2:i,form:r(h,c,o,s),select:n({optgroup:1,option:1}),font:i,ins:i,menu:e,abbr:i,label:i,table:n({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:i,tfoot:l,cite:i,li:u,input:{},iframe:u,strong:i,textarea:f,noframes:u,big:i,small:i,span:n({"#":1,br:1,b:1,strong:1,u:1,i:1,em:1,sub:1,sup:1,strike:1,span:1}),hr:i,dt:i,sub:i,optgroup:n({option:1}),param:{},bdo:i,"var":i,div:u,object:p,sup:i,dd:u,strike:i,area:{},dir:e,map:r(n({area:1,form:1,p:1}),h,w,o),applet:p,dl:n({dt:1,dd:1}),del:i,isindex:{},fieldset:r(n({legend:1}),g),thead:l,ul:e,acronym:i,b:i,a:r(n({a:1}),tt),blockquote:r(n({td:1,tr:1,tbody:1,li:1}),u),caption:i,i:i,u:i,tbody:l,s:i,address:r(c,s),tt:i,legend:i,q:i,pre:r(d,b),p:r(n({a:1}),i),em:i,dfn:i})}();var y=o&&r.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},k=t.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]),n=e.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:o&&r.version=="6"?"\ufeff":"\u200b",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(n,t){var i,f,u,r;if(n===t)return 0;f=[n],u=[t],i=n;while(i=i.parentNode){if(i===t)return 10;f.push(i)}i=t;while(i=i.parentNode){if(i===n)return 20;u.push(i)}f.reverse(),u.reverse();if(f[0]!==u[0])return 1;r=-1;while(r++,f[r]===u[r]);n=f[r],t=u[r];while(n=n.nextSibling)if(n===t)return 4;return 2},getNodeIndex:function(n,t){var i=n,r=0;while(i=i.previousSibling){if(t&&i.nodeType==3){i.nodeType!=i.nextSibling.nodeType&&r++;continue}r++}return r},inDoc:function(t,i){return n.getPosition(t,i)==10},findParent:function(t,i,r){if(t&&!n.isBody(t)){t=r?t:t.parentNode;while(t){if(!i||i(t)||n.isBody(t))return i&&!i(t)&&n.isBody(t)?null:t;t=t.parentNode}}return null},findParentByTagName:function(i,r,u,f){return r=t.listToMap(t.isArray(r)?r:[r]),n.findParent(i,function(n){return r[n.tagName]&&!(f&&f(n))},u)},findParents:function(t,i,r,u){var f=i&&(r&&r(t)||!r)?[t]:[];while(t=n.findParent(t,r))f.push(t);return u?f:f.reverse()},insertAfter:function(n,t){return n.nextSibling?n.parentNode.insertBefore(t,n.nextSibling):n.parentNode.appendChild(t)},remove:function(n,t){var i=n.parentNode,r;if(i){if(t&&n.hasChildNodes())while(r=n.firstChild)i.insertBefore(r,n);i.removeChild(n)}return n},getNextDomNode:function(n,t,i,r){return c(n,"firstChild","nextSibling",t,i,r)},getPreDomNode:function(n,t,i,r){return c(n,"lastChild","previousSibling",t,i,r)},isBookmarkNode:function(n){return n.nodeType==1&&n.id&&/^_baidu_bookmark_/i.test(n.id)},getWindow:function(n){var t=n.ownerDocument||n;return t.defaultView||t.parentWindow},getCommonAncestor:function(n,t){if(n===t)return n;var u=[n],f=[t],i=n,r=-1;while(i=i.parentNode){if(i===t)return i;u.push(i)}i=t;while(i=i.parentNode){if(i===n)return i;f.push(i)}u.reverse(),f.reverse();while(r++,u[r]===f[r]);return r==0?null:u[r-1]},clearEmptySibling:function(t,i,r){function u(t,i){var r;while(t&&!n.isBookmarkNode(t)&&(n.isEmptyInlineElement(t)||!new RegExp("[^\x09\x0a\x0d"+n.fillChar+"]").test(t.nodeValue)))r=t[i],n.remove(t),t=r}!i&&u(t.nextSibling,"nextSibling"),!r&&u(t.previousSibling,"previousSibling")},split:function(t,i){var e=t.ownerDocument,o,u,f;return r.ie&&i==t.nodeValue.length?(o=e.createTextNode(""),n.insertAfter(t,o)):(u=t.splitText(i),r.ie8&&(f=e.createTextNode(""),n.insertAfter(u,f),n.remove(f)),u)},isWhitespace:function(t){return!new RegExp("[^ \x09\x0a\x0d"+n.fillChar+"]").test(t.nodeValue)},getXY:function(n){var i=0,t=0;while(n.offsetParent)t+=n.offsetTop,i+=n.offsetLeft,n=n.offsetParent;return{x:i,y:t}},on:function(n,i,r){var o=t.isArray(i)?i:t.trim(i).split(/\s+/),f=o.length,u,e;if(f)while(f--)i=o[f],n.addEventListener?n.addEventListener(i,r,!1):(r._d||(r._d={els:[]}),u=i+r.toString(),e=t.indexOf(r._d.els,n),(!r._d[u]||e==-1)&&(e==-1&&r._d.els.push(n),r._d[u]||(r._d[u]=function(n){return r.call(n.srcElement,n||window.event)}),n.attachEvent("on"+i,r._d[u])));n=null},un:function(n,i,r){var o=t.isArray(i)?i:t.trim(i).split(/\s+/),e=o.length,u,f;if(e)while(e--){i=o[e];if(n.removeEventListener)n.removeEventListener(i,r,!1);else{u=i+r.toString();try{n.detachEvent("on"+i,r._d?r._d[u]:r)}catch(s){}r._d&&r._d[u]&&(f=t.indexOf(r._d.els,n),f!=-1&&r._d.els.splice(f,1),r._d.els.length==0&&delete r._d[u])}}},isSameElement:function(t,i){var h,s,r,u,f,c,e;if(t.tagName!=i.tagName)return!1;h=t.attributes,s=i.attributes;if(!o&&h.length!=s.length)return!1;for(f=0,c=0,e=0;r=h[e++];){if(r.nodeName=="style"){r.specified&&f++;if(n.isSameStyle(t,i))continue;else return!1}if(o)if(r.specified)f++,u=s.getNamedItem(r.nodeName);else continue;else u=i.attributes[r.nodeName];if(!u.specified||r.nodeValue!=u.nodeValue)return!1}if(o){for(e=0;u=s[e++];)u.specified&&c++;if(f!=c)return!1}return!0},isSameStyle:function(n,i){var u=n.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),f=i.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),e,s,o;if(r.opera){u=n.style,f=i.style;if(u.length!=f.length)return!1;for(e in u){if(/^(\d+|csstext)$/i.test(e))continue;if(u[e]!=f[e])return!1}return!0}if(!u||!f)return u==f;u=u.split(";"),f=f.split(";");if(u.length!=f.length)return!1;for(s=0;o=u[s++];)if(t.indexOf(f,o)==-1)return!1;return!0},isBlockElm:function(t){return t.nodeType==1&&(f.$block[t.tagName]||k[n.getComputedStyle(t,"display")])&&!f.$nonChild[t.tagName]},isBody:function(n){return n&&n.nodeType==1&&n.tagName.toLowerCase()=="body"},breakParent:function(t,i){var r,f=t,o=t,u,e;do{f=f.parentNode,u?(r=f.cloneNode(!1),r.appendChild(u),u=r,r=f.cloneNode(!1),r.appendChild(e),e=r):(u=f.cloneNode(!1),e=u.cloneNode(!1));while(r=o.previousSibling)u.insertBefore(r,u.firstChild);while(r=o.nextSibling)e.appendChild(r);o=f}while(i!==f);return r=i.parentNode,r.insertBefore(u,i),r.insertBefore(e,i),r.insertBefore(t,e),n.remove(i),t},isEmptyInlineElement:function(t){if(t.nodeType!=1||!f.$removeEmpty[t.tagName])return 0;t=t.firstChild;while(t){if(n.isBookmarkNode(t))return 0;if(t.nodeType==1&&!n.isEmptyInlineElement(t)||t.nodeType==3&&!n.isWhitespace(t))return 0;t=t.nextSibling}return 1},trimWhiteTextNode:function(t){function i(i){var r;while((r=t[i])&&r.nodeType==3&&n.isWhitespace(r))t.removeChild(r)}i("firstChild"),i("lastChild")},mergeChild:function(i,r,u){for(var c=n.getElementsByTagName(i,i.tagName.toLowerCase()),f,e,s,o,h=0;f=c[h++];){if(!f.parentNode||n.isBookmarkNode(f))continue;if(f.tagName.toLowerCase()=="span"){if(i===f.parentNode){n.trimWhiteTextNode(i);if(i.childNodes.length==1){i.style.cssText=f.style.cssText+";"+i.style.cssText,n.remove(f,!0);continue}}f.style.cssText=i.style.cssText+";"+f.style.cssText;if(u){e=u.style;if(e)for(e=e.split(";"),s=0;o=e[s++];)f.style[t.cssStyleToDomStyle(o.split(":")[0])]=o.split(":")[1]}n.isSameStyle(f,i)&&n.remove(f,!0);continue}n.isSameElement(i,f)&&n.remove(f,!0)}},getElementsByTagName:function(i,r,u){var s,e,c,l,h,o,f;for(u&&t.isString(u)&&(s=u,u=function(t){return n.hasClass(t,s)}),r=t.trim(r).replace(/[ ]{2,}/g," ").split(" "),e=[],c=0;l=r[c++];)for(h=i.getElementsByTagName(l),o=0;f=h[o++];)(!u||u(f))&&e.push(f);return e},mergeToParent:function(t){var i=t.parentNode;while(i&&f.$removeEmpty[i.tagName]){if(i.tagName==t.tagName||i.tagName=="A"){n.trimWhiteTextNode(i);if(i.tagName=="SPAN"&&!n.isSameStyle(i,t)||i.tagName=="A"&&t.tagName=="SPAN")if(i.childNodes.length>1||i!==t.parentNode){t.style.cssText=i.style.cssText+";"+t.style.cssText,i=i.parentNode;continue}else i.style.cssText+=";"+t.style.cssText,i.tagName=="A"&&(i.style.textDecoration="underline");if(i.tagName!="A"){i===t.parentNode&&n.remove(t,!0);break}}i=i.parentNode}},mergeSibling:function(t,i,r){function u(t,i,r){var u;if((u=r[t])&&!n.isBookmarkNode(u)&&u.nodeType==1&&n.isSameElement(r,u)){while(u.firstChild)i=="firstChild"?r.insertBefore(u.lastChild,r.firstChild):r.appendChild(u.firstChild);n.remove(u)}}!i&&u("previousSibling","firstChild",t),!r&&u("nextSibling","lastChild",t)},unSelectable:o&&r.ie9below||r.opera?function(n){n.onselectstart=function(){return!1},n.onclick=n.onkeyup=n.onkeydown=function(){return!1},n.unselectable="on",n.setAttribute("unselectable","on");for(var i=0,t;t=n.all[i++];)switch(t.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:t.unselectable="on",n.setAttribute("unselectable","on")}}:function(n){n.style.MozUserSelect=n.style.webkitUserSelect=n.style.msUserSelect=n.style.KhtmlUserSelect="none"},removeAttributes:function(n,i){var e,u,f;for(i=t.isArray(i)?i:t.trim(i).replace(/[ ]{2,}/g," ").split(" "),e=0;u=i[e++];){u=y[u]||u;switch(u){case"className":n[u]="";break;case"style":n.style.cssText="",f=n.getAttributeNode("style"),!r.ie&&f&&n.removeAttributeNode(f)}n.removeAttribute(u)}},createElement:function(t,i,r){return n.setAttributes(t.createElement(i),r)},setAttributes:function(n,t){var i,r;for(i in t)if(t.hasOwnProperty(i)){r=t[i];switch(i){case"class":n.className=r;break;case"style":n.style.cssText=n.style.cssText+";"+r;break;case"innerHTML":n[i]=r;break;case"value":n.value=r;break;default:n.setAttribute(y[i]||i,r)}}return n},getComputedStyle:function(i,u){var h="width height top left",e,s,o;if(h.indexOf(u)>-1)return i["offset"+u.replace(/^\w/,function(n){return n.toUpperCase()})]+"px";i.nodeType==3&&(i=i.parentNode);if(r.ie&&r.version<9&&u=="font-size"&&!i.style.fontSize&&!f.$empty[i.tagName]&&!f.$nonChild[i.tagName])return e=i.ownerDocument.createElement("span"),e.style.cssText="padding:0;border:0;font-family:simsun;",e.innerHTML=".",i.appendChild(e),s=e.offsetHeight,i.removeChild(e),e=null,s+"px";try{o=n.getStyle(i,u)||(window.getComputedStyle?n.getWindow(i).getComputedStyle(i,"").getPropertyValue(u):(i.currentStyle||i.style)[t.cssStyleToDomStyle(u)])}catch(c){return""}return t.transUnitToPx(t.fixColor(u,o))},removeClasses:function(i,r){try{r=t.isArray(r)?r:t.trim(r).replace(/[ ]{2,}/g," ").split(" ");for(var e=0,f,u=i.className;f=r[e++];)u=u.replace(new RegExp("\\b"+f+"\\b"),"");u=t.trim(u).replace(/[ ]{2,}/g," "),u?i.className=u:n.removeAttributes(i,["class"])}catch(o){}},addClass:function(n,i){if(!n)return;i=t.trim(i).replace(/[ ]{2,}/g," ").split(" ");for(var f=0,r,u=n.className;r=i[f++];)new RegExp("\\b"+r+"\\b").test(u)||(u+=" "+r);n.className=t.trim(u)},hasClass:function(n,i){if(t.isRegExp(i))return i.test(n.className);i=t.trim(i).replace(/[ ]{2,}/g," ").split(" ");for(var u=0,r,f=n.className;r=i[u++];)if(!new RegExp("\\b"+r+"\\b","i").test(f))return!1;return u-1==i.length},preventDefault:function(n){n.preventDefault?n.preventDefault():n.returnValue=!1},removeStyle:function(i,u){r.ie?(u=="color"&&(u="(^|;)"+u),i.style.cssText=i.style.cssText.replace(new RegExp(u+"[^:]*:[^;]+;?","ig"),"")):i.style.removeProperty?i.style.removeProperty(u):i.style.removeAttribute(t.cssStyleToDomStyle(u)),i.style.cssText||n.removeAttributes(i,["style"])},getStyle:function(n,i){var r=n.style[t.cssStyleToDomStyle(i)];return t.fixColor(i,r)},setStyle:function(n,i,r){n.style[t.cssStyleToDomStyle(i)]=r,t.trim(n.style.cssText)||this.removeAttributes(n,"style")},setStyles:function(t,i){for(var r in i)i.hasOwnProperty(r)&&n.setStyle(t,r,i[r])},removeDirtyAttr:function(n){for(var r=0,t,i=n.getElementsByTagName("*");t=i[r++];)t.removeAttribute("_moz_dirty");n.removeAttribute("_moz_dirty")},getChildCount:function(n,t){var r=0,i=n.firstChild;t=t||function(){return 1};while(i)t(i)&&r++,i=i.nextSibling;return r},isEmptyNode:function(t){return!t.firstChild||n.getChildCount(t,function(t){return!n.isBr(t)&&!n.isBookmarkNode(t)&&!n.isWhitespace(t)})==0},clearSelectedArr:function(t){var i;while(i=t.pop())n.removeAttributes(i,["class"])},scrollToView:function(t,i,r){var h=function(){var n=i.document,t=n.compatMode=="CSS1Compat";return{width:(t?n.documentElement.clientWidth:n.body.clientWidth)||0,height:(t?n.documentElement.clientHeight:n.body.clientHeight)||0}},s=function(n){if("pageXOffset"in n)return{x:n.pageXOffset||0,y:n.pageYOffset||0};var t=n.document;return{x:t.documentElement.scrollLeft||t.body.scrollLeft||0,y:t.documentElement.scrollTop||t.body.scrollTop||0}},o=h().height,u=o*-1+r,e,f;u+=t.offsetHeight||0,e=n.getXY(t),u+=e.y,f=s(i).y,(u>f||u<f-o)&&i.scrollTo(0,u+(u<0?-20:20))},isBr:function(n){return n.nodeType==1&&n.tagName=="BR"},isFillChar:function(t,i){if(t.nodeType!=3)return!1;var r=t.nodeValue;return i?new RegExp("^"+n.fillChar).test(r):!r.replace(new RegExp(n.fillChar,"g"),"").length},isStartInblock:function(t){var r=t.cloneRange(),o=0,i=r.startContainer,e,u,f;if(i.nodeType==1&&i.childNodes[r.startOffset]){i=i.childNodes[r.startOffset],u=i.previousSibling;while(u&&n.isFillChar(u))i=u,u=u.previousSibling}this.isFillChar(i,!0)&&r.startOffset==1&&(r.setStartBefore(i),i=r.startContainer);while(i&&n.isFillChar(i))e=i,i=i.previousSibling;e&&(r.setStartBefore(e),i=r.startContainer),i.nodeType==1&&n.isEmptyNode(i)&&r.startOffset==1&&r.setStart(i,0).collapse(!0);while(!r.startOffset){i=r.startContainer;if(n.isBlockElm(i)||n.isBody(i)){o=1;break}u=r.startContainer.previousSibling;if(u){while(u&&n.isFillChar(u))f=u,u=u.previousSibling;f?r.setStartBefore(f):r.setStartBefore(r.startContainer)}else r.setStartBefore(r.startContainer)}return o&&!n.isBody(r.startContainer)?1:0},isEmptyBlock:function(t,i){if(t.nodeType!=1)return 0;i=i||new RegExp("[ \u00a0\x09\x0d\x0a"+n.fillChar+"]","g");if(t[r.ie?"innerText":"textContent"].replace(i,"").length>0)return 0;for(var u in f.$isNotEmpty)if(t.getElementsByTagName(u).length)return 0;return 1},setViewportOffset:function(n,t){var e=parseInt(n.style.left)|0,f=parseInt(n.style.top)|0,i=n.getBoundingClientRect(),r=t.left-i.left,u=t.top-i.top;r&&(n.style.left=e+r+"px"),u&&(n.style.top=f+u+"px")},fillNode:function(t,i){var u=r.ie?t.createTextNode(n.fillChar):t.createElement("br");i.innerHTML="",i.appendChild(u)},moveChild:function(n,t,i){while(n.firstChild)i&&t.firstChild?t.insertBefore(n.lastChild,t.firstChild):t.appendChild(n.firstChild)},hasNoAttributes:function(n){return r.ie?/^<\w+\s*?>/.test(n.outerHTML):n.attributes.length==0},isCustomeNode:function(n){return n.nodeType==1&&n.getAttribute("_ue_custom_node_")},isTagNode:function(n,t){return n.nodeType==1&&new RegExp("\\b"+n.tagName+"\\b","i").test(t)},filterNodeList:function(n,i,r){var u=[],f;return t.isFunction(i)||(f=i,i=function(n){return t.indexOf(t.isArray(f)?f:f.split(" "),n.tagName.toLowerCase())!=-1}),t.each(n,function(n){i(n)&&u.push(n)}),u.length==0?null:u.length==1||!r?u[0]:u},isInNodeEndBoundary:function(n,t){var i=n.startContainer;if(i.nodeType==3&&n.startOffset!=i.nodeValue.length)return 0;if(i.nodeType==1&&n.startOffset!=i.childNodes.length)return 0;while(i!==t){if(i.nextSibling)return 0;i=i.parentNode}return 1},isBoundaryNode:function(t,i){var r;while(!n.isBody(t)){r=t,t=t.parentNode;if(r!==t[i])return!1}return!0},fillHtml:r.ie11below?"&nbsp;":"<br/>"},h=new RegExp(n.fillChar,"g");(function(){function p(n){n.collapsed=n.startContainer&&n.endContainer&&n.startContainer===n.endContainer&&n.startOffset==n.endOffset}function v(n){return!n.collapsed&&n.startContainer.nodeType==1&&n.startContainer===n.endContainer&&n.endOffset-n.startOffset==1}function y(t,i,r,u){return i.nodeType==1&&(f.$empty[i.tagName]||f.$nonChild[i.tagName])&&(r=n.getNodeIndex(i)+(t?0:1),i=i.parentNode),t?(u.startContainer=i,u.startOffset=r,u.endContainer||u.collapse(!0)):(u.endContainer=i,u.endOffset=r,u.startContainer||u.collapse(!1)),p(u),u}function o(t,i){var r=t.startContainer,o=t.endContainer,h=t.startOffset,w=t.endOffset,v=t.document,b=v.createDocumentFragment(),d,k,u,l,s,y;r.nodeType==1&&(r=r.childNodes[h]||(d=r.appendChild(v.createTextNode("")))),o.nodeType==1&&(o=o.childNodes[w]||(k=o.appendChild(v.createTextNode(""))));if(r===o&&r.nodeType==3)return b.appendChild(v.createTextNode(r.substringData(h,w-h))),i&&(r.deleteData(h,w-h),t.collapse(!0)),b;var f,p,e=b,c=n.findParents(r,!0),a=n.findParents(o,!0);for(u=0;c[u]==a[u];)u++;for(s=u;l=c[s];s++){f=l.nextSibling,l==r?d||(t.startContainer.nodeType==3?(e.appendChild(v.createTextNode(r.nodeValue.slice(h))),i&&r.deleteData(h,r.nodeValue.length-h)):e.appendChild(i?r:r.cloneNode(!0))):(p=l.cloneNode(!1),e.appendChild(p));while(f){if(f===o||f===a[s])break;l=f.nextSibling,e.appendChild(i?f:f.cloneNode(!0)),f=l}e=p}for(e=b,c[u]||(e.appendChild(c[u-1].cloneNode(!1)),e=e.firstChild),s=u;y=a[s];s++){f=y.previousSibling,y==o?!k&&t.endContainer.nodeType==3&&(e.appendChild(v.createTextNode(o.substringData(0,w))),i&&o.deleteData(0,w)):(p=y.cloneNode(!1),e.appendChild(p));if(s!=u||!c[u])while(f){if(f===r)break;y=f.previousSibling,e.insertBefore(i?f:f.cloneNode(!0),e.firstChild),f=y}e=p}return i&&t.setStartBefore(a[u]?c[u]?a[u]:c[u-1]:a[u-1]).collapse(!0),d&&n.remove(d),k&&n.remove(k),b}function a(t,u){try{if(i&&n.inDoc(i,t))if(i.nodeValue.replace(h,"").length)i.nodeValue=i.nodeValue.replace(h,"");else{var f=i.parentNode;n.remove(i);while(f&&n.isEmptyInlineElement(f)&&(r.safari?!(n.getPosition(f,u)&n.POSITION_CONTAINS):!f.contains(u)))i=f.parentNode,n.remove(f),f=i}}catch(e){}}function u(t,i){var r;t=t[i];while(t&&n.isFillChar(t))r=t[i],n.remove(t),t=r}var c=0,s=n.fillChar,i,l=e.Range=function(n){var t=this;t.startContainer=t.startOffset=t.endContainer=t.endOffset=null,t.document=n,t.collapsed=!0};l.prototype={cloneContents:function(){return this.collapsed?null:o(this,0)},deleteContents:function(){var t;return this.collapsed||o(this,1),r.webkit&&(t=this.startContainer,t.nodeType==3&&!t.nodeValue.length&&(this.setStartBefore(t).collapse(!0),n.remove(t))),this},extractContents:function(){return this.collapsed?null:o(this,2)},setStart:function(n,t){return y(!0,n,t,this)},setEnd:function(n,t){return y(!1,n,t,this)},setStartAfter:function(t){return this.setStart(t.parentNode,n.getNodeIndex(t)+1)},setStartBefore:function(t){return this.setStart(t.parentNode,n.getNodeIndex(t))},setEndAfter:function(t){return this.setEnd(t.parentNode,n.getNodeIndex(t)+1)},setEndBefore:function(t){return this.setEnd(t.parentNode,n.getNodeIndex(t))},setStartAtFirst:function(n){return this.setStart(n,0)},setStartAtLast:function(n){return this.setStart(n,n.nodeType==3?n.nodeValue.length:n.childNodes.length)},setEndAtFirst:function(n){return this.setEnd(n,0)},setEndAtLast:function(n){return this.setEnd(n,n.nodeType==3?n.nodeValue.length:n.childNodes.length)},selectNode:function(n){return this.setStartBefore(n).setEndAfter(n)},selectNodeContents:function(n){return this.setStart(n,0).setEndAtLast(n)},cloneRange:function(){var n=this;return new l(n.document).setStart(n.startContainer,n.startOffset).setEnd(n.endContainer,n.endOffset)},collapse:function(n){var t=this;return n?(t.endContainer=t.startContainer,t.endOffset=t.startOffset):(t.startContainer=t.endContainer,t.startOffset=t.endOffset),t.collapsed=!0,t},shrinkBoundary:function(t){function u(t){return t.nodeType==1&&!n.isBookmarkNode(t)&&!f.$empty[t.tagName]&&!f.$nonChild[t.tagName]}var i=this,r,e=i.collapsed;while(i.startContainer.nodeType==1&&(r=i.startContainer.childNodes[i.startOffset])&&u(r))i.setStart(r,0);if(e)return i.collapse(!0);if(!t)while(i.endContainer.nodeType==1&&i.endOffset>0&&(r=i.endContainer.childNodes[i.endOffset-1])&&u(r))i.setEnd(r,r.childNodes.length);return i},getCommonAncestor:function(t,i){var u=this,r=u.startContainer,f=u.endContainer;if(r===f){if(t&&v(this)){r=r.childNodes[u.startOffset];if(r.nodeType==1)return r}return i&&r.nodeType==3?r.parentNode:r}return n.getCommonAncestor(r,f)},trimBoundary:function(t){var f;this.txtToElmBoundary();var u=this.startContainer,r=this.startOffset,e=this.collapsed,i=this.endContainer;if(u.nodeType==3){r==0?this.setStartBefore(u):r>=u.nodeValue.length?this.setStartAfter(u):(f=n.split(u,r),u===i?this.setEnd(f,this.endOffset-r):u.parentNode===i&&(this.endOffset+=1),this.setStartBefore(f));if(e)return this.collapse(!0)}return t||(r=this.endOffset,i=this.endContainer,i.nodeType==3&&(r==0?this.setEndBefore(i):(r<i.nodeValue.length&&n.split(i,r),this.setEndAfter(i)))),this},txtToElmBoundary:function(n){function t(n,t){var i=n[t+"Container"],r=n[t+"Offset"];i.nodeType==3&&(r?r>=i.nodeValue.length&&n["set"+t.replace(/(\w)/,function(n){return n.toUpperCase()})+"After"](i):n["set"+t.replace(/(\w)/,function(n){return n.toUpperCase()})+"Before"](i))}return(n||!this.collapsed)&&(t(this,"start"),t(this,"end")),this},insertNode:function(n){var i=n,u=1;n.nodeType==11&&(i=n.firstChild,u=n.childNodes.length),this.trimBoundary(!0);var t=this.startContainer,f=this.startOffset,r=t.childNodes[f];return r?t.insertBefore(n,r):t.appendChild(n),i.parentNode===this.endContainer&&(this.endOffset=this.endOffset+u),this.setStartBefore(i)},setCursor:function(n,t){return this.collapse(!n).select(t)},createBookmark:function(n,t){var r,i=this.document.createElement("span");return i.style.cssText="display:none;line-height:0px;",i.appendChild(this.document.createTextNode("\u200d")),i.id="_baidu_bookmark_start_"+(t?"":c++),this.collapsed||(r=i.cloneNode(!0),r.id="_baidu_bookmark_end_"+(t?"":c++)),this.insertNode(i),r&&this.collapse().insertNode(r).setEndBefore(r),this.setStartAfter(i),{start:n?i.id:i,end:r?n?r.id:r:null,id:n}},moveToBookmark:function(t){var r=t.id?this.document.getElementById(t.start):t.start,i=t.end&&t.id?this.document.getElementById(t.end):t.end;return this.setStartBefore(r),n.remove(r),i?(this.setEndBefore(i),n.remove(i)):this.collapse(!0),this},enlarge:function(t,i){var e=n.isBody,u,r,f=this.document.createTextNode("");if(t){r=this.startContainer,r.nodeType==1?r.childNodes[this.startOffset]?u=r=r.childNodes[this.startOffset]:(r.appendChild(f),u=r=f):u=r;for(;;){if(n.isBlockElm(r)){r=u;while((u=r.previousSibling)&&!n.isBlockElm(u))r=u;this.setStartBefore(r);break}u=r,r=r.parentNode}r=this.endContainer,r.nodeType==1?((u=r.childNodes[this.endOffset])?r.insertBefore(f,u):r.appendChild(f),u=r=f):u=r;for(;;){if(n.isBlockElm(r)){r=u;while((u=r.nextSibling)&&!n.isBlockElm(u))r=u;this.setEndAfter(r);break}u=r,r=r.parentNode}f.parentNode===this.endContainer&&this.endOffset--,n.remove(f)}if(!this.collapsed){while(this.startOffset==0){if(i&&i(this.startContainer))break;if(e(this.startContainer))break;this.setStartBefore(this.startContainer)}while(this.endOffset==(this.endContainer.nodeType==1?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)){if(i&&i(this.endContainer))break;if(e(this.endContainer))break;this.setEndAfter(this.endContainer)}}return this},enlargeToBlockElm:function(t){while(!n.isBlockElm(this.startContainer))this.setStartBefore(this.startContainer);if(!t)while(!n.isBlockElm(this.endContainer))this.setEndAfter(this.endContainer);return this},adjustmentBoundary:function(){if(!this.collapsed){while(!n.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length&&this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length)this.setStartAfter(this.startContainer);while(!n.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[this.endContainer.nodeType==3?"nodeValue":"childNodes"].length)this.setEndBefore(this.endContainer)}return this},applyInlineStyle:function(t,i,r){var b,u,s,k,w,y,c;if(this.collapsed)return this;this.trimBoundary().enlarge(!1,function(t){return t.nodeType==1&&n.isBlockElm(t)}).adjustmentBoundary();var a=this.createBookmark(),l=a.end,v=function(t){return t.nodeType==1?t.tagName.toLowerCase()!="br":!n.isWhitespace(t)},o=n.getNextDomNode(a.start,!1,v),e,p,h=this.cloneRange();while(o&&n.getPosition(o,l)&n.POSITION_PRECEDING)if(o.nodeType==3||f[t][o.tagName]){h.setStartBefore(o),e=o;while(e&&(e.nodeType==3||f[t][e.tagName])&&e!==l)p=e,e=n.getNextDomNode(e,e.nodeType==1,null,function(n){return f[t][n.tagName]});b=h.setEndAfter(p).extractContents();if(r&&r.length>0){for(k=s=r[0].cloneNode(!1),w=1;y=r[w++];)s.appendChild(y.cloneNode(!1)),s=s.firstChild;u=s}else u=h.document.createElement(t);i&&n.setAttributes(u,i),u.appendChild(b),h.insertNode(r?k:u),t=="span"&&i.style&&/text\-decoration/.test(i.style)&&(c=n.findParentByTagName(u,"a",!0))?(n.setAttributes(c,i),n.remove(u,!0),u=c):(n.mergeSibling(u),n.clearEmptySibling(u)),n.mergeChild(u,i),o=n.getNextDomNode(u,!1,v),n.mergeToParent(u);if(e===l)break}else o=n.getNextDomNode(o,!0,v);return this.moveToBookmark(a)},removeInlineStyle:function(i){var u,r,f,s,o,e,h;if(this.collapsed)return this;i=t.isArray(i)?i:[i],this.shrinkBoundary().adjustmentBoundary(),u=this.startContainer,r=this.endContainer;for(;;){if(u.nodeType==1){if(t.indexOf(i,u.tagName.toLowerCase())>-1)break;if(u.tagName.toLowerCase()=="body"){u=null;break}}u=u.parentNode}for(;;){if(r.nodeType==1){if(t.indexOf(i,r.tagName.toLowerCase())>-1)break;if(r.tagName.toLowerCase()=="body"){r=null;break}}r=r.parentNode}f=this.createBookmark(),u&&(o=this.cloneRange().setEndBefore(f.start).setStartBefore(u),s=o.extractContents(),o.insertNode(s),n.clearEmptySibling(u,!0),u.parentNode.insertBefore(f.start,u)),r&&(o=this.cloneRange().setStartAfter(f.end).setEndAfter(r),s=o.extractContents(),o.insertNode(s),n.clearEmptySibling(r,!1,!0),r.parentNode.insertBefore(f.end,r.nextSibling)),e=n.getNextDomNode(f.start,!1,function(n){return n.nodeType==1});while(e&&e!==f.end)h=n.getNextDomNode(e,!0,function(n){return n.nodeType==1}),t.indexOf(i,e.tagName.toLowerCase())>-1&&n.remove(e,!0),e=h;return this.moveToBookmark(f)},getClosedNode:function(){var i,t,n;return this.collapsed||(t=this.cloneRange().adjustmentBoundary().shrinkBoundary(),v(t)&&(n=t.startContainer.childNodes[t.startOffset],n&&n.nodeType==1&&(f.$empty[n.tagName]||f.$nonChild[n.tagName])&&(i=n))),i},select:r.ie?function(t,r){var f,v,c,e,y,l,h,o;this.collapsed||this.shrinkBoundary(),v=this.getClosedNode();if(v&&!r){try{f=this.document.body.createControlRange(),f.addElement(v),f.select()}catch(p){}return this}c=this.createBookmark(),e=c.start,f=this.document.body.createTextRange(),f.moveToElementText(e),f.moveStart("character",1),this.collapsed?!t&&this.startContainer.nodeType!=3&&(h=this.document.createTextNode(s),o=this.document.createElement("span"),o.appendChild(this.document.createTextNode(s)),e.parentNode.insertBefore(o,e),e.parentNode.insertBefore(h,e),a(this.document,h),i=h,u(o,"previousSibling"),u(e,"nextSibling"),f.moveStart("character",-1),f.collapse(!0)):(l=this.document.body.createTextRange(),y=c.end,l.moveToElementText(y),f.setEndPoint("EndToEnd",l)),this.moveToBookmark(c),o&&n.remove(o);try{f.select()}catch(p){}return this}:function(t){function v(n){function t(t,i,r){t.nodeType==3&&t.nodeValue.length<i&&(n[r+"Offset"]=t.nodeValue.length)}t(n.startContainer,n.startOffset,"start"),t(n.endContainer,n.endOffset,"end")}var l=n.getWindow(this.document),c=l.getSelection(),e,o,h,f;r.gecko?this.document.body.focus():l.focus();if(c){c.removeAllRanges(),this.collapsed&&!t&&(o=this.startContainer,f=o,o.nodeType==1&&(f=o.childNodes[this.startOffset]),!(o.nodeType==3&&this.startOffset)&&(f?!f.previousSibling||f.previousSibling.nodeType!=3:!o.lastChild||o.lastChild.nodeType!=3)&&(e=this.document.createTextNode(s),this.insertNode(e),a(this.document,e),u(e,"previousSibling"),u(e,"nextSibling"),i=e,this.setStart(e,r.webkit?1:0).collapse(!0))),h=this.document.createRange();if(this.collapsed&&r.opera&&this.startContainer.nodeType==1){f=this.startContainer.childNodes[this.startOffset];if(f){while(f&&n.isBlockElm(f))if(f.nodeType==1&&f.childNodes[0])f=f.childNodes[0];else break;f&&this.setStartBefore(f).collapse(!0)}else f=this.startContainer.lastChild,f&&n.isBr(f)&&this.setStartBefore(f).collapse(!0)}v(this),h.setStart(this.startContainer,this.startOffset),h.setEnd(this.endContainer,this.endOffset),c.addRange(h)}return this},scrollToView:function(t,i){t=t?window:n.getWindow(this.document);var u=this,r=u.document.createElement("span");return r.innerHTML="&nbsp;",u.cloneRange().insertNode(r),n.scrollToView(r,t,i),n.remove(r),u},inFillChar:function(){var t=this.startContainer;return this.collapsed&&t.nodeType==3&&t.nodeValue.replace(new RegExp("^"+n.fillChar),"").length+1==t.nodeValue.length?!0:!1},createAddress:function(t,i){function f(t){for(var f=t?r.startContainer:r.endContainer,a=n.findParents(f,!0,function(t){return!n.isBody(t)}),s=[],c,e,o,u,l=0;c=a[l++];)s.push(n.getNodeIndex(c,i));e=0;if(i)if(f.nodeType==3){o=f.previousSibling;while(o&&o.nodeType==3)e+=o.nodeValue.replace(h,"").length,o=o.previousSibling;e+=t?r.startOffset:r.endOffset}else{f=f.childNodes[t?r.startOffset:r.endOffset];if(f)e=n.getNodeIndex(f,i);else{f=t?r.startContainer:r.endContainer,u=f.firstChild;while(u){if(n.isFillChar(u)){u=u.nextSibling;continue}e++;if(u.nodeType==3)while(u&&u.nodeType==3)u=u.nextSibling;else u=u.nextSibling}}}else e=t?n.isFillChar(f)?0:r.startOffset:r.endOffset;return e<0&&(e=0),s.push(e),s}var u={},r=this;return u.startAddress=f(!0),t||(u.endAddress=r.collapsed?[].concat(u.startAddress):f()),u},moveToAddress:function(n,t){function r(n,t){for(var r=i.document.body,e,o,f,u=0,s=n.length;u<s;u++){f=n[u],e=r,r=r.childNodes[f];if(!r){o=f;break}}t?r?i.setStartBefore(r):i.setStart(e,o):r?i.setEndBefore(r):i.setEnd(e,o)}var i=this;return r(n.startAddress,!0),!t&&n.endAddress&&r(n.endAddress),i},equals:function(n){for(var t in this)if(this.hasOwnProperty(t))if(this[t]!==n[t])return!1;return!0},traversal:function(t,i){var f;if(this.collapsed)return this;var u=this.createBookmark(),e=u.end,r=n.getNextDomNode(u.start,!1,i);while(r&&r!==e&&n.getPosition(r,e)&n.POSITION_PRECEDING)f=n.getNextDomNode(r,!1,i),t(r),r=f;return this.moveToBookmark(u)}}})(),(function(){function i(t,i){var a=n.getNodeIndex,e,o,l,p;t=t.duplicate(),t.collapse(i),e=t.parentElement();if(!e.hasChildNodes())return{container:e,offset:0};var h=e.children,r,s=t.duplicate(),v=0,y=h.length-1,c=-1,u;while(v<=y){c=Math.floor((v+y)/2),r=h[c],s.moveToElementText(r),o=s.compareEndPoints("StartToStart",t);if(o>0)y=c-1;else if(o<0)v=c+1;else return{container:e,offset:a(r)}}if(c==-1){s.moveToElementText(e),s.setEndPoint("StartToStart",t),u=s.text.replace(/(\r\n|\r)/g,"\n").length,h=e.childNodes;if(!u)return r=h[h.length-1],{container:r,offset:r.nodeValue.length};l=h.length;while(u>0)u-=h[--l].nodeValue.length;return{container:h[l],offset:-u}}s.collapse(o>0),s.setEndPoint(o>0?"StartToStart":"EndToStart",t),u=s.text.replace(/(\r\n|\r)/g,"\n").length;if(!u)return f.$empty[r.tagName]||f.$nonChild[r.tagName]?{container:e,offset:a(r)+(o>0?0:1)}:{container:r,offset:o>0?0:r.childNodes.length};while(u>0)try{p=r,r=r[o>0?"previousSibling":"nextSibling"],u-=r.nodeValue.length}catch(w){return{container:e,offset:a(p)}}return{container:r,offset:o>0?-u:r.nodeValue.length+u}}function s(n,t){if(n.item)t.selectNode(n.item(0));else{var r=i(n,!0);t.setStart(r.container,r.offset),n.compareEndPoints("StartToEnd",n)!=0&&(r=i(n,!1),t.setEnd(r.container,r.offset))}return t}function t(n){var t,i;try{t=n.getNative().createRange()}catch(r){return null}return i=t.item?t.item(0):t.parentElement(),(i.ownerDocument||i)===n.document?t:null}var o=e.Selection=function(i){var u=this,f;u.document=i;if(r.ie9below){f=n.getWindow(i).frameElement;n.on(f,"beforedeactivate",function(){u._bakIERange=u.getIERange()});n.on(f,"activate",function(){try{!t(u)&&u._bakIERange&&u._bakIERange.select()}catch(n){}u._bakIERange=null})}f=i=null};o.prototype={rangeInBody:function(t,i){var u=r.ie9below||i?t.item?t.item():t.parentElement():t.startContainer;return u===this.document.body||n.inDoc(u,this.document)},getNative:function(){var t=this.document;try{return t?r.ie9below?t.selection:n.getWindow(t).getSelection():null}catch(i){return null}},getIERange:function(){var n=t(this);if(!n)if(this._bakIERange)return this._bakIERange;return n},cache:function(){this.clear(),this._cachedRange=this.getRange(),this._cachedStartElement=this.getStart(),this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var t=this.getStart();return t?n.findParents(t,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{if(r.ie9below){var n=t(this);return!!(n&&this.rangeInBody(n))}return!!this.getNative().rangeCount}catch(i){return!1}},getRange:function(){function e(n){var t=f.document.body.firstChild,i=n.collapsed;while(t&&t.firstChild)n.setStart(t,0),t=t.firstChild;n.startContainer||n.setStart(f.document.body,0),i&&n.collapse(!0)}var f=this,t,c,i,h,o;if(f._cachedRange!=null)return this._cachedRange;t=new u.editor.dom.Range(f.document);if(r.ie9below){c=f.getIERange();if(c)try{s(c,t)}catch(l){e(t)}else e(t)}else{i=f.getNative();if(i&&i.rangeCount)h=i.getRangeAt(0),o=i.getRangeAt(i.rangeCount-1),t.setStart(h.startContainer,h.startOffset).setEnd(o.endContainer,o.endOffset),t.collapsed&&n.isBody(t.startContainer)&&!t.startOffset&&e(t);else{if(this._bakRange&&n.inDoc(this._bakRange.startContainer,this.document))return this._bakRange;e(t)}}return this._bakRange=t},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var t=r.ie9below?this.getIERange():this.getRange(),i,n,u,f;if(r.ie9below){if(!t)return this.document.body.firstChild;if(t.item)return t.item(0);i=t.duplicate(),i.text.length>0&&i.moveStart("character",1),i.collapse(1),n=i.parentElement(),f=u=t.parentElement();while(u=u.parentNode)if(u==n){n=f;break}}else{t.shrinkBoundary(),n=t.startContainer,n.nodeType==1&&n.hasChildNodes()&&(n=n.childNodes[Math.min(n.childNodes.length-1,t.startOffset)]);if(n.nodeType==3)return n.parentNode}return n},getText:function(){var t,n;return this.isFocus()&&(t=this.getNative())?(n=r.ie9below?t.createRange():t.getRangeAt(0),r.ie9below?n.text:n.toString()):""},clearRange:function(){this.getNative()[r.ie9below?"empty":"removeAllRanges"]()}}})(),(function(){function i(i,r){var u,o,f,e;if(r.textarea)if(t.isString(r.textarea)){for(o=0,e=n.getElementsByTagName(i,"textarea");f=e[o++];)if(f.id=="ueditor_textarea_"+r.options.textarea){u=f;break}}else u=r.textarea;u||(i.appendChild(u=n.createElement(document,"textarea",{name:r.options.textarea,id:"ueditor_textarea_"+r.options.textarea,style:"display:none"})),r.textarea=u),!u.getAttribute("name")&&u.setAttribute("name",r.options.textarea),u.value=r.hasContents()?r.options.allHtmlEnabled?r.getAllHtml():r.getContent(null,null,!0):""}function c(n){for(var t in n)return t}function s(n){n.langIsReady=!0,n.fireEvent("langReady")}var a=0,h,u=UE.Editor=function(n){var i=this;i.uid=a++,l.call(i),i.commands={},i.options=t.extend(t.clone(n||{}),UEDITOR_CONFIG,!0),i.shortcutkeys={},i.inputRules=[],i.outputRules=[],i.setOpt(u.defaultOptions(i)),i.loadServerConfig(),t.isEmptyObject(UE.I18N)?t.loadFile(document,{src:i.options.langPath+i.options.lang+"/"+i.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){UE.plugin.load(i),s(i)}):(i.options.lang=c(UE.I18N),UE.plugin.load(i),s(i)),UE.instants["ueditorInstant"+i.uid]=i};u.prototype={registerCommand:function(n,t){this.commands[n]=t},ready:function(n){var t=this;n&&(t.isReady?n.apply(t):t.addListener("ready",n))},setOpt:function(n,i){var r={};t.isString(n)?r[n]=i:r=n,t.extend(this.options,r,!0)},getOpt:function(n){return this.options[n]},destroy:function(){var t=this,r,i,f,u;t.fireEvent("destroy"),r=t.container.parentNode,i=t.textarea,i?i.style.display="":(i=document.createElement("textarea"),r.parentNode.insertBefore(i,r)),i.style.width=t.iframe.offsetWidth+"px",i.style.height=t.iframe.offsetHeight+"px",i.value=t.getContent(),i.id=t.key,r.innerHTML="",n.remove(r),f=t.key;for(u in t)t.hasOwnProperty(u)&&delete this[u];UE.delEditor(f)},render:function(i){var e=this,u=e.options,f=function(t){return parseInt(n.getComputedStyle(i,t))},s;t.isString(i)&&(i=document.getElementById(i));if(i){u.minFrameWidth=u.initialFrameWidth?u.initialFrameWidth:u.initialFrameWidth=i.offsetWidth,u.initialFrameHeight?u.minFrameHeight=u.initialFrameHeight:u.initialFrameHeight=u.minFrameHeight=i.offsetHeight;try{i.style.width=/%$/.test(u.initialFrameWidth)?"100%":u.initialFrameWidth-f("padding-left")-f("padding-right")+"px"}catch(h){}i.style.height=/%$/.test(u.initialFrameHeight)?"100%":u.initialFrameHeight-f("padding-top")-f("padding-bottom")+"px",i.style.zIndex=u.zIndex,s=(o&&r.version<9?"":"<!DOCTYPE html>")+"<html xmlns='http://www.w3.org/1999/xhtml' class='view' ><head><style type='text/css'>.view{padding:0;word-wrap:break-word;cursor:text;height:90%;}\nbody{margin:8px;font-family:sans-serif;font-size:16px;}p{margin:5px 0;}</style>"+(u.iframeCssUrl?"<link rel='stylesheet' type='text/css' href='"+t.unhtml(u.iframeCssUrl)+"'/>":"")+(u.initialStyle?"<style>"+u.initialStyle+"</style>":"")+"</head><body class='view' ></body><script type='text/javascript' "+(o?"defer='defer'":"")+" id='_initialScript'>setTimeout(function(){editor = window.parent.UE.instants['ueditorInstant"+e.uid+"'];editor._setup(document);},0);var _tmpScript = document.getElementById('_initialScript');_tmpScript.parentNode.removeChild(_tmpScript);<\/script></html>",i.appendChild(n.createElement(document,"iframe",{id:"ueditor_"+e.uid,width:"100%",height:"100%",frameborder:"0",src:"javascript:void(function(){document.open();"+(u.customDomain&&document.domain!=location.hostname?'document.domain="'+document.domain+'";':"")+'document.write("'+s+'");document.close();}())'})),i.style.overflow="hidden",setTimeout(function(){/%$/.test(u.initialFrameWidth)&&(u.minFrameWidth=u.initialFrameWidth=i.offsetWidth),/%$/.test(u.initialFrameHeight)&&(u.minFrameHeight=u.initialFrameHeight=i.offsetHeight,i.style.height=u.initialFrameHeight+"px")})}},_setup:function(t){var u=this,f=u.options,c,s,h;for(o?(t.body.disabled=!0,t.body.contentEditable=!0,t.body.disabled=!1):t.body.contentEditable=!0,t.body.spellcheck=!1,u.document=t,u.window=t.defaultView||t.parentWindow,u.iframe=u.window.frameElement,u.body=t.body,u.selection=new e.Selection(t),r.gecko&&(c=this.selection.getNative())&&c.removeAllRanges(),this._initEvents(),s=this.iframe.parentNode;!n.isBody(s);s=s.parentNode)if(s.tagName=="FORM"){u.form=s;if(u.options.autoSyncData)n.on(u.window,"blur",function(){i(s,u)});else n.on(s,"submit",function(){i(this,u)});break}f.initialContent&&(f.autoClearinitialContent?(h=u.execCommand,u.execCommand=function(){return u.fireEvent("firstBeforeExecCommand"),h.apply(u,arguments)},this._setDefaultContent(f.initialContent)):this.setContent(f.initialContent,!1,!0)),n.isEmptyNode(u.body)&&(u.body.innerHTML="<p>"+(r.ie?"":"<br/>")+"</p>"),f.focus&&setTimeout(function(){u.focus(u.options.focusInEnd),!u.options.autoClearinitialContent&&u._selectionChange()},0),u.container||(u.container=this.iframe.parentNode),f.fullscreen&&u.ui&&u.ui.setFullScreen(!0);try{u.document.execCommand("2D-position",!1,!1)}catch(l){}try{u.document.execCommand("enableInlineTableEditing",!1,!1)}catch(l){}try{u.document.execCommand("enableObjectResizing",!1,!1)}catch(l){}u._bindshortcutKeys(),u.isReady=1,u.fireEvent("ready"),f.onready&&f.onready.call(u);if(!r.ie9below)n.on(u.window,["blur","focus"],function(n){if(n.type=="blur"){u._bakRange=u.selection.getRange();try{u._bakNativeRange=u.selection.getNative().getRangeAt(0),u.selection.getNative().removeAllRanges()}catch(n){u._bakNativeRange=null}}else try{u._bakRange&&u._bakRange.select()}catch(n){}});r.gecko&&r.version<=10902&&(u.body.contentEditable=!1,setTimeout(function(){u.body.contentEditable=!0},100),setInterval(function(){u.body.style.height=u.iframe.offsetHeight-20+"px"},100)),!f.isShow&&u.setHide(),f.readonly&&u.setDisabled()},sync:function(t){var u=this,r=t?document.getElementById(t):n.findParent(u.iframe.parentNode,function(n){return n.tagName=="FORM"},!0);r&&i(r,u)},setHeight:function(n,t){n!==parseInt(this.iframe.parentNode.style.height)&&(this.iframe.parentNode.style.height=n+"px"),!t&&(this.options.minFrameHeight=this.options.initialFrameHeight=n),this.body.style.height=n+"px",!t&&this.trigger("setHeight")},addshortcutkey:function(n,i){var r={};i?r[n]=i:r=n,t.extend(this.shortcutkeys,r)},_bindshortcutKeys:function(){var t=this,i=this.shortcutkeys;t.addListener("keydown",function(r,u){var c=u.keyCode||u.which,e,h,l,f,o,s;for(e in i)for(h=i[e].split(","),l=0;f=h[l++];)f=f.split(":"),o=f[0],s=f[1],(/^(ctrl)(\+shift)?\+(\d+)$/.test(o.toLowerCase())||/^(\d+)$/.test(o))&&((RegExp.$1=="ctrl"?u.ctrlKey||u.metaKey:0)&&(RegExp.$2!=""?u[RegExp.$2.slice(1)+"Key"]:1)&&c==RegExp.$3||c==RegExp.$1)&&(t.queryCommandState(e,s)!=-1&&t.execCommand(e,s),n.preventDefault(u))})},getContent:function(n,i,r,u,f){var o=this,e;return n&&t.isFunction(n)&&(i=n,n=""),i?!i():!this.hasContents()?"":(o.fireEvent("beforegetcontent"),e=UE.htmlparser(o.body.innerHTML,u),o.filterOutputRule(e),o.fireEvent("aftergetcontent",n,e),e.toHtml(f))},getAllHtml:function(){var n=this,u=[],f="",i;return n.fireEvent("getAllHtml",u),r.ie&&r.version>8&&(i="",t.each(n.document.styleSheets,function(n){i+=n.href?'<link rel="stylesheet" type="text/css" href="'+n.href+'" />':"<style>"+n.cssText+"</style>"}),t.each(n.document.getElementsByTagName("script"),function(n){i+=n.outerHTML})),"<html><head>"+(n.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+n.options.charset+'"/>':"")+(i||n.document.getElementsByTagName("head")[0].innerHTML)+u.join("\n")+"</head><body "+(o&&r.version<9?'class="view"':"")+">"+n.getContent(null,null,!0)+"</body></html>"},getPlainTxt:function(){var i=new RegExp(n.fillChar,"g"),t=this.body.innerHTML.replace(/[\n\r]/g,"");return t=t.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(n,t,i){return f.$block[i]?"\n":t?t:""}),t.replace(i,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){var t=new RegExp(n.fillChar,"g");return this.body[r.ie?"innerText":"textContent"].replace(t,"").replace(/\u00a0/g," ")},setContent:function(t,u,e){function v(n){return n.tagName=="DIV"&&n.getAttribute("cdata_tag")}var s=this,c,o,a,h,l;s.fireEvent("beforesetcontent",t),c=UE.htmlparser(t),s.filterInputRule(c),t=c.toHtml(),s.body.innerHTML=(u?s.body.innerHTML:"")+t;if(s.options.enterTag=="p"){o=this.body.firstChild;if(!o||o.nodeType==1&&(f.$cdata[o.tagName]||v(o)||n.isCustomeNode(o))&&o===this.body.lastChild)this.body.innerHTML="<p>"+(r.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML;else{h=s.document.createElement("p");while(o){while(o&&(o.nodeType==3||o.nodeType==1&&f.p[o.tagName]&&!f.$cdata[o.tagName]))a=o.nextSibling,h.appendChild(o),o=a;if(h.firstChild)if(o)o.parentNode.insertBefore(h,o),h=s.document.createElement("p");else{s.body.appendChild(h);break}o=o.nextSibling}}}s.fireEvent("aftersetcontent"),s.fireEvent("contentchange"),!e&&s._selectionChange(),s._bakRange=s._bakIERange=s._bakNativeRange=null,r.gecko&&(l=this.selection.getNative())&&l.removeAllRanges(),s.options.autoSyncData&&s.form&&i(s.form,s)},focus:function(t){var u,r,i;try{u=this,r=u.selection.getRange(),t?(i=u.body.lastChild,i&&i.nodeType==1&&!f.$empty[i.tagName]&&(n.isEmptyBlock(i)?r.setStartAtFirst(i):r.setStartAtLast(i),r.collapse(!0)),r.setCursor(!0)):(!r.collapsed&&n.isBody(r.startContainer)&&r.startOffset==0&&(i=u.body.firstChild,i&&i.nodeType==1&&!f.$empty[i.tagName]&&r.setStartAtFirst(i).collapse(!0)),r.select(!0)),this.fireEvent("focus selectionchange")}catch(e){}},isFocus:function(){return this.selection.isFocus()},blur:function(){var t=this.selection.getNative(),n;t.empty&&r.ie?(n=document.body.createTextRange(),n.moveToElementText(document.body),n.collapse(!0),n.select(),t.empty()):t.removeAllRanges()},_initEvents:function(){var i=this,u=i.document,f=i.window;i._proxyDomEvent=t.bind(i._proxyDomEvent,i);n.on(u,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],i._proxyDomEvent);n.on(f,["focus","blur"],i._proxyDomEvent);n.on(i.body,"drop",function(n){r.gecko&&n.stopPropagation&&n.stopPropagation(),i.fireEvent("contentchange")});n.on(u,["mouseup","keydown"],function(n){if(n.type=="keydown"&&(n.ctrlKey||n.metaKey||n.shiftKey||n.altKey))return;if(n.button==2)return;i._selectionChange(250,n)})},_proxyDomEvent:function(n){return this.fireEvent("before"+n.type.replace(/^on/,"").toLowerCase())===!1?!1:this.fireEvent(n.type.replace(/^on/,""),n)===!1?!1:this.fireEvent("after"+n.type.replace(/^on/,"").toLowerCase())},_selectionChange:function(n,t){var i=this,e=!1,o,u,f;r.ie&&r.version<9&&t&&t.type=="mouseup"&&(f=this.selection.getRange(),f.collapsed||(e=!0,o=t.clientX,u=t.clientY)),clearTimeout(h),h=setTimeout(function(){var n,r;if(!i.selection||!i.selection.getNative())return;if(e&&i.selection.getNative().type=="None"){n=i.document.body.createTextRange();try{n.moveToPoint(o,u)}catch(f){n=null}}n&&(r=i.selection.getIERange,i.selection.getIERange=function(){return n}),i.selection.cache(),r&&(i.selection.getIERange=r),i.selection._cachedRange&&i.selection._cachedStartElement&&(i.fireEvent("beforeselectionchange"),i.fireEvent("selectionchange",!!t),i.fireEvent("afterselectionchange"),i.selection.clear())},n||50)},_callCmdFn:function(n,t){var u=t[0].toLowerCase(),i,r;return i=this.commands[u]||UE.commands[u],r=i&&i[n],(!i||!r)&&n=="queryCommandState"?0:r?r.apply(this,t):void 0},execCommand:function(n){n=n.toLowerCase();var t=this,r,i=t.commands[n]||UE.commands[n];return!i||!i.execCommand?null:(!i.notNeedUndo&&!t.__hasEnterExecCommand?(t.__hasEnterExecCommand=!0,t.queryCommandState.apply(t,arguments)!=-1&&(t.fireEvent("saveScene"),t.fireEvent.apply(t,["beforeexeccommand",n].concat(arguments)),r=this._callCmdFn("execCommand",arguments),t.fireEvent.apply(t,["afterexeccommand",n].concat(arguments)),t.fireEvent("saveScene")),t.__hasEnterExecCommand=!1):(r=this._callCmdFn("execCommand",arguments),!t.__hasEnterExecCommand&&!i.ignoreContentChange&&!t._ignoreContentChange&&t.fireEvent("contentchange")),!t.__hasEnterExecCommand&&!i.ignoreContentChange&&!t._ignoreContentChange&&t._selectionChange(),r)},queryCommandState:function(){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(t){var r,i,e,f,u;if(t)for(r=0;i=t[r++];)if(this.document.getElementsByTagName(i).length>0)return!0;if(!n.isEmptyBlock(this.body))return!0;for(t=["div"],r=0;i=t[r++];)for(e=n.getElementsByTagName(this.document,i),f=0;u=e[f++];)if(n.isCustomeNode(u))return!0;return!1},reset:function(){this.fireEvent("reset")},setEnabled:function(){var n=this,t;if(n.body.contentEditable=="false"){n.body.contentEditable=!0,t=n.selection.getRange();try{t.moveToBookmark(n.lastBk),delete n.lastBk}catch(i){t.setStartAtFirst(n.body).collapse(!0)}t.select(!0),n.bkqueryCommandState&&(n.queryCommandState=n.bkqueryCommandState,delete n.bkqueryCommandState),n.bkqueryCommandValue&&(n.queryCommandValue=n.bkqueryCommandValue,delete n.bkqueryCommandValue),n.fireEvent("selectionchange")}},enable:function(){return this.setEnabled()},setDisabled:function(n){var i=this;n=n?t.isArray(n)?n:[n]:[],i.body.contentEditable=="true"&&(i.lastBk||(i.lastBk=i.selection.getRange().createBookmark(!0)),i.body.contentEditable=!1,i.bkqueryCommandState=i.queryCommandState,i.bkqueryCommandValue=i.queryCommandValue,i.queryCommandState=function(r){return t.indexOf(n,r)!=-1?i.bkqueryCommandState.apply(i,arguments):-1},i.queryCommandValue=function(r){return t.indexOf(n,r)!=-1?i.bkqueryCommandValue.apply(i,arguments):null},i.fireEvent("selectionchange"))},disable:function(n){return this.setDisabled(n)},_setDefaultContent:function(){function n(){var t=this;t.document.getElementById("initContent")&&(t.body.innerHTML="<p>"+(o?"":"<br/>")+"</p>",t.removeListener("firstBeforeExecCommand focus",n),setTimeout(function(){t.focus(),t._selectionChange()},0))}return function(t){var i=this;i.body.innerHTML='<p id="initContent">'+t+"</p>",i.addListener("firstBeforeExecCommand focus",n)}}(),setShow:function(){var n=this,t=n.selection.getRange();if(n.container.style.display=="none"){try{t.moveToBookmark(n.lastBk),delete n.lastBk}catch(i){t.setStartAtFirst(n.body).collapse(!0)}setTimeout(function(){t.select(!0)},100),n.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){var n=this;n.lastBk||(n.lastBk=n.selection.getRange().createBookmark(!0)),n.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(n){var t=UE.I18N[this.options.lang],r,i;if(!t)throw Error("not import language file");for(n=(n||"").split("."),r=0;i=n[r++];){t=t[i];if(!t)break}return t},getContentLength:function(n,t){var i=this.getContent(!1,!1,!0).length,u,r;if(n)for(t=(t||[]).concat(["hr","img","iframe"]),i=this.getContentTxt().replace(/[\t\r\n]+/g,"").length,u=0;r=t[u++];)i+=this.document.getElementsByTagName(r).length;return i},addInputRule:function(n){this.inputRules.push(n)},filterInputRule:function(n){for(var i=0,t;t=this.inputRules[i++];)t.call(this,n)},addOutputRule:function(n){this.outputRules.push(n)},filterOutputRule:function(n){for(var i=0,t;t=this.outputRules[i++];)t.call(this,n)},getActionUrl:function(n){var u=this.getOpt(n)||n,r=this.getOpt("imageUrl"),i=this.getOpt("serverUrl");return!i&&r&&(i=r.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2")),i?(i=i+(i.indexOf("?")==-1?"?":"&")+"action="+(u||""),t.formatUrl(i)):""}},t.inherits(u,l)})(),UE.Editor.defaultOptions=function(n){var t=n.options.UEDITOR_HOME_URL;return{isShow:!0,initialContent:"",initialStyle:"",autoClearinitialContent:!1,iframeCssUrl:t+"themes/iframe.css",textarea:"editorValue",focus:!1,focusInEnd:!0,autoClearEmptyNode:!0,fullscreen:!1,readonly:!1,zIndex:999,imagePopup:!0,enterTag:"p",customDomain:!1,lang:"zh-cn",langPath:t+"lang/",theme:"default",themePath:t+"themes/",allHtmlEnabled:!1,scaleEnabled:!1,tableNativeEditInFF:!1,autoSyncData:!0,fileNameFormat:"{time}{rand:6}"}},(function(){UE.Editor.prototype.loadServerConfig=function(){function i(n){console&&console.error(n)}var n=this;setTimeout(function(){try{n.options.imageUrl&&n.setOpt("serverUrl",n.options.imageUrl.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2"));var r=n.getActionUrl("config"),u=t.isCrossDomainUrl(r);n._serverConfigLoaded=!1,r&&UE.ajax.request(r,{method:"GET",dataType:u?"jsonp":"",onsuccess:function(r){try{var f=u?r:eval("("+r.responseText+")");t.extend(n.options,f),n.fireEvent("serverConfigLoaded"),n._serverConfigLoaded=!0}catch(e){i(n.getLang("loadconfigFormatError"))}},onerror:function(){i(n.getLang("loadconfigHttpError"))}})}catch(f){i(n.getLang("loadconfigError"))}})},UE.Editor.prototype.isServerConfigLoaded=function(){var n=this;return n._serverConfigLoaded||!1},UE.Editor.prototype.afterConfigReady=function(n){if(!n||!t.isFunction(n))return;var i=this,r=function(){n.apply(i,arguments),i.removeListener("serverConfigLoaded",r)};i.isServerConfigLoaded()?n.call(i,"serverConfigLoaded"):i.addListener("serverConfigLoaded",r)}})(),UE.ajax=function(){function n(n){var u=[],i,r;for(i in n){if(i=="method"||i=="timeout"||i=="async"||i=="dataType"||i=="callback")continue;if(n[i]==undefined||n[i]==null)continue;if((typeof n[i]).toLowerCase()=="function"||(typeof n[i]).toLowerCase()=="object"){if(t.isArray(n[i]))for(r=0;r<n[i].length;r++)u.push(encodeURIComponent(i)+"[]="+encodeURIComponent(n[i][r]))}else u.push(encodeURIComponent(i)+"="+encodeURIComponent(n[i]))}return u.join("&")}function f(i,r){var f=u(),h=!1,c={method:"POST",timeout:5e3,async:!0,data:{},onsuccess:function(){},onerror:function(){}},e,o;typeof i=="object"&&(r=i,i=r.url);if(!f||!i)return;e=r?t.extend(c,r):c,o=n(e),t.isEmptyObject(e.data)||(o+=(o?"&":"")+n(e.data));var a=setTimeout(function(){f.readyState!=4&&(h=!0,f.abort(),clearTimeout(a))},e.timeout),s=e.method.toUpperCase(),l=i+(i.indexOf("?")==-1?"?":"&")+(s=="POST"?"":o+"&noCache="+ +new Date);f.open(s,l,e.async),f.onreadystatechange=function(){if(f.readyState==4)if(!h&&f.status==200)e.onsuccess(f);else e.onerror(f)},s=="POST"?(f.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),f.send(o)):f.send(null)}function r(i,r){function w(n,t,i){n.setAttribute("type","text/javascript"),n.setAttribute("defer","defer"),i&&n.setAttribute("charset",i),n.setAttribute("src",t),document.getElementsByTagName("head")[0].appendChild(n)}function h(n){return function(){try{if(n)u.onerror&&u.onerror();else try{clearTimeout(a),s.apply(window,arguments)}catch(i){}}catch(t){u.onerror&&u.onerror.call(window,t)}finally{u.oncomplete&&u.oncomplete.apply(window,arguments),o.parentNode&&o.parentNode.removeChild(o),window[f]=null;try{delete window[f]}catch(i){}}}}var s=r.onsuccess||function(){},o=document.createElement("SCRIPT"),u=r||{},p=u.charset,l=u.jsonp||"callback",f,y=u.timeOut||0,a,c=new RegExp("(\\?|&)"+l+"=([^&]*)"),v,e;t.isFunction(s)?(f="bd__editor__"+Math.floor(Math.random()*2147483648).toString(36),window[f]=h(0)):t.isString(s)?f=s:(v=c.exec(i))&&(f=v[2]),i=i.replace(c,"$1"+l+"="+f),i.search(c)<0&&(i+=(i.indexOf("?")<0?"?":"&")+l+"="+f),e=n(r),t.isEmptyObject(r.data)||(e+=(e?"&":"")+n(r.data)),e&&(i=i.replace(/\?/,"?"+e+"&")),o.onerror=h(1),y&&(a=setTimeout(h(1),y)),w(o,i,p)}var i="XMLHttpRequest()",u;try{new ActiveXObject("Msxml2.XMLHTTP"),i="ActiveXObject('Msxml2.XMLHTTP')"}catch(e){try{new ActiveXObject("Microsoft.XMLHTTP"),i="ActiveXObject('Microsoft.XMLHTTP')"}catch(e){}}return u=new Function("return new "+i),{request:function(n,t){t&&t.dataType=="jsonp"?r(n,t):f(n,t)},getJSONP:function(n,t,i){var u={data:t,oncomplete:i};r(n,u)}}}(),d=UE.filterWord=function(){function u(n){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<(v|o):|lang=)/ig.test(n)}function n(n){return n=n.replace(/[\d.]+\w+/g,function(n){return t.transUnitToPx(n)})}function i(i){return i.replace(/[\t\r\n]+/g," ").replace(/<!--[\s\S]*?-->/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(t){if(r.opera)return"";try{if(/Bitmap/i.test(t))return"";var f=t.match(/width:([ \d.]*p[tx])/i)[1],u=t.match(/height:([ \d.]*p[tx])/i)[1],i=t.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+n(f)+'" height="'+n(u)+'" src="'+i+'" />'}catch(e){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/ig,function(n,t,i,r){return t=="class"&&r=="MsoListParagraph"?n:""}).replace(/<(font|span)[^>]*>(\s*)<\/\1>/gi,function(n,t,i){return i.replace(/[\t\r\n ]+/g," ")}).replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(i,r,u,f){for(var s=[],a=f.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").replace(/[\d.]+(cm|pt)/g,function(n){return t.transUnitToPx(n)}).split(/;\s*/g),l,h,e,c,o=0;l=a[o];o++){c=l.split(":");if(c.length==2){h=c[0].toLowerCase(),e=c[1].toLowerCase();if(/^(background)\w*/.test(h)&&e.replace(/(initial|\s)/g,"").length==0||/^(margin)\w*/.test(h)&&/^0\w+$/.test(e))continue;switch(h){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":/<table/.test(r)||(s[o]=h.replace(/^mso-|-alt$/g,"")+":"+n(e));continue;case"horiz-align":s[o]="text-align:"+e;continue;case"vert-align":s[o]="vertical-align:"+e;continue;case"font-color":case"mso-foreground":s[o]="color:"+e;continue;case"mso-background":case"mso-highlight":s[o]="background:"+e;continue;case"mso-default-height":s[o]="min-height:"+n(e);continue;case"mso-default-width":s[o]="min-width:"+n(e);continue;case"mso-padding-between-alt":s[o]="border-collapse:separate;border-spacing:"+n(e);continue;case"text-line-through":(e=="single"||e=="double")&&(s[o]="text-decoration:line-through");continue;case"mso-zero-height":e=="yes"&&(s[o]="display:none");continue;case"margin":if(!/[1-9]/.test(e))continue}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(h)||/text\-indent|padding|margin/.test(h)&&/\-[\d.]+/.test(e))continue;s[o]=h+":"+c[1]}}return r+(s.length?' style="'+s.join(";").replace(/;{2,}/g,";")+'"':"")})}return function(n){return u(n)?i(n):n}}(),(function(){function i(n,t,i){return n.push(v),t+(i?1:-1)}function r(n,t){for(var i=0;i<t;i++)n.push(c)}function u(n,t,e,o){switch(n.type){case"root":for(var c=0,s;s=n.children[c++];)e&&s.type=="element"&&!f.$inlineWithA[s.tagName]&&c>1&&(i(t,o,!0),r(t,o)),u(s,t,e,o);break;case"text":y(n,t);break;case"element":l(n,t,e,o);break;case"comment":h(n,t,e)}return t}function y(n,i){n.parentNode.tagName=="pre"?i.push(n.data):i.push(a[n.parentNode.tagName]?t.html(n.data):n.data.replace(/[ ]{2}/g," &nbsp;"))}function l(n,e,o,s){var c="",l,h,v,a;if(n.attrs){c=[],l=n.attrs;for(h in l)c.push(h+(l[h]!==undefined?'="'+(p[h]?t.html(l[h]).replace(/["]/g,function(){return"&quot;"}):t.unhtml(l[h]))+'"':""));c=c.join(" ")}e.push("<"+n.tagName+(c?" "+c:"")+(f.$empty[n.tagName]?"/":"")+">"),o&&!f.$inlineWithA[n.tagName]&&n.tagName!="pre"&&n.children&&n.children.length&&(s=i(e,s,!0),r(e,s));if(n.children&&n.children.length)for(v=0;a=n.children[v++];)o&&a.type=="element"&&!f.$inlineWithA[a.tagName]&&v>1&&(i(e,s),r(e,s)),u(a,e,o,s);f.$empty[n.tagName]||(o&&!f.$inlineWithA[n.tagName]&&n.tagName!="pre"&&n.children&&n.children.length&&(s=i(e,s),r(e,s)),e.push("</"+n.tagName+">"))}function h(n,t){t.push("<!--"+n.data+"-->")}function e(n,t){var u,r,i;if(n.type=="element"&&n.getAttr("id")==t)return n;if(n.children&&n.children.length)for(r=0;i=n.children[r++];)if(u=e(i,t))return u}function o(n,t,i){n.type=="element"&&n.tagName==t&&i.push(n);if(n.children&&n.children.length)for(var u=0,r;r=n.children[u++];)o(r,t,i)}function s(n,t){if(n.children&&n.children.length)for(var r=0,i;i=n.children[r];)s(i,t),i.parentNode&&(i.children&&i.children.length&&t(i),i.parentNode&&r++);else t(n)}var n=UE.uNode=function(n){this.type=n.type,this.data=n.data,this.tagName=n.tagName,this.parentNode=n.parentNode,this.attrs=n.attrs||{},this.children=n.children},p={href:1,src:1,_src:1,_href:1,cdata_data:1},a={style:1,script:1},c="    ",v="\n";n.createElement=function(t){return/[<>]/.test(t)?UE.htmlparser(t).children[0]:new n({type:"element",children:[],tagName:t})},n.createText=function(n,i){return new UE.uNode({type:"text",data:i?n:t.unhtml(n||"")})},n.prototype={toHtml:function(n){var t=[];return u(this,t,n,0),t.join("")},innerHTML:function(n){var u,i,r;if(this.type!="element"||f.$empty[this.tagName])return this;if(t.isString(n)){if(this.children)for(u=0;i=this.children[u++];)i.parentNode=null;for(this.children=[],r=UE.htmlparser(n),u=0;i=r.children[u++];)this.children.push(i),i.parentNode=this;return this}return r=new UE.uNode({type:"root",children:this.children}),r.toHtml()},innerText:function(t,i){if(this.type!="element"||f.$empty[this.tagName])return this;if(t){if(this.children)for(var u=0,r;r=this.children[u++];)r.parentNode=null;return this.children=[],this.appendChild(n.createText(t,i)),this}return this.toHtml().replace(/<[^>]+>/g,"")},getData:function(){return this.type=="element"?"":this.data},firstChild:function(){return this.children?this.children[0]:null},lastChild:function(){return this.children?this.children[this.children.length-1]:null},previousSibling:function(){for(var i=this.parentNode,t,n=0;t=i.children[n];n++)if(t===this)return n==0?null:i.children[n-1]},nextSibling:function(){for(var i=this.parentNode,t,n=0;t=i.children[n++];)if(t===this)return i.children[n]},replaceChild:function(n,t){if(this.children){n.parentNode&&n.parentNode.removeChild(n);for(var i=0,r;r=this.children[i];i++)if(r===t)return this.children.splice(i,1,n),t.parentNode=null,n.parentNode=this,n}},appendChild:function(n){if(this.type=="root"||this.type=="element"&&!f.$empty[this.tagName]){this.children||(this.children=[]),n.parentNode&&n.parentNode.removeChild(n);for(var t=0,i;i=this.children[t];t++)if(i===n){this.children.splice(t,1);break}return this.children.push(n),n.parentNode=this,n}},insertBefore:function(n,t){if(this.children){n.parentNode&&n.parentNode.removeChild(n);for(var i=0,r;r=this.children[i];i++)if(r===t)return this.children.splice(i,0,n),n.parentNode=this,n}},insertAfter:function(n,t){if(this.children){n.parentNode&&n.parentNode.removeChild(n);for(var i=0,r;r=this.children[i];i++)if(r===t)return this.children.splice(i+1,0,n),n.parentNode=this,n}},removeChild:function(n,t){var r,i,u,f;if(this.children)for(r=0;i=this.children[r];r++)if(i===n){this.children.splice(r,1),i.parentNode=null;if(t&&i.children&&i.children.length)for(u=0;f=i.children[u];u++)this.children.splice(r+u,0,f),f.parentNode=this;return i}},getAttr:function(n){return this.attrs&&this.attrs[n.toLowerCase()]},setAttr:function(n,i){if(!n){delete this.attrs;return}this.attrs||(this.attrs={});if(t.isObject(n))for(var r in n)n[r]?this.attrs[r.toLowerCase()]=n[r]:delete this.attrs[r];else i?this.attrs[n.toLowerCase()]=i:delete this.attrs[n]},getIndex:function(){for(var i=this.parentNode,t,n=0;t=i.children[n];n++)if(t===this)return n;return-1},getNodeById:function(n){var r,i,t;if(this.children&&this.children.length)for(i=0;t=this.children[i++];)if(r=e(t,n))return r},getNodesByTagName:function(n){n=t.trim(n).replace(/[ ]{2,}/g," ").split(" ");var r=[],i=this;return t.each(n,function(n){if(i.children&&i.children.length)for(var u=0,t;t=i.children[u++];)o(t,n,r)}),r},getStyle:function(n){var i=this.getAttr("style"),r,t;if(!i)return"";return r=new RegExp("(^|;)\\s*"+n+":([^;]+)","i"),t=i.match(r),t&&t[0]?t[2]:""},setStyle:function(n,i){function f(n,i){var u=new RegExp("(^|;)\\s*"+n+":([^;]+;?)","gi");r=r.replace(u,"$1"),i&&(r=n+":"+t.unhtml(i)+";"+r)}var r=this.getAttr("style"),u;r||(r="");if(t.isObject(n))for(u in n)f(u,n[u]);else f(n,i);this.setAttr("style",t.trim(r))},traversal:function(n){return this.children&&this.children.length&&s(this,n),this}}})(),p=UE.htmlparser=function(i,r){function h(n,t){if(y[n.tagName]){var i=o.createElement(y[n.tagName]);n.appendChild(i),i.appendChild(o.createText(t)),n=i}else n.appendChild(o.createText(t))}function v(n,i,r){var s,e,l,h,c,u;if(s=k[i]){e=n;while(e.type!="root"){if(t.isArray(s)?t.indexOf(s,e.tagName)!=-1:s==e.tagName){n=e,l=!0;break}e=e.parentNode}l||(n=v(n,t.isArray(s)?s[0]:s))}h=new o({parentNode:n,type:"element",tagName:i.toLowerCase(),children:f.$empty[i]?null:[]});if(r){c={};while(u=w.exec(r))c[u[1].toLowerCase()]=b[u[1].toLowerCase()]?u[2]||u[3]||u[4]:t.unhtml(u[2]||u[3]||u[4]);h.attrs=c}return n.children.push(h),f.$empty[i]?n:h}function g(n,t){n.children.push(new o({type:"comment",data:t,parentNode:n}))}var p=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/<>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,w=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,d={b:1,code:1,i:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,span:1,sub:1,img:1,sup:1,font:1,big:1,small:1,iframe:1,a:1,br:1,pre:1},a;i=i.replace(new RegExp(n.fillChar,"g"),""),r||(i=i.replace(new RegExp("[\\r\\t\\n"+(r?"":" ")+"]*</?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n"+(r?"":" ")+"]*","g"),function(n,t){return t&&d[t.toLowerCase()]?n.replace(/(^[\n\r]+)|([\n\r]+$)/g,""):n.replace(new RegExp("^[\\r\\n"+(r?"":" ")+"]+"),"").replace(new RegExp("[\\r\\n"+(r?"":" ")+"]+$"),"")}));var b={href:1,src:1},o=UE.uNode,k={td:"tr",tr:["tbody","thead","tfoot"],tbody:"table",th:"tr",thead:"table",tfoot:"table",caption:"table",li:["ul","ol"],dt:"dl",dd:"dl",option:"select"},y={ol:"li",ul:"li"};var e,c=0,s=0,l=new o({type:"root",children:[]}),u=l;while(e=p.exec(i)){c=e.index;try{c>s&&h(u,i.slice(s,c));if(e[3])f.$cdata[u.tagName]?h(u,e[0]):u=v(u,e[3].toLowerCase(),e[4]);else if(e[1]){if(u.type!="root")if(f.$cdata[u.tagName]&&!f.$cdata[e[1]])h(u,e[0]);else{a=u;while(u.type=="element"&&u.tagName!=e[1].toLowerCase()){u=u.parentNode;if(u.type=="root"){u=a;throw"break";}}u=u.parentNode}}else e[2]&&g(u,e[2])}catch(nt){}s=p.lastIndex}return s<i.length&&h(u,i.slice(s)),l},w=UE.filterNode=function(){function n(i,r){var s,h,y,c,o,v,l,a,u,e;switch(i.type){case"element":if(s=r[i.tagName])if(s==="-")i.parentNode.removeChild(i);else if(t.isFunction(s)){l=i.parentNode,a=i.getIndex(),s(i);if(i.parentNode){if(i.children)for(u=0;e=i.children[u];)n(e,r),e.parentNode&&u++}else for(u=a;e=l.children[u];)n(e,r),e.parentNode&&u++}else{h=s.$;if(h&&i.attrs){y={};for(o in h)c=i.getAttr(o),o=="style"&&t.isArray(h[o])&&(v=[],t.each(h[o],function(n){var t;(t=i.getStyle(n))&&v.push(n+":"+t)}),c=v.join(";")),c&&(y[o]=c);i.attrs=y}if(i.children)for(u=0;e=i.children[u];)n(e,r),e.parentNode&&u++}else if(f.$cdata[i.tagName])i.parentNode.removeChild(i);else for(l=i.parentNode,a=i.getIndex(),i.parentNode.removeChild(i,!0),u=a;e=l.children[u];)n(e,r),e.parentNode&&u++;break;case"comment":i.parentNode.removeChild(i)}}return function(i,r){var e,u,f;if(t.isEmptyObject(r))return i;for((e=r["-"])&&t.each(e.split(" "),function(n){r[n]="-"}),u=0;f=i.children[u];)n(f,r),f.parentNode&&u++;return i}}(),UE.plugin=function(){var n={};return{register:function(i,r,u,f){u&&t.isFunction(u)&&(f=u,u=null),n[i]={optionName:u||i,execFn:r,afterDisabled:f}},load:function(i){t.each(n,function(n){var r=n.execFn.call(i);i.options[n.optionName]!==!1?r&&t.each(r,function(n,r){switch(r.toLowerCase()){case"shortcutkey":i.addshortcutkey(n);break;case"bindevents":t.each(n,function(n,t){i.addListener(t,n)});break;case"bindmultievents":t.each(t.isArray(n)?n:[n],function(n){var r=t.trim(n.type).split(/\s+/);t.each(r,function(t){i.addListener(t,n.handler)})});break;case"commands":t.each(n,function(n,t){i.commands[t]=n});break;case"outputrule":i.addOutputRule(n);break;case"inputrule":i.addInputRule(n);break;case"defaultoptions":i.setOpt(n)}}):n.afterDisabled&&n.afterDisabled.call(i)}),t.each(UE.plugins,function(n){n.call(i)})},run:function(t,i){var r=n[t];r&&r.exeFn.call(i)}}}(),a=UE.keymap={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,CapsLock:20,Esc:27,Spacebar:32,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Insert:45,Del:46,NumLock:144,Cmd:91,"=":187,"-":189,b:66,i:73,z:90,y:89,v:86,x:88,s:83,n:78},s=UE.LocalStorage=function(){function i(){var n=document.createElement("div");return n.style.display="none",n.addBehavior?(n.addBehavior("#default#userdata"),{getItem:function(i){var r=null;try{document.body.appendChild(n),n.load(t),r=n.getAttribute(i),document.body.removeChild(n)}catch(u){}return r},setItem:function(i,r){document.body.appendChild(n),n.setAttribute(i,r),n.save(t),document.body.removeChild(n)},removeItem:function(i){document.body.appendChild(n),n.removeAttribute(i),n.save(t),document.body.removeChild(n)}}):null}var n=window.localStorage||i()||null,t="localStorage";return{saveLocalData:function(t,i){return n&&i?(n.setItem(t,i),!0):!1},getLocalData:function(t){return n?n.getItem(t):null},removeItem:function(t){n&&n.removeItem(t)}}}(),(function(){var n="ueditor_preference";UE.Editor.prototype.setPreferences=function(i,r){var f={},u;t.isString(i)?f[i]=r:f=i,u=s.getLocalData(n),u&&(u=t.str2json(u))?t.extend(u,f):u=f,u&&s.saveLocalData(n,t.json2str(u))},UE.Editor.prototype.getPreferences=function(i){var r=s.getLocalData(n);return r&&(r=t.str2json(r))?i?r[i]:r:null},UE.Editor.prototype.removePreferences=function(i){var r=s.getLocalData(n);r&&(r=t.str2json(r))&&(r[i]=undefined,delete r[i]),r&&s.saveLocalData(n,t.json2str(r))}})(),UE.plugins.defaultfilter=function(){var n=this;n.setOpt({allowDivTransToP:!0,disabledTableInTable:!0}),n.addInputRule(function(i){function e(n){while(n&&n.type=="element"){if(n.tagName=="td")return!0;n=n.parentNode}return!1}var o=this.options.allowDivTransToP,u;i.traversal(function(i){var h,s,c,l;if(i.type=="element"){if(!f.$cdata[i.tagName]&&n.options.autoClearEmptyNode&&f.$inline[i.tagName]&&!f.$empty[i.tagName]&&(!i.attrs||t.isEmptyObject(i.attrs))){i.firstChild()?i.tagName=="span"&&(!i.attrs||t.isEmptyObject(i.attrs))&&i.parentNode.removeChild(i,!0):i.parentNode.removeChild(i);return}switch(i.tagName){case"style":case"script":i.setAttr({cdata_tag:i.tagName,cdata_data:i.innerHTML()||"",_ue_custom_node_:"true"}),i.tagName="div",i.innerHTML("");break;case"a":(u=i.getAttr("href"))&&i.setAttr("_href",u);break;case"img":if(u=i.getAttr("src"))if(/^data:/.test(u)){i.parentNode.removeChild(i);break}i.setAttr("_src",i.getAttr("src"));break;case"span":r.webkit&&(u=i.getStyle("white-space"))&&/nowrap|normal/.test(u)&&(i.setStyle("white-space",""),n.options.autoClearEmptyNode&&t.isEmptyObject(i.attrs)&&i.parentNode.removeChild(i,!0)),u=i.getAttr("id"),u&&/^_baidu_bookmark_/i.test(u)&&i.parentNode.removeChild(i);break;case"p":(u=i.getAttr("align"))&&(i.setAttr("align"),i.setStyle("text-align",u)),t.each(i.children,function(n){var t,r,u;if(n.type=="element"&&n.tagName=="p"){t=n.nextSibling(),i.parentNode.insertAfter(n,i),r=n;while(t)u=t.nextSibling(),i.parentNode.insertAfter(t,r),r=t,t=u;return!1}}),i.firstChild()||i.innerHTML(r.ie?"&nbsp;":"<br/>");break;case"div":if(i.getAttr("cdata_tag"))break;u=i.getAttr("class");if(u&&/^line number\d+/.test(u))break;if(!o)break;s=UE.uNode.createElement("p");while(h=i.firstChild())h.type=="text"||!UE.dom.dtd.$block[h.tagName]?s.appendChild(h):s.firstChild()?(i.parentNode.insertBefore(s,i),s=UE.uNode.createElement("p")):i.parentNode.insertBefore(h,i);s.firstChild()&&i.parentNode.insertBefore(s,i),i.parentNode.removeChild(i);break;case"dl":i.tagName="ul";break;case"dt":case"dd":i.tagName="li";break;case"li":c=i.getAttr("class"),(!c||!/list\-/.test(c))&&i.setAttr(),l=i.getNodesByTagName("ol ul"),UE.utils.each(l,function(n){i.parentNode.insertAfter(n,i)});break;case"td":case"th":case"caption":(!i.children||!i.children.length)&&i.appendChild(r.ie11below?UE.uNode.createText(" "):UE.uNode.createElement("br"));break;case"table":n.options.disabledTableInTable&&e(i)&&(i.parentNode.insertBefore(UE.uNode.createText(i.innerText()),i),i.parentNode.removeChild(i))}}})}),n.addOutputRule(function(i){var r;i.traversal(function(i){if(i.type=="element"){if(n.options.autoClearEmptyNode&&f.$inline[i.tagName]&&!f.$empty[i.tagName]&&(!i.attrs||t.isEmptyObject(i.attrs))){i.firstChild()?i.tagName=="span"&&(!i.attrs||t.isEmptyObject(i.attrs))&&i.parentNode.removeChild(i,!0):i.parentNode.removeChild(i);return}switch(i.tagName){case"div":(r=i.getAttr("cdata_tag"))&&(i.tagName=r,i.appendChild(UE.uNode.createText(i.getAttr("cdata_data"))),i.setAttr({cdata_tag:"",cdata_data:"",_ue_custom_node_:""}));break;case"a":(r=i.getAttr("_href"))&&i.setAttr({href:t.html(r),_href:""});break;break;case"span":r=i.getAttr("id"),r&&/^_baidu_bookmark_/i.test(r)&&i.parentNode.removeChild(i);break;case"img":(r=i.getAttr("_src"))&&i.setAttr({src:i.getAttr("_src"),_src:""})}}})})},UE.commands.inserthtml={execCommand:function(i,u,e){var l=this,s,k,it,c,o,w,b,tt,y,p,d,nt,g,v,a;if(!u)return;if(l.fireEvent("beforeinserthtml",u)===!0)return;s=l.selection.getRange(),k=s.document.createElement("div"),k.style.display="inline",e||(it=UE.htmlparser(u),l.options.filterRules&&UE.filterNode(it,l.options.filterRules),l.filterInputRule(it),u=it.toHtml()),k.innerHTML=t.trim(u);if(!s.collapsed){c=s.startContainer,n.isFillChar(c)&&s.setStartBefore(c),c=s.endContainer,n.isFillChar(c)&&s.setEndAfter(c),s.txtToElmBoundary(),s.endContainer&&s.endContainer.nodeType==1&&(c=s.endContainer.childNodes[s.endOffset],c&&n.isBr(c)&&s.setEndAfter(c)),s.startOffset==0&&(c=s.startContainer,n.isBoundaryNode(c,"firstChild")&&(c=s.endContainer,s.endOffset==(c.nodeType==3?c.nodeValue.length:c.childNodes.length)&&n.isBoundaryNode(c,"lastChild")&&(l.body.innerHTML="<p>"+(r.ie?"":"<br/>")+"</p>",s.setStart(l.body.firstChild,0).collapse(!0)))),!s.collapsed&&s.deleteContents();if(s.startContainer.nodeType==1){o=s.startContainer.childNodes[s.startOffset];if(o&&n.isBlockElm(o)&&(v=o.previousSibling)&&n.isBlockElm(v)){s.setEnd(v,v.childNodes.length).collapse();while(o.firstChild)v.appendChild(o.firstChild);n.remove(o)}}}tt=0,s.inFillChar()&&(o=s.startContainer,n.isFillChar(o)?(s.setStartBefore(o).collapse(!0),n.remove(o)):n.isFillChar(o,!0)&&(o.nodeValue=o.nodeValue.replace(h,""),s.startOffset--,s.collapsed&&s.collapse(!0))),p=n.findParentByTagName(s.startContainer,"li",!0);if(p){while(o=k.firstChild){while(o&&(o.nodeType==3||!n.isBlockElm(o)||o.tagName=="HR"))a=o.nextSibling,s.insertNode(o).collapse(),d=o,o=a;if(o)if(/^(ol|ul)$/i.test(o.tagName)){while(o.firstChild)d=o.firstChild,n.insertAfter(p,o.firstChild),p=p.nextSibling;n.remove(o)}else a=o.nextSibling,nt=l.document.createElement("li"),n.insertAfter(p,nt),nt.appendChild(o),d=o,o=a,p=nt}p=n.findParentByTagName(s.startContainer,"li",!0),n.isEmptyBlock(p)&&n.remove(p),d&&s.setStartAfter(d).collapse(!0).select(!0)}else{while(o=k.firstChild){if(tt){g=l.document.createElement("p");while(o&&(o.nodeType==3||!f.$block[o.tagName]))y=o.nextSibling,g.appendChild(o),o=y;g.firstChild&&(o=g)}s.insertNode(o),y=o.nextSibling;if(!tt&&o.nodeType==n.NODE_ELEMENT&&n.isBlockElm(o)){w=n.findParent(o,function(t){return n.isBlockElm(t)});if(w&&w.tagName.toLowerCase()!="body"&&!(f[w.tagName][o.nodeName]&&o.parentNode===w)){if(f[w.tagName][o.nodeName]){b=o.parentNode;while(b!==w)v=b,b=b.parentNode}else v=w;n.breakParent(o,v||b),v=o.previousSibling,n.trimWhiteTextNode(v),v.childNodes.length||n.remove(v),!r.ie&&(a=o.nextSibling)&&n.isBlockElm(a)&&a.lastChild&&!n.isBr(a.lastChild)&&a.appendChild(l.document.createElement("br")),tt=1}}a=o.nextSibling;if(!k.firstChild&&a&&n.isBlockElm(a)){s.setStart(a,0).collapse(!0);break}s.setEndAfter(o).collapse()}o=s.startContainer,y&&n.isBr(y)&&n.remove(y);if(n.isBlockElm(o)&&n.isEmptyNode(o))if(y=o.nextSibling)n.remove(o),y.nodeType==1&&f.$block[y.tagName]&&s.setStart(y,0).collapse(!0).shrinkBoundary();else try{o.innerHTML=r.ie?n.fillChar:"<br/>"}catch(rt){s.setStartBefore(o),n.remove(o)}try{s.select(!0)}catch(rt){}}setTimeout(function(){s=l.selection.getRange(),s.scrollToView(l.autoHeightEnabled,l.autoHeightEnabled?n.getXY(l.iframe).y:0),l.fireEvent("afterinserthtml",u)},200)}},UE.plugins.autotypeset=function(){function o(t,i){return!t||t.nodeType==3?0:n.isBr(t)?1:t&&t.parentNode&&v[t.tagName.toLowerCase()]?u&&u.contains(t)||t.getAttribute("pagebreak")?0:i?!n.isEmptyBlock(t):n.isEmptyBlock(t,new RegExp("[\\s"+n.fillChar+"]","g")):void 0}function s(t){t.style.cssText||(n.removeAttributes(t,["style"]),t.tagName.toLowerCase()=="span"&&n.hasNoAttributes(t)&&n.remove(t,!0))}function e(t,r){var b=this,w,rt,tt,e,ut,g,p,l,k,v,nt,it,d;if(r){if(!i.pasteFilter)return;w=b.document.createElement("div"),w.innerHTML=r.html}else w=b.document.body;for(rt=n.getElementsByTagName(w,"*"),tt=0;e=rt[tt++];){if(b.fireEvent("excludeNodeinautotype",e)===!0)continue;i.clearFontSize&&e.style.fontSize&&(n.removeStyle(e,"font-size"),s(e)),i.clearFontFamily&&e.style.fontFamily&&(n.removeStyle(e,"font-family"),s(e));if(o(e)){if(i.mergeEmptyline){v=e.nextSibling,ut=n.isBr(e);while(o(v)){l=v,v=l.nextSibling;if(ut&&(!v||v&&!n.isBr(v)))break;n.remove(l)}}if(i.removeEmptyline&&n.inDoc(e,w)&&!a[e.parentNode.tagName.toLowerCase()]){if(n.isBr(e)){v=e.nextSibling;if(v&&!n.isBr(v))continue}n.remove(e);continue}}o(e,!0)&&e.tagName!="SPAN"&&(i.indent&&(e.style.textIndent=i.indentValue),i.textAlign&&(e.style.textAlign=i.textAlign));if(i.removeClass&&e.className&&!y[e.className.toLowerCase()]){if(u&&u.contains(e))continue;n.removeAttributes(e,["class"])}if(i.imageBlockLine&&e.tagName.toLowerCase()=="img"&&!e.getAttribute("emotion"))if(r){g=e;switch(i.imageBlockLine){case"left":case"right":case"none":p=g.parentNode;while(f.$inline[p.tagName]||p.tagName=="A")p=p.parentNode;l=p;if(l.tagName=="P"&&n.getStyle(l,"text-align")=="center")if(!n.isBody(l)&&n.getChildCount(l,function(t){return!n.isBr(t)&&!n.isWhitespace(t)})==1){k=l.previousSibling,v=l.nextSibling;if(k&&v&&k.nodeType==1&&v.nodeType==1&&k.tagName==v.tagName&&n.isBlockElm(k)){k.appendChild(l.firstChild);while(v.firstChild)k.appendChild(v.firstChild);n.remove(l),n.remove(v)}else n.setStyle(l,"text-align","")}n.setStyle(g,"float",i.imageBlockLine);break;case"center":if(b.queryCommandValue("imagefloat")!="center"){p=g.parentNode,n.setStyle(g,"float","none"),l=g;while(p&&n.getChildCount(p,function(t){return!n.isBr(t)&&!n.isWhitespace(t)})==1&&(f.$inline[p.tagName]||p.tagName=="A"))l=p,p=p.parentNode;nt=b.document.createElement("p"),n.setAttributes(nt,{style:"text-align:center"}),l.parentNode.insertBefore(nt,l),nt.appendChild(l),n.setStyle(l,"float","")}}}else it=b.selection.getRange(),it.selectNode(e).select(),b.execCommand("imagefloat",i.imageBlockLine);i.removeEmptyNode&&i.removeTagNames[e.tagName.toLowerCase()]&&n.hasNoAttributes(e)&&n.isEmptyBlock(e)&&n.remove(e)}i.tobdc&&(d=UE.htmlparser(w.innerHTML),d.traversal(function(n){n.type=="text"&&(n.data=c(n.data))}),w.innerHTML=d.toHtml()),i.bdc2sb&&(d=UE.htmlparser(w.innerHTML),d.traversal(function(n){n.type=="text"&&(n.data=h(n.data))}),w.innerHTML=d.toHtml()),r&&(r.html=w.innerHTML)}function h(n){for(var r="",i,t=0;t<n.length;t++)i=n.charCodeAt(t),r+=i>=65281&&i<=65373?String.fromCharCode(n.charCodeAt(t)-65248):i==12288?String.fromCharCode(n.charCodeAt(t)-12256):n.charAt(t);return r}function c(n){var r,u,i;for(n=t.html(n),r="",u="",i=0;i<n.length;i++)n.charCodeAt(i)==32?r=r+String.fromCharCode(12288):n.charCodeAt(i)<127?r=r+String.fromCharCode(n.charCodeAt(i)+65248):r+=n.charAt(i);return r}function l(){var n=r.getPreferences("autotypeset");t.extend(r.options.autotypeset,n)}this.setOpt({autotypeset:{mergeEmptyline:!0,removeClass:!0,removeEmptyline:!1,textAlign:"left",imageBlockLine:"center",pasteFilter:!1,clearFontSize:!1,clearFontFamily:!1,removeEmptyNode:!1,removeTagNames:t.extend({div:1},f.$removeEmpty),indent:!1,indentValue:"2em",bdc2sb:!1,tobdc:!1}});var r=this,i=r.options.autotypeset,y={selectTdClass:1,pagebreak:1,anchorclass:1},a={li:1},v={div:1,p:1,blockquote:1,center:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,span:1},u;if(!i)return;l(),i.pasteFilter&&r.addListener("beforepaste",e),r.commands.autotypeset={execCommand:function(){r.removeListener("beforepaste",e),i.pasteFilter&&r.addListener("beforepaste",e),e.call(r)}}},UE.plugin.register("autosubmit",function(){return{shortcutkey:{autosubmit:"ctrl+13"},commands:{autosubmit:{execCommand:function(){var t=this,i=n.findParentByTagName(t.iframe,"form",!1);if(i){if(t.fireEvent("beforesubmit")===!1)return;t.sync(),i.submit()}}}}}}),UE.plugin.register("background",function(){function o(n){var i={},r=n.split(";");return t.each(r,function(n){var u=n.indexOf(":"),r=t.trim(n.substr(0,u)).toLowerCase();r&&(i[r]=t.trim(n.substr(u+1)||""))}),i}function f(n){var f,r;if(n){f=[];for(r in n)n.hasOwnProperty(r)&&f.push(r+":"+n[r]+"; ");t.cssRule(u,f.length?"body{"+f.join("")+"}":"",i.document)}else t.cssRule(u,"",i.document)}var i=this,u="editor_background",e,s=new RegExp("body[\\s]*\\{(.+)\\}","i"),h=i.hasContents;return i.hasContents=function(){return i.queryCommandValue("background")?!0:h.apply(i,arguments)},{bindEvents:{getAllHtml:function(t,u){var f=this.body,e=n.getComputedStyle(f,"background-image"),h="",c,o,s;h=e.indexOf(i.options.imagePath)>0?e.substring(e.indexOf(i.options.imagePath),e.length-1).replace(/"|\(|\)/ig,""):e!="none"?e.replace(/url\("?|"?\)/ig,""):"",c='<style type="text/css">body{',o={"background-color":n.getComputedStyle(f,"background-color")||"#ffffff","background-image":h?"url("+h+")":"","background-repeat":n.getComputedStyle(f,"background-repeat")||"","background-position":r.ie?n.getComputedStyle(f,"background-position-x")+" "+n.getComputedStyle(f,"background-position-y"):n.getComputedStyle(f,"background-position"),height:n.getComputedStyle(f,"height")};for(s in o)o.hasOwnProperty(s)&&(c+=s+":"+o[s]+"; ");c+="}</style> ",u.push(c)},aftersetcontent:function(){e==!1&&f()}},inputRule:function(n){e=!1,t.each(n.getNodesByTagName("p"),function(n){var t=n.getAttr("data-background");t&&(e=!0,f(o(t)),n.parentNode.removeChild(n))})},outputRule:function(n){var r=this,i=(t.cssRule(u,r.document)||"").replace(/[\n\r]+/g,"").match(s);i&&n.appendChild(UE.uNode.createElement('<p style="display:none;" data-background="'+t.trim(i[1].replace(/"/g,"").replace(/[\s]+/g," "))+'"><br/></p>'))},commands:{background:{execCommand:function(n,t){f(t)},queryCommandValue:function(){var i=this,n=(t.cssRule(u,i.document)||"").replace(/[\n\r]+/g,"").match(s);return n?o(n[1]):null},notNeedUndo:!0}}}}),UE.commands.imagefloat={execCommand:function(t,i){var h=this,c=h.selection.getRange(),o,u,r,s,e;if(!c.collapsed){o=c.getClosedNode();if(o&&o.tagName=="IMG")switch(i){case"left":case"right":case"none":u=o.parentNode;while(f.$inline[u.tagName]||u.tagName=="A")u=u.parentNode;r=u;if(r.tagName=="P"&&n.getStyle(r,"text-align")=="center"){if(!n.isBody(r)&&n.getChildCount(r,function(t){return!n.isBr(t)&&!n.isWhitespace(t)})==1){s=r.previousSibling,e=r.nextSibling;if(s&&e&&s.nodeType==1&&e.nodeType==1&&s.tagName==e.tagName&&n.isBlockElm(s)){s.appendChild(r.firstChild);while(e.firstChild)s.appendChild(e.firstChild);n.remove(r),n.remove(e)}else n.setStyle(r,"text-align","")}c.selectNode(o).select()}n.setStyle(o,"float",i=="none"?"":i),i=="none"&&n.removeAttributes(o,"align");break;case"center":if(h.queryCommandValue("imagefloat")!="center"){u=o.parentNode,n.setStyle(o,"float",""),n.removeAttributes(o,"align"),r=o;while(u&&n.getChildCount(u,function(t){return!n.isBr(t)&&!n.isWhitespace(t)})==1&&(f.$inline[u.tagName]||u.tagName=="A"))r=u,u=u.parentNode;c.setStartBefore(r).setCursor(!1),u=h.document.createElement("div"),u.appendChild(r),n.setStyle(r,"float",""),h.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+u.innerHTML+"</p>"),r=h.document.getElementById("_img_parent_tmp"),r.removeAttribute("id"),r=r.firstChild,c.selectNode(r).select(),e=r.parentNode.nextSibling,e&&n.isEmptyNode(e)&&n.remove(e)}}}},queryCommandValue:function(){var r=this.selection.getRange(),t,i;if(r.collapsed)return"none";return t=r.getClosedNode(),t&&t.nodeType==1&&t.tagName=="IMG"?(i=n.getComputedStyle(t,"float")||t.getAttribute("align"),i=="none"&&(i=n.getComputedStyle(t.parentNode,"text-align")=="center"?"center":i),({left:1,right:1,center:1})[i]?i:"none"):"none"},queryCommandState:function(){var t=this.selection.getRange(),n;if(t.collapsed)return-1;return n=t.getClosedNode(),n&&n.nodeType==1&&n.tagName=="IMG"?0:-1}},UE.commands.insertimage={execCommand:function(i,r){var h,a,s,f,u,c;r=t.isArray(r)?r:[r];if(!r.length)return;var o=this,l=o.selection.getRange(),e=l.getClosedNode();if(o.fireEvent("beforeinsertimage",r)===!0)return;if(e&&/img/i.test(e.tagName)&&(e.className!="edui-faked-video"||e.className.indexOf("edui-upload-video")!=-1)&&!e.getAttribute("word_img"))h=r.shift(),a=h.floatStyle,delete h.floatStyle,n.setAttributes(e,h),o.execCommand("imagefloat",a),r.length>0&&(l.setStartAfter(e).setCursor(!1,!0),o.execCommand("insertimage",r));else{s=[],f="",u=r[0];if(r.length==1)f='<img src="'+u.src+'" '+(u._src?' _src="'+u._src+'" ':"")+(u.width?'width="'+u.width+'" ':"")+(u.height?' height="'+u.height+'" ':"")+(u.floatStyle=="left"||u.floatStyle=="right"?' style="float:'+u.floatStyle+';"':"")+(u.title&&u.title!=""?' title="'+u.title+'"':"")+(u.border&&u.border!="0"?' border="'+u.border+'"':"")+(u.alt&&u.alt!=""?' alt="'+u.alt+'"':"")+(u["class"]&&u["class"]!=""?' class="'+u["class"]+'"':"")+(u.path&&u.path!=""?' path="'+u.path+'"':"")+(u.apath&&u.apath!=""?' apath="'+u.apath+'"':"")+(u.aid&&u.aid!=""?' aid="'+u.aid+'"':"")+(u.dsize&&u.dsize!=""?' dsize="'+u.dsize+'"':"")+(u.ext&&u.ext!=""?' ext="'+u.ext+'"':"")+(u.hspace&&u.hspace!="0"?' hspace = "'+u.hspace+'"':"")+(u.vspace&&u.vspace!="0"?' vspace = "'+u.vspace+'"':"")+"/>",u.floatStyle=="center"&&(f='<p style="text-align: center">'+f+"</p>"),s.push(f);else for(c=0;u=r[c++];)f="<p "+(u.floatStyle=="center"?'style="text-align: center" ':"")+'><img src="'+u.src+'" '+(u.width?'width="'+u.width+'" ':"")+(u._src?' _src="'+u._src+'" ':"")+(u.height?' height="'+u.height+'" ':"")+(u["class"]&&u["class"]!=""?' class="'+u["class"]+'"':"")+(u.path&&u.path!=""?' path="'+u.path+'"':"")+(u.apath&&u.apath!=""?' apath="'+u.apath+'"':"")+(u.aid&&u.aid!=""?' aid="'+u.aid+'"':"")+(u.dsize&&u.dsize!=""?' dsize="'+u.dsize+'"':"")+(u.ext&&u.ext!=""?' ext="'+u.ext+'"':"")+' style="'+(u.floatStyle&&u.floatStyle!="center"?"float:"+u.floatStyle+";":"")+(u.border||"")+'" '+(u.title?' title="'+u.title+'"':"")+" /></p>",s.push(f);o.execCommand("insertHtml",s.join(""))}o.fireEvent("afterinsertimage",r)}},UE.plugins.justify=function(){var f=this,i=n.isBlockElm,r={left:1,right:1,center:1,justify:1},u=function(r,u){var v=r.createBookmark(),c=function(t){return t.nodeType==1?t.tagName.toLowerCase()!="br"&&!n.isBookmarkNode(t):!n.isWhitespace(t)},o,e,l;r.enlarge(!0);var h=r.createBookmark(),f=n.getNextDomNode(h.start,!1,c),s=r.cloneRange(),a;while(f&&!(n.getPosition(f,h.end)&n.POSITION_FOLLOWING))if(f.nodeType==3||!i(f)){s.setStartBefore(f);while(f&&f!==h.end&&!i(f))a=f,f=n.getNextDomNode(f,!1,null,function(n){return!i(n)});s.setEndAfter(a),o=s.getCommonAncestor(),!n.isBody(o)&&i(o)?(n.setStyles(o,t.isString(u)?{"text-align":u}:u),f=o):(e=r.document.createElement("p"),n.setStyles(e,t.isString(u)?{"text-align":u}:u),l=s.extractContents(),e.appendChild(l),s.insertNode(e),f=e),f=n.getNextDomNode(f,!1,c)}else f=n.getNextDomNode(f,!0,c);return r.moveToBookmark(h).moveToBookmark(v)};UE.commands.justify={execCommand:function(t,i){var f=this.selection.getRange(),r;return f.collapsed&&(r=this.document.createTextNode("p"),f.insertNode(r)),u(f,i),r&&(f.setStartBefore(r).collapse(!0),n.remove(r)),f.select(),!0},queryCommandValue:function(){var i=this.selection.getStart(),t=n.getComputedStyle(i,"text-align");return r[t]?t:"left"},queryCommandState:function(){var t=this.selection.getStart(),i=t&&n.findParentByTagName(t,["td","th","caption"],!0);return i?-1:0}}},UE.plugins.font=function(){function l(t){var i;while(i=t.parentNode)if(i.tagName=="SPAN"&&n.getChildCount(i,function(t){return!n.isBookmarkNode(t)&&!n.isBr(t)})==1)i.style.cssText+=t.style.cssText,n.remove(t,!0),t=i;else break}function a(i,r,u){var f,e;s[r]&&(i.adjustmentBoundary(),!i.collapsed&&i.startContainer.nodeType==1&&(f=i.startContainer.childNodes[i.startOffset],f&&n.isTagNode(f,"span")&&(e=i.createBookmark(),t.each(n.getElementsByTagName(f,"span"),function(t){if(!t.parentNode||n.isBookmarkNode(t))return;if(r=="backcolor"&&n.getComputedStyle(t,"background-color").toLowerCase()===u)return;n.removeStyle(t,s[r]),t.style.cssText.replace(/^\s+$/,"").length==0&&n.remove(t,!0)}),i.moveToBookmark(e))))}function u(i,u,e){var h=i.collapsed,s=i.createBookmark(),o;if(h){o=s.start.parentNode;while(f.$inline[o.tagName])o=o.parentNode}else o=n.getCommonAncestor(s.start,s.end);t.each(n.getElementsByTagName(o,"span"),function(t){var i,f;if(!t.parentNode||n.isBookmarkNode(t))return;if(/\s*border\s*:\s*none;?\s*/i.test(t.style.cssText)){/^\s*border\s*:\s*none;?\s*$/.test(t.style.cssText)?n.remove(t,!0):n.removeStyle(t,"border");return}/border/i.test(t.style.cssText)&&t.parentNode.tagName=="SPAN"&&/border/i.test(t.parentNode.style.cssText)&&(t.style.cssText=t.style.cssText.replace(/border[^:]*:[^;]+;?/gi,""));if(!(u=="fontborder"&&e=="none")){i=t.nextSibling;while(i&&i.nodeType==1&&i.tagName=="SPAN"){if(n.isBookmarkNode(i)&&u=="fontborder"){t.appendChild(i),i=t.nextSibling;continue}i.style.cssText==t.style.cssText&&(n.moveChild(i,t),n.remove(i));if(t.nextSibling===i)break;i=t.nextSibling}}l(t),r.ie&&r.version>8&&(f=n.findParent(t,function(n){return n.tagName=="SPAN"&&/background-color/.test(n.style.cssText)}),f&&!/background-color/.test(t.style.cssText)&&(t.style.backgroundColor=f.style.backgroundColor))}),i.moveToBookmark(s),a(i,u,e)}var o=this,c={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration",fontborder:"border"},i={underline:1,strikethrough:1,fontborder:1},s={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family"},e;o.setOpt({fontfamily:[{name:"songti",val:"\u5b8b\u4f53,SimSun"},{name:"yahei",val:"\u5fae\u8f6f\u96c5\u9ed1,Microsoft YaHei"},{name:"kaiti",val:"\u6977\u4f53,\u6977\u4f53_GB2312, SimKai"},{name:"heiti",val:"\u9ed1\u4f53, SimHei"},{name:"lishu",val:"\u96b6\u4e66, SimLi"},{name:"andaleMono",val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"}],fontsize:[10,11,12,14,16,18,20,24,36]}),o.addInputRule(function(n){t.each(n.getNodesByTagName("u s del font strike"),function(n){var i,t,r;if(n.tagName=="font"){i=[];for(t in n.attrs)switch(t){case"size":i.push("font-size:"+(({"1":"10","2":"12","3":"16","4":"18","5":"24","6":"32","7":"48"})[n.attrs[t]]||n.attrs[t])+"px");break;case"color":i.push("color:"+n.attrs[t]);break;case"face":i.push("font-family:"+n.attrs[t]);break;case"style":i.push(n.attrs[t])}n.attrs={style:i.join(";")}}else r=n.tagName=="u"?"underline":"line-through",n.attrs={style:(n.getAttr("style")||"")+"text-decoration:"+r+";"};n.tagName="span"})});for(e in c)(function(t,e){UE.commands[t]={execCommand:function(f,o){var a,s,c,l,v;o=o||(this.queryCommandState(f)?"none":f=="underline"?"underline":f=="fontborder"?"1px solid #000":"line-through"),a=this,s=this.selection.getRange();if(o=="default")s.collapsed&&(c=a.document.createTextNode("font"),s.insertNode(c).select()),a.execCommand("removeFormat","span,a",e),c&&(s.setStartBefore(c).collapse(!0),n.remove(c)),u(s,f,o),s.select();else if(s.collapsed){l=n.findParentByTagName(s.startContainer,"span",!0),c=a.document.createTextNode("font");if(l&&!l.children.length&&!l[r.ie?"innerText":"textContent"].replace(h,"").length)s.insertNode(c),i[t]&&(s.selectNode(c).select(),a.execCommand("removeFormat","span,a",e,null),l=n.findParentByTagName(c,"span",!0),s.setStartBefore(c)),l&&(l.style.cssText+=";"+e+":"+o),s.collapse(!0).select();else{s.insertNode(c),s.selectNode(c).select(),l=s.document.createElement("span");if(i[t]){if(n.findParentByTagName(c,"a",!0)){s.setStartBefore(c).setCursor(),n.remove(c);return}a.execCommand("removeFormat","span,a",e)}l.style.cssText=e+":"+o,c.parentNode.insertBefore(l,c);if(!r.ie||r.ie&&r.version==9){v=l.parentNode;while(!n.isBlockElm(v))v.tagName=="SPAN"&&(l.style.cssText=v.style.cssText+";"+l.style.cssText),v=v.parentNode}b?setTimeout(function(){s.setStart(l,0).collapse(!0),u(s,f,o),s.select()}):(s.setStart(l,0).collapse(!0),u(s,f,o),s.select())}n.remove(c)}else i[t]&&a.queryCommandValue(t)&&a.execCommand("removeFormat","span,a",e),s=a.selection.getRange(),s.applyInlineStyle("span",{style:e+":"+o}),u(s,f,o),s.select();return!0},queryCommandValue:function(t){var o=this.selection.getStart(),r,h,u,s,i;if(t=="underline"||t=="strikethrough"){r=o;while(r&&!n.isBlockElm(r)&&!n.isBody(r)){if(r.nodeType==1){h=n.getComputedStyle(r,e);if(h!="none")return h}r=r.parentNode}return"none"}if(t=="fontborder"){i=o;while(i&&f.$inline[i.tagName]){if(u=n.getComputedStyle(i,"border"))if(/1px/.test(u)&&/solid/.test(u))return u;i=i.parentNode}return""}return t=="FontSize"?(s=n.getComputedStyle(o,e),i=/^([\d\.]+)(\w+)$/.exec(s),i?Math.floor(i[1])+i[2]:s):n.getComputedStyle(o,e)},queryCommandState:function(n){if(!i[n])return 0;var t=this.queryCommandValue(n);return n=="fontborder"?/1px/.test(t)&&/solid/.test(t):n=="underline"?/underline/.test(t):/line\-through/.test(t)}}})(e,c[e])},UE.plugins.link=function(){function i(t){var r=t.startContainer,i=t.endContainer;(r=n.findParentByTagName(r,"a",!0))&&t.setStartBefore(r),(i=n.findParentByTagName(i,"a",!0))&&t.setEndAfter(i)}function u(u,f,e){var h=u.cloneRange(),l=e.queryCommandValue("link"),o,s,c;i(u=u.adjustmentBoundary()),o=u.startContainer,o.nodeType==1&&l&&(o=o.childNodes[u.startOffset],o&&o.nodeType==1&&o.tagName=="A"&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(o[r.ie?"innerText":"textContent"])&&(o[r.ie?"innerText":"textContent"]=t.html(f.textValue||f.href))),(!h.collapsed||l)&&(u.removeInlineStyle("a"),h=u.cloneRange()),h.collapsed?(s=u.document.createElement("a"),c="",f.textValue?(c=t.html(f.textValue),delete f.textValue):c=t.html(f.href),n.setAttributes(s,f),o=n.findParentByTagName(h.startContainer,"a",!0),o&&n.isInNodeEndBoundary(h,o)&&u.setStartAfter(o).collapse(!0),s[r.ie?"innerText":"textContent"]=c,u.insertNode(s).selectNode(s)):u.applyInlineStyle("a",f)}UE.commands.unlink={execCommand:function(){var t=this.selection.getRange(),r;if(t.collapsed&&!n.findParentByTagName(t.startContainer,"a",!0))return;r=t.createBookmark(),i(t),t.removeInlineStyle("a").moveToBookmark(r).select()},queryCommandState:function(){return!this.highlight&&this.queryCommandValue("link")?0:-1}},UE.commands.link={execCommand:function(n,i){var r;i._href&&(i._href=t.unhtml(i._href,/[<">]/g)),i.href&&(i.href=t.unhtml(i.href,/[<">]/g)),i.textValue&&(i.textValue=t.unhtml(i.textValue,/[<">]/g)),u(r=this.selection.getRange(),i,this),r.collapse().select(!0)},queryCommandValue:function(){var t=this.selection.getRange(),i,s,e,f,o,r;if(t.collapsed){i=t.startContainer,i=i.nodeType==1?i:i.parentNode;if(i&&(i=n.findParentByTagName(i,"a",!0))&&!n.isInNodeEndBoundary(t,i))return i}else{t.shrinkBoundary();var c=t.startContainer.nodeType==3||!t.startContainer.childNodes[t.startOffset]?t.startContainer:t.startContainer.childNodes[t.startOffset],h=t.endContainer.nodeType==3||t.endOffset==0?t.endContainer:t.endContainer.childNodes[t.endOffset-1],u=t.getCommonAncestor();i=n.findParentByTagName(u,"a",!0);if(!i&&u.nodeType==1)for(s=u.getElementsByTagName("a"),o=0;r=s[o++];){e=n.getPosition(r,c),f=n.getPosition(r,h);if((e&n.POSITION_FOLLOWING||e&n.POSITION_CONTAINS)&&(f&n.POSITION_PRECEDING||f&n.POSITION_CONTAINS)){i=r;break}}return i}},queryCommandState:function(){var n=this.selection.getRange().getClosedNode(),t=n&&(n.className=="edui-faked-video"||n.className.indexOf("edui-upload-video")!=-1);return t?-1:0}}},UE.plugins.insertframe=function(){function t(){n._iframe&&delete n._iframe}var n=this;n.addListener("selectionchange",function(){t()})},UE.commands.scrawl={queryCommandState:function(){return r.ie&&r.version<=8?-1:0}},UE.plugins.removeformat=function(){var t=this;t.setOpt({removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"}),t.commands.removeformat={execCommand:function(t,i,u,o,s){function v(n){var i,t,u;if(n.nodeType==3||n.tagName.toLowerCase()!="span")return 0;if(r.ie){i=n.attributes;if(i.length){for(t=0,u=i.length;t<u;t++)if(i[t].specified)return 0;return 1}}return!n.attributes.length}function p(t){var k=t.createBookmark(),o,r,b,e,i,l,p;t.collapsed&&t.enlarge(!0),s||(o=n.findParentByTagName(t.startContainer,"a",!0),o&&t.setStartBefore(o),o=n.findParentByTagName(t.endContainer,"a",!0),o&&t.setEndAfter(o)),h=t.createBookmark(),i=h.start;while((c=i.parentNode)&&!n.isBlockElm(c))n.breakParent(i,c),n.clearEmptySibling(i);if(h.end){i=h.end;while((c=i.parentNode)&&!n.isBlockElm(c))n.breakParent(i,c),n.clearEmptySibling(i);r=n.getNextDomNode(h.start,!1,y);while(r){if(r==h.end)break;b=n.getNextDomNode(r,!0,y),!f.$empty[r.tagName.toLowerCase()]&&!n.isBookmarkNode(r)&&(w.test(r.tagName)?u?(n.removeStyle(r,u),v(r)&&u!="text-decoration"&&n.remove(r,!0)):n.remove(r,!0):!f.$tableContent[r.tagName]&&!f.$list[r.tagName]&&(n.removeAttributes(r,a),v(r)&&n.remove(r,!0))),r=b}}e=h.start.parentNode,n.isBlockElm(e)&&!f.$tableContent[e.tagName]&&!f.$list[e.tagName]&&n.removeAttributes(e,a),e=h.end.parentNode,h.end&&n.isBlockElm(e)&&!f.$tableContent[e.tagName]&&!f.$list[e.tagName]&&n.removeAttributes(e,a),t.moveToBookmark(h).moveToBookmark(k),i=t.startContainer,p=t.collapsed;while(i.nodeType==1&&n.isEmptyNode(i)&&f.$removeEmpty[i.tagName])l=i.parentNode,t.setStartBefore(i),t.startContainer===t.endContainer&&t.endOffset--,n.remove(i),i=l;if(!p){i=t.endContainer;while(i.nodeType==1&&n.isEmptyNode(i)&&f.$removeEmpty[i.tagName])l=i.parentNode,t.setEndBefore(i),n.remove(i),i=l}}var w=new RegExp("^(?:"+(i||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),a=u?[]:(o||this.options.removeFormatAttributes).split(","),l=new e.Range(this.document),h,b,c,y=function(n){return n.nodeType==1};l=this.selection.getRange(),p(l),l.select()}}},UE.plugins.blockquote=function(){function t(t){return n.filterNodeList(t.selection.getStartElementPath(),"blockquote")}var i=this;i.commands.blockquote={execCommand:function(i,r){var l=this.selection.getRange(),c=t(this),g=f.blockquote,nt=l.createBookmark(),d,a,k,v,y;if(c){var p=l.startContainer,s=n.isBlockElm(p)?p:n.findParent(p,function(t){return n.isBlockElm(t)}),w=l.endContainer,h=n.isBlockElm(w)?w:n.findParent(w,function(t){return n.isBlockElm(t)});for(s=n.findParentByTagName(s,"li",!0)||s,h=n.findParentByTagName(h,"li",!0)||h,s.tagName=="LI"||s.tagName=="TD"||s===c||n.isBody(s)?n.remove(c,!0):n.breakParent(s,c),s!==h&&(c=n.findParentByTagName(h,"blockquote"),c&&(h.tagName=="LI"||h.tagName=="TD"||n.isBody(h)?c.parentNode&&n.remove(c,!0):n.breakParent(h,c))),d=n.getElementsByTagName(this.document,"blockquote"),v=0;a=d[v++];)a.childNodes.length?n.getPosition(a,s)&n.POSITION_FOLLOWING&&n.getPosition(a,h)&n.POSITION_PRECEDING&&n.remove(a,!0):n.remove(a)}else{for(var e=l.cloneRange(),u=e.startContainer.nodeType==1?e.startContainer:e.startContainer.parentNode,o=u,b=1;;){if(n.isBody(u)){o!==u?l.collapsed?(e.selectNode(o),b=0):e.setStartBefore(o):e.setStart(u,0);break}if(!g[u.tagName]){l.collapsed?e.selectNode(o):e.setStartBefore(o);break}o=u,u=u.parentNode}if(b){o=u=u=e.endContainer.nodeType==1?e.endContainer:e.endContainer.parentNode;while(1){if(n.isBody(u)){o!==u?e.setEndAfter(o):e.setEnd(u,u.childNodes.length);break}if(!g[u.tagName]){e.setEndAfter(o);break}o=u,u=u.parentNode}}for(u=l.document.createElement("blockquote"),n.setAttributes(u,r),u.appendChild(e.extractContents()),e.insertNode(u),k=n.getElementsByTagName(u,"blockquote"),v=0;y=k[v++];)y.parentNode&&n.remove(y,!0)}l.moveToBookmark(nt).select()},queryCommandState:function(){return t(this)?1:0}}},UE.commands.touppercase=UE.commands.tolowercase={execCommand:function(t){var o=this,r=o.selection.getRange();if(r.collapsed)return r;var u=r.createBookmark(),f=u.end,e=function(t){return!n.isBr(t)&&!n.isWhitespace(t)},i=n.getNextDomNode(u.start,!1,e);while(i&&n.getPosition(i,f)&n.POSITION_PRECEDING){i.nodeType==3&&(i.nodeValue=i.nodeValue[t=="touppercase"?"toUpperCase":"toLowerCase"]()),i=n.getNextDomNode(i,!0,e);if(i===f)break}r.moveToBookmark(u).select()}},UE.commands.indent={execCommand:function(){var n=this,t=n.queryCommandState("indent")?"0em":n.options.indentValue||"2em";n.execCommand("Paragraph","p",{style:"text-indent:"+t})},queryCommandState:function(){var t=n.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return t&&t.style.textIndent&&parseInt(t.style.textIndent)?1:0}},UE.commands.print={execCommand:function(){this.window.print()},notNeedUndo:1},UE.commands.preview={execCommand:function(){var t=window.open("","_blank",""),n=t.document;n.open(),n.write('<!DOCTYPE html><html><head><meta charset="utf-8"/><script src="'+this.options.UEDITOR_HOME_URL+"ueditor.parse.js\"><\/script><script>setTimeout(function(){uParse('div',{rootPath: '"+this.options.UEDITOR_HOME_URL+"'})},300)<\/script></head><body><div>"+this.getContent(null,null,!0)+"</div></body></html>"),n.close()},notNeedUndo:1},UE.plugins.selectall=function(){var t=this;t.commands.selectall={execCommand:function(){var u=this,t=u.body,i=u.selection.getRange();i.selectNodeContents(t),n.isEmptyBlock(t)&&(r.opera&&t.firstChild&&t.firstChild.nodeType==1&&i.setStartAtFirst(t.firstChild),i.collapse(!0)),i.select(!0)},notNeedUndo:1},t.addshortcutkey({selectAll:"ctrl+65"})},UE.plugins.paragraph=function(){var f=this,i=n.isBlockElm,u=["TD","LI","PRE"],e=function(r,f,e,o){var p=r.createBookmark(),v=function(t){return t.nodeType==1?t.tagName.toLowerCase()!="br"&&!n.isBookmarkNode(t):!n.isWhitespace(t)},s,h;r.enlarge(!0);var a=r.createBookmark(),c=n.getNextDomNode(a.start,!1,v),l=r.cloneRange(),y;while(c&&!(n.getPosition(c,a.end)&n.POSITION_FOLLOWING))if(c.nodeType==3||!i(c)){l.setStartBefore(c);while(c&&c!==a.end&&!i(c))y=c,c=n.getNextDomNode(c,!1,null,function(n){return!i(n)});l.setEndAfter(y),s=r.document.createElement(f),e&&(n.setAttributes(s,e),o&&o=="customstyle"&&e.style&&(s.style.cssText=e.style)),s.appendChild(l.extractContents()),n.isEmptyNode(s)&&n.fillChar(r.document,s),l.insertNode(s),h=s.parentNode,i(h)&&!n.isBody(s.parentNode)&&t.indexOf(u,h.tagName)==-1&&(o&&o=="customstyle"||(h.getAttribute("dir")&&s.setAttribute("dir",h.getAttribute("dir")),h.style.cssText&&(s.style.cssText=h.style.cssText+";"+s.style.cssText),h.style.textAlign&&!s.style.textAlign&&(s.style.textAlign=h.style.textAlign),h.style.textIndent&&!s.style.textIndent&&(s.style.textIndent=h.style.textIndent),h.style.padding&&!s.style.padding&&(s.style.padding=h.style.padding)),e&&/h\d/i.test(h.tagName)&&!/h\d/i.test(s.tagName)?(n.setAttributes(h,e),o&&o=="customstyle"&&e.style&&(h.style.cssText=e.style),n.remove(s,!0),s=h):n.remove(s.parentNode,!0)),c=t.indexOf(u,h.tagName)!=-1?h:s,c=n.getNextDomNode(c,!1,v)}else c=n.getNextDomNode(c,!0,v);return r.moveToBookmark(a).moveToBookmark(p)};f.setOpt("paragraph",{p:"",h1:"",h2:"",h3:"",h4:"",h5:"",h6:""}),f.commands.paragraph={execCommand:function(t,i,u,f){var o=this.selection.getRange(),h,s,c;return o.collapsed&&(h=this.document.createTextNode("p"),o.insertNode(h),r.ie&&(s=h.previousSibling,s&&n.isWhitespace(s)&&n.remove(s),s=h.nextSibling,s&&n.isWhitespace(s)&&n.remove(s))),o=e(o,i,u,f),h&&(o.setStartBefore(h).collapse(!0),pN=h.parentNode,n.remove(h),n.isBlockElm(pN)&&n.isEmptyNode(pN)&&n.fillNode(this.document,pN)),r.gecko&&o.collapsed&&o.startContainer.nodeType==1&&(c=o.startContainer.childNodes[o.startOffset],c&&c.nodeType==1&&c.tagName.toLowerCase()==i&&o.setStart(c,0).collapse(!0)),o.select(),!0},queryCommandValue:function(){var t=n.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return t?t.tagName.toLowerCase():""}}},(function(){var t=n.isBlockElm,i=function(t){return n.filterNodeList(t.selection.getStartElementPath(),function(n){return n&&n.nodeType==1&&n.getAttribute("dir")})},r=function(r,u,f){var v,l=function(t){return t.nodeType==1?!n.isBookmarkNode(t):!n.isWhitespace(t)},y=i(u),h,o,a;if(y&&r.collapsed)return y.setAttribute("dir",f),r;v=r.createBookmark(),r.enlarge(!0);var c=r.createBookmark(),e=n.getNextDomNode(c.start,!1,l),s=r.cloneRange(),p;while(e&&!(n.getPosition(e,c.end)&n.POSITION_FOLLOWING))if(e.nodeType==3||!t(e)){s.setStartBefore(e);while(e&&e!==c.end&&!t(e))p=e,e=n.getNextDomNode(e,!1,null,function(n){return!t(n)});s.setEndAfter(p),h=s.getCommonAncestor(),!n.isBody(h)&&t(h)?(h.setAttribute("dir",f),e=h):(o=r.document.createElement("p"),o.setAttribute("dir",f),a=s.extractContents(),o.appendChild(a),s.insertNode(o),e=o),e=n.getNextDomNode(e,!1,l)}else e=n.getNextDomNode(e,!0,l);return r.moveToBookmark(c).moveToBookmark(v)};UE.commands.directionality={execCommand:function(t,i){var f=this.selection.getRange(),u;return f.collapsed&&(u=this.document.createTextNode("d"),f.insertNode(u)),r(f,this,i),u&&(f.setStartBefore(u).collapse(!0),n.remove(u)),f.select(),!0},queryCommandValue:function(){var n=i(this);return n?n.getAttribute("dir"):"ltr"}}})(),UE.plugins.horizontal=function(){var t=this;t.commands.horizontal={execCommand:function(n){var r=this,i,u,t;if(r.queryCommandState(n)!==-1)return r.execCommand("insertHtml","<hr>"),i=r.selection.getRange(),u=i.startContainer,u.nodeType==1&&!u.childNodes[i.startOffset]&&(t=u.childNodes[i.startOffset-1])&&t.nodeType==1&&t.tagName=="HR"&&(r.options.enterTag=="p"?(t=r.document.createElement("p"),i.insertNode(t),i.setStart(t,0).setCursor()):(t=r.document.createElement("br"),i.insertNode(t),i.setStartBefore(t).setCursor())),!0},queryCommandState:function(){return n.filterNodeList(this.selection.getStartElementPath(),"table")?-1:0}},t.addListener("delkeydown",function(t,i){var u=this.selection.getRange(),f,r;u.txtToElmBoundary(!0);if(n.isStartInblock(u)){f=u.startContainer,r=f.previousSibling;if(r&&n.isTagNode(r,"hr"))return n.remove(r),u.select(),n.preventDefault(i),!0}})},UE.commands.time=UE.commands.date={execCommand:function(n,t){function u(n,t){var u=("0"+n.getHours()).slice(-2),r=("0"+n.getMinutes()).slice(-2),i=("0"+n.getSeconds()).slice(-2);return t=t||"hh:ii:ss",t.replace(/hh/ig,u).replace(/ii/ig,r).replace(/ss/ig,i)}function r(n,t){var i=("000"+n.getFullYear()).slice(-4),f=i.slice(-2),u=("0"+(n.getMonth()+1)).slice(-2),r=("0"+n.getDate()).slice(-2);return t=t||"yyyy-mm-dd",t.replace(/yyyy/ig,i).replace(/yy/ig,f).replace(/mm/ig,u).replace(/dd/ig,r)}var i=new Date;this.execCommand("insertHtml",n=="time"?u(i,t):r(i,t))}},UE.plugins.rowspacing=function(){var t=this;t.setOpt({rowspacingtop:["5","10","15","20","25"],rowspacingbottom:["5","10","15","20","25"]}),t.commands.rowspacing={execCommand:function(n,t,i){return this.execCommand("paragraph","p",{style:"margin-"+i+":"+t+"px"}),!0},queryCommandValue:function(t,i){var u=n.filterNodeList(this.selection.getStartElementPath(),function(t){return n.isBlockElm(t)}),r;return u?(r=n.getComputedStyle(u,"margin-"+i).replace(/[^\d]/g,""),r?r:0):0}}},UE.plugins.lineheight=function(){var t=this;t.setOpt({lineheight:["1","1.5","1.75","2","3","4","5"]}),t.commands.lineheight={execCommand:function(n,t){return this.execCommand("paragraph","p",{style:"line-height:"+(t=="1"?"normal":t+"em")}),!0},queryCommandValue:function(){var i=n.filterNodeList(this.selection.getStartElementPath(),function(t){return n.isBlockElm(t)}),t;if(i)return t=n.getComputedStyle(i,"line-height"),t=="normal"?1:t.replace(/[^\d.]*/ig,"")}}},UE.plugins.insertcode=function(){var i=this,u;i.ready(function(){t.cssRule("pre","pre{margin:.5em 0;padding:.4em .6em;border-radius:8px;background:#f8f8f8;}",i.document)}),i.setOpt("insertcode",{as3:"ActionScript3",bash:"Bash/Shell",cpp:"C/C++",css:"Css",cf:"CodeFunction","c#":"C#",delphi:"Delphi",diff:"Diff",erlang:"Erlang",groovy:"Groovy",html:"Html",java:"Java",jfx:"JavaFx",js:"Javascript",pl:"Perl",php:"Php",plain:"Plain Text",ps:"PowerShell",python:"Python",ruby:"Ruby",scala:"Scala",sql:"Sql",vb:"Vb",xml:"Xml"}),i.commands.insertcode={execCommand:function(i,u){var h=this,c=h.selection.getRange(),o=n.findParentByTagName(c.startContainer,"pre",!0),e,a,l,s;o?o.className="brush:"+u+";toolbar:false;":(e="",c.collapsed?e=r.ie&&r.ie11below?r.version<=8?"&nbsp;":"":"<br/>":(a=c.extractContents(),l=h.document.createElement("div"),l.appendChild(a),t.each(UE.filterNode(UE.htmlparser(l.innerHTML.replace(/[\r\t]/g,"")),h.options.filterTxtRules).children,function(n){if(r.ie&&r.ie11below&&r.version>8)n.type=="element"?n.tagName=="br"?e+="\n":f.$empty[n.tagName]||(t.each(n.children,function(t){t.type=="element"?t.tagName=="br"?e+="\n":f.$empty[n.tagName]||(e+=t.innerText()):e+=t.data}),/\n$/.test(e)||(e+="\n")):e+=n.data+"\n",!n.nextSibling()&&/\n$/.test(e)&&(e=e.replace(/\n$/,""));else if(r.ie&&r.ie11below)n.type=="element"?n.tagName=="br"?e+="<br>":f.$empty[n.tagName]||(t.each(n.children,function(t){t.type=="element"?t.tagName=="br"?e+="<br>":f.$empty[n.tagName]||(e+=t.innerText()):e+=t.data}),/br>$/.test(e)||(e+="<br>")):e+=n.data+"<br>",!n.nextSibling()&&/<br>$/.test(e)&&(e=e.replace(/<br>$/,""));else{e+=n.type=="element"?f.$empty[n.tagName]?"":n.innerText():n.data;if(!/br\/?\s*>$/.test(e)){if(!n.nextSibling())return;e+="<br>"}}})),h.execCommand("inserthtml",'<pre id="coder"class="brush:'+u+';toolbar:false">'+e+"</pre>",!0),o=h.document.getElementById("coder"),n.removeAttributes(o,"id"),s=o.previousSibling,s&&(s.nodeType==3&&s.nodeValue.length==1&&r.ie&&r.version==6||n.isEmptyBlock(s))&&n.remove(s),c=h.selection.getRange(),n.isEmptyBlock(o)?c.setStart(o,0).setCursor(!1,!0):c.selectNodeContents(o).select())},queryCommandValue:function(){var i=this.selection.getStartElementPath(),n="";return t.each(i,function(t){if(t.nodeName=="PRE"){var i=t.className.match(/brush:([^;]+)/);return n=i&&i[1]?i[1]:"",!1}}),n}},i.addInputRule(function(n){t.each(n.getNodesByTagName("pre"),function(n){var u=n.getNodesByTagName("br"),i;if(u.length){r.ie&&r.ie11below&&r.version>8&&t.each(u,function(n){var t=UE.uNode.createText("\n");n.parentNode.insertBefore(t,n),n.parentNode.removeChild(n)});return}if(r.ie&&r.ie11below&&r.version>8)return;i=n.innerText().split(/\n/),n.innerHTML(""),t.each(i,function(t){t.length&&n.appendChild(UE.uNode.createText(t)),n.appendChild(UE.uNode.createElement("br"))})})}),i.addOutputRule(function(n){t.each(n.getNodesByTagName("pre"),function(n){var i="";t.each(n.children,function(n){i+=n.type=="text"?n.data.replace(/[ ]/g,"&nbsp;").replace(/\n$/,""):n.tagName=="br"?"\n":f.$empty[n.tagName]?n.innerText():""}),n.innerText(i.replace(/(&nbsp;|\n)+$/,""))})}),i.notNeedCodeQuery={help:1,undo:1,redo:1,source:1,print:1,searchreplace:1,fullscreen:1,preview:1,insertparagraph:1,elementpath:1,insertcode:1,inserthtml:1,selectall:1},u=i.queryCommandState,i.queryCommandState=function(n){var t=this;return!t.notNeedCodeQuery[n.toLowerCase()]&&t.selection&&t.queryCommandValue("insertcode")?-1:UE.Editor.prototype.queryCommandState.apply(this,arguments)},i.addListener("beforeenterkeydown",function(){var u=i.selection.getRange(),t=n.findParentByTagName(u.startContainer,"pre",!0),a,s,c,v,h,e,l,f,o;if(t){i.fireEvent("saveScene"),u.collapsed||u.deleteContents();if(!r.ie||r.ie9above){e=i.document.createElement("br"),u.insertNode(e).setStartAfter(e).collapse(!0),a=e.nextSibling,!a&&(!r.ie||r.version>10)?u.insertNode(e.cloneNode(!1)):u.setStartAfter(e),t=e.previousSibling;while(t){l=t,t=t.previousSibling;if(!t||t.nodeName=="BR"){t=l;break}}if(t){f="";while(t&&t.nodeName!="BR"&&new RegExp("^[\\s"+n.fillChar+"]*$").test(t.nodeValue))f+=t.nodeValue,t=t.nextSibling;t.nodeName!="BR"&&(o=t.nodeValue.match(new RegExp("^([\\s"+n.fillChar+"]+)")),o&&o[1]&&(f+=o[1])),f&&(f=i.document.createTextNode(f),u.insertNode(f).setStartAfter(f))}u.collapse(!0).select(!0)}else if(r.version>8)s=i.document.createTextNode("\n"),c=u.startContainer,u.startOffset==0?(v=c.previousSibling,v&&(u.insertNode(s),h=i.document.createTextNode(" "),u.setStartAfter(s).insertNode(h).setStart(h,0).collapse(!0).select(!0))):(u.insertNode(s).setStartAfter(s),h=i.document.createTextNode(" "),c=u.startContainer.childNodes[u.startOffset],c&&!/^\n/.test(c.nodeValue)&&u.setStartBefore(s),u.insertNode(h).setStart(h,0).collapse(!0).select(!0));else{e=i.document.createElement("br"),u.insertNode(e),u.insertNode(i.document.createTextNode(n.fillChar)),u.setStartAfter(e),t=e.previousSibling;while(t){l=t,t=t.previousSibling;if(!t||t.nodeName=="BR"){t=l;break}}if(t){f="";while(t&&t.nodeName!="BR"&&new RegExp("^[ "+n.fillChar+"]*$").test(t.nodeValue))f+=t.nodeValue,t=t.nextSibling;t.nodeName!="BR"&&(o=t.nodeValue.match(new RegExp("^([ "+n.fillChar+"]+)")),o&&o[1]&&(f+=o[1])),f=i.document.createTextNode(f),u.insertNode(f).setStartAfter(f)}u.collapse(!0).select()}return i.fireEvent("saveScene"),!0}}),i.addListener("tabkeydown",function(t,r){var o=i.selection.getRange(),f=n.findParentByTagName(o.startContainer,"pre",!0),e,u,h,s;if(f){i.fireEvent("saveScene");if(!r.shiftKey)if(o.collapsed)s=i.document.createTextNode("    "),o.insertNode(s).setStartAfter(s).collapse(!0).select(!0);else{e=o.createBookmark(),u=e.start.previousSibling;while(u){if(f.firstChild===u&&!n.isBr(u)){f.insertBefore(i.document.createTextNode("    "),u);break}if(n.isBr(u)){f.insertBefore(i.document.createTextNode("    "),u.nextSibling);break}u=u.previousSibling}h=e.end,u=e.start.nextSibling,f.firstChild===e.start&&f.insertBefore(i.document.createTextNode("    "),u.nextSibling);while(u&&u!==h){if(n.isBr(u)&&u.nextSibling){if(u.nextSibling===h)break;f.insertBefore(i.document.createTextNode("    "),u.nextSibling)}u=u.nextSibling}o.moveToBookmark(e).select()}return i.fireEvent("saveScene"),!0}}),i.addListener("beforeinserthtml",function(i,u){var s=this,h=s.selection.getRange(),l=n.findParentByTagName(h.startContainer,"pre",!0),e,c,o;if(l)return h.collapsed||h.deleteContents(),e="",r.ie&&r.version>8?(t.each(UE.filterNode(UE.htmlparser(u),s.options.filterTxtRules).children,function(n){n.type=="element"?n.tagName=="br"?e+="\n":f.$empty[n.tagName]||(t.each(n.children,function(t){t.type=="element"?t.tagName=="br"?e+="\n":f.$empty[n.tagName]||(e+=t.innerText()):e+=t.data}),/\n$/.test(e)||(e+="\n")):e+=n.data+"\n",!n.nextSibling()&&/\n$/.test(e)&&(e=e.replace(/\n$/,""))}),c=s.document.createTextNode(t.html(e.replace(/&nbsp;/g," "))),h.insertNode(c).selectNode(c).select()):(o=s.document.createDocumentFragment(),t.each(UE.filterNode(UE.htmlparser(u),s.options.filterTxtRules).children,function(n){n.type=="element"?n.tagName=="br"?o.appendChild(s.document.createElement("br")):f.$empty[n.tagName]||(t.each(n.children,function(i){i.type=="element"?i.tagName=="br"?o.appendChild(s.document.createElement("br")):f.$empty[n.tagName]||o.appendChild(s.document.createTextNode(t.html(i.innerText().replace(/&nbsp;/g," ")))):o.appendChild(s.document.createTextNode(t.html(i.data.replace(/&nbsp;/g," "))))}),o.lastChild.nodeName!="BR"&&o.appendChild(s.document.createElement("br"))):o.appendChild(s.document.createTextNode(t.html(n.data.replace(/&nbsp;/g," ")))),!n.nextSibling()&&o.lastChild.nodeName=="BR"&&o.removeChild(o.lastChild)}),h.insertNode(o).select()),!0}),i.addListener("keydown",function(t,i){var o=this,s=i.keyCode||i.which,r,f,e,u;if(s==40){r=o.selection.getRange(),e=r.startContainer;if(r.collapsed&&(f=n.findParentByTagName(r.startContainer,"pre",!0))&&!f.nextSibling){u=f.lastChild;while(u&&u.nodeName=="BR")u=u.previousSibling;(u===e||r.startContainer===f&&r.startOffset==f.childNodes.length)&&(o.execCommand("insertparagraph"),n.preventDefault(i))}}}),i.addListener("delkeydown",function(t,r){var f=this.selection.getRange(),u,e;return f.txtToElmBoundary(!0),u=f.startContainer,n.isTagNode(u,"pre")&&f.collapsed&&n.isStartInblock(f)?(e=i.document.createElement("p"),n.fillNode(i.document,e),u.parentNode.insertBefore(e,u),n.remove(u),f.setStart(e,0).setCursor(!1,!0),n.preventDefault(r),!0):void 0})},UE.commands.cleardoc={execCommand:function(){var t=this,r=t.options.enterTag,i=t.selection.getRange();r=="br"?(t.body.innerHTML="<br/>",i.setStart(t.body,0).setCursor()):(t.body.innerHTML="<p>"+(o?"":"<br/>")+"</p>",i.setStart(t.body.firstChild,0).setCursor(!1,!0)),setTimeout(function(){t.fireEvent("clearDoc")},0)}},UE.plugin.register("dzzfile",function(){var n=this;return{commands:{dzzfile:{execCommand:function(){try{top.OpenFile("open","\u6253\u5f00\u6587\u4ef6",{attach:["\u6587\u4ef6",["ATTACH","IMAGE","DOCUMENT","VIDEO","LINK","DZZDOC"],""],image:["\u56fe\u50cf(*.jpg,*.jpeg,*.png,*.gif)",["IMAGE","JPG","JPEG","PNG","GIF"],""]},{bz:"",multiple:!0},function(t){var f=[],e,i,u,r;f=t.params.multiple?t.icodata:[t.icodata];for(e in f){i=f[e];switch(i.type){case"image":u=(DZZSCRIPT?DZZSCRIPT:"index.php")+"?mod=io&op=thumbnail&original=1&path="+(i.apath?i.apath:i.dpath),n.execCommand("insertimage",{src:u,_src:u,alt:i.name,"class":"dzz-image",path:"attach::"+i.aid,apath:i.apath,aid:i.aid,ext:i.ext,dsize:i.fsize});break;case"attach":case"document":u=(DZZSCRIPT?DZZSCRIPT:"index.php")+"?mod=io&op=getStream&original=1&path="+(i.apath?i.apath:i.dpath),r="",r+='<span class="dzz-attach"><img class="dzz-attach-icon" src="'+i.img+'" _src="'+i.img+'" /><a class="dzz-attach-title" href="'+u+'" title="'+i.name+'"  dsize="'+i.fsize+'" ext="'+i.ext+'"  aid="'+i.aid+'"  path="attach::'+i.aid+'" apath="'+i.apath+'"  >'+i.name+"</a></span>",n.execCommand("insertHtml",r);break;case"link":r="",r+='<span class="dzz-link"><img class="dzz-link-icon" src="'+SITEURL+i.img+'" _src="'+SITEURL+i.img+'" /><a class="dzz-link-title" href="'+i.url+'" title="'+i.name+'" '+(i.ext?'ext="'+i.ext+'"':"")+" >"+i.name+"</a></span>",n.execCommand("insertHtml",r),n.fireEvent("catchRemoteImage");break;case"dzzdoc":r="",r+='<span class="dzz-dzzdoc"><img class="dzz-dzzdoc-icon" src="'+i.img+'" _src="'+i.img+'" /><a class="dzz-dzzdoc-title" href="'+i.url+'" title="'+i.name+'" aid="'+i.aid+'" path="attach::'+i.aid+'" apath="'+i.apath+'" >'+i.name+"</a></span>",n.execCommand("insertHtml",r);break;case"video":n.execCommand("insertvideo",{url:i.url,width:420,height:280})}}})}catch(t){alert("\u8bf7\u5728\u684c\u9762\u5185\u4f7f\u7528\uff01")}},queryCommandState:function(){return top._config?1:-1},notNeedUndo:!1}}}}),UE.plugin.register("anchor",function(){return{bindEvents:{ready:function(){t.cssRule("anchor",".anchorclass{background: url('"+this.options.themePath+this.options.theme+"/images/anchor.gif') no-repeat scroll left center transparent;cursor: auto;display: inline-block;height: 16px;width: 15px;}",this.document)}},outputRule:function(n){t.each(n.getNodesByTagName("img"),function(n){var t;(t=n.getAttr("anchorname"))&&(n.tagName="a",n.setAttr({anchorname:"",name:t,"class":""}))})},inputRule:function(n){t.each(n.getNodesByTagName("a"),function(n){var t;(t=n.getAttr("name"))&&!n.getAttr("href")&&(n.tagName="img",n.setAttr({anchorname:n.getAttr("name"),"class":"anchorclass"}),n.setAttr("name"))})},commands:{anchor:{execCommand:function(t,i){var f=this.selection.getRange(),r=f.getClosedNode(),u;r&&r.getAttribute("anchorname")?i?r.setAttribute("anchorname",i):(f.setStartBefore(r).setCursor(),n.remove(r)):i&&(u=this.document.createElement("img"),f.collapse(!0),n.setAttributes(u,{anchorname:i,"class":"anchorclass"}),f.insertNode(u).setStartAfter(u).setCursor(!1,!0))}}}}}),UE.plugins.wordcount=function(){var t=this,i;t.setOpt("wordCount",!0),t.addListener("contentchange",function(){t.fireEvent("wordcount")}),t.addListener("ready",function(){var t=this;n.on(t.body,"keyup",function(n){var u=n.keyCode||n.which,r={"16":1,"18":1,"20":1,"37":1,"38":1,"39":1,"40":1};if(u in r)return;clearTimeout(i),i=setTimeout(function(){t.fireEvent("wordcount")},200)})})},UE.plugins.pagebreak=function(){function r(t){if(n.isEmptyBlock(t)){var r=t.firstChild,u;while(r&&r.nodeType==1&&n.isEmptyBlock(r))u=r,r=r.firstChild;!u&&(u=t),n.fillNode(i.document,u)}}function u(n){return n&&n.nodeType==1&&n.tagName=="HR"&&n.className=="pagebreak"}var i=this,f=["td"];i.setOpt("pageBreakTag","_ueditor_page_break_tag_"),i.ready(function(){t.cssRule("pagebreak",".pagebreak{display:block;clear:both !important;cursor:default !important;width: 100% !important;margin:0;}",i.document)}),i.addInputRule(function(n){n.traversal(function(n){if(n.type=="text"&&n.data==i.options.pageBreakTag){var t=UE.uNode.createElement('<hr class="pagebreak" noshade="noshade" size="5" style="-webkit-user-select: none;">');n.parentNode.insertBefore(t,n),n.parentNode.removeChild(n)}})}),i.addOutputRule(function(n){t.each(n.getNodesByTagName("hr"),function(n){if(n.getAttr("class")=="pagebreak"){var t=UE.uNode.createText(i.options.pageBreakTag);n.parentNode.insertBefore(t,n),n.parentNode.removeChild(n)}})}),i.commands.pagebreak={execCommand:function(){var o=i.selection.getRange(),t=i.document.createElement("hr"),a,v,y,h,e,s,c,l;n.setAttributes(t,{"class":"pagebreak",noshade:"noshade",size:"5"}),n.unSelectable(t),a=n.findParentByTagName(o.startContainer,f,!0),v=[];if(a)switch(a.tagName){case"TD":e=a.parentNode,e.previousSibling?(e.parentNode.insertBefore(t,e),v=n.findParents(t)):(y=n.findParentByTagName(e,"table"),y.parentNode.insertBefore(t,y),v=n.findParents(t,!0)),e=v[1],t!==e&&n.breakParent(t,e),i.fireEvent("afteradjusttable",i.document)}else{if(!o.collapsed){o.deleteContents(),h=o.startContainer;while(!n.isBody(h)&&n.isBlockElm(h)&&n.isEmptyNode(h))o.setStartBefore(h).collapse(!0),n.remove(h),h=o.startContainer}o.insertNode(t),e=t.parentNode;while(!n.isBody(e))n.breakParent(t,e),s=t.nextSibling,s&&n.isEmptyBlock(s)&&n.remove(s),e=t.parentNode;s=t.nextSibling,c=t.previousSibling,u(c)?n.remove(c):c&&r(c),s?(u(s)?n.remove(s):r(s),o.setEndAfter(t).collapse(!1)):(l=i.document.createElement("p"),t.parentNode.appendChild(l),n.fillNode(i.document,l),o.setStart(l,0).collapse(!0)),o.select(!0)}}}},UE.plugin.register("wordimage",function(){var i=this,r=[];return{commands:{wordimage:{execCommand:function(){for(var e=n.getElementsByTagName(i.body,"img"),f=[],r,t,u=0;r=e[u++];)t=r.getAttribute("word_img"),t&&f.push(t);return f},queryCommandState:function(){r=n.getElementsByTagName(i.body,"img");for(var u=0,t;t=r[u++];)if(t.getAttribute("word_img"))return 1;return-1},notNeedUndo:!0}},inputRule:function(n){t.each(n.getNodesByTagName("img"),function(n){var t=n.attrs,f=parseInt(t.width)<128||parseInt(t.height)<43,r=i.options,u=r.UEDITOR_HOME_URL+"themes/default/images/spacer.gif";t.src&&/^(?:(file:\/+))/.test(t.src)&&n.setAttr({width:t.width,height:t.height,alt:t.alt,word_img:t.src,src:u,style:"background:url("+(f?r.themePath+r.theme+"/images/word.gif":r.langPath+r.lang+"/images/localimage.png")+") no-repeat center center;border:1px solid #ddd"})})}}}),UE.plugins.dragdrop=function(){var t=this;t.ready(function(){n.on(this.body,"dragend",function(){var f=t.selection.getRange(),u=f.getClosedNode()||t.selection.getStart(),r,i;if(u&&u.tagName=="IMG"){r=u.previousSibling;while(i=u.nextSibling)if(i.nodeType==1&&i.tagName=="SPAN"&&!i.firstChild)n.remove(i);else break;(r&&r.nodeType==1&&!n.isEmptyBlock(r)||!r)&&(!i||i&&!n.isEmptyBlock(i))&&(r&&r.tagName=="P"&&!n.isEmptyBlock(r)?(r.appendChild(u),n.moveChild(i,r),n.remove(i)):i&&i.tagName=="P"&&!n.isEmptyBlock(i)&&i.insertBefore(u,i.firstChild),r&&r.tagName=="P"&&n.isEmptyBlock(r)&&n.remove(r),i&&i.tagName=="P"&&n.isEmptyBlock(i)&&n.remove(i),f.selectNode(u).select(),t.fireEvent("saveScene"))}})}),t.addListener("keyup",function(i,r){var e=r.keyCode||r.which,f,u;e==13&&(f=t.selection.getRange(),(u=n.findParentByTagName(f.startContainer,"p",!0))&&n.getComputedStyle(u,"text-align")=="center"&&n.removeStyle(u,"text-align"))})},UE.plugins.undo=function(){function l(n,t){if(n.length!=t.length)return 0;for(var i=0,r=n.length;i<r;i++)if(n[i]!=t[i])return 0;return 1}function p(n,t){return n.collapsed!=t.collapsed?0:!l(n.startAddress,t.startAddress)||!l(n.endAddress,t.endAddress)?0:1}function k(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.undo=function(){if(this.hasUndo){if(!this.list[this.index-1]&&this.list.length==1){this.reset();return}while(this.list[this.index].content==this.list[this.index-1].content){this.index--;if(this.index==0)return this.restore(0)}this.restore(--this.index)}},this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content){this.index++;if(this.index==this.list.length-1)return this.restore(this.index)}this.restore(++this.index)}},this.restore=function(){var i=this.editor,o=this.list[this.index],f=UE.htmlparser(o.content.replace(w,"")),u;i.options.autoClearEmptyNode=!1,i.filterInputRule(f),i.options.autoClearEmptyNode=a,i.document.body.innerHTML=f.toHtml(),i.fireEvent("afterscencerestore"),r.ie&&t.each(n.getElementsByTagName(i.document,"td th caption p"),function(t){n.isEmptyNode(t)&&n.fillNode(i.document,t)});try{u=new e.Range(i.document).moveToAddress(o.address),u.select(b[u.startContainer.nodeName.toLowerCase()])}catch(s){}this.update(),this.clearKey(),i.fireEvent("reset",!0)},this.getScene=function(){var n=this.editor,u=n.selection.getRange(),r=u.createAddress(!1,!0),t,i;return n.fireEvent("beforegetscene"),t=UE.htmlparser(n.body.innerHTML),n.options.autoClearEmptyNode=!1,n.filterOutputRule(t),n.options.autoClearEmptyNode=a,i=t.toHtml(),n.fireEvent("aftergetscene"),{address:r,content:i}},this.save=function(n,t){clearTimeout(o);var u=this.getScene(t),r=this.list[this.index];r&&r.content!=u.content&&i.trigger("contentchange");if(r&&r.content==u.content&&(n?1:p(r.address,u.address)))return;this.list=this.list.slice(0,this.index+1),this.list.push(u),this.list.length>v&&this.list.shift(),this.index=this.list.length-1,this.clearKey(),this.update()},this.update=function(){this.hasRedo=!!this.list[this.index+1],this.hasUndo=!!this.list[this.index-1]},this.reset=function(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.clearKey()},this.clearKey=function(){s=0,c=null}}var o,i=this,v=i.options.maxUndoCount||20,y=i.options.maxInputCount||20,w=new RegExp(n.fillChar+"|</hr>","gi"),b={ol:1,ul:1,table:1,tbody:1,tr:1,body:1},a=i.options.autoClearEmptyNode,f;i.undoManger=new k,i.undoManger.editor=i,i.addListener("saveScene",function(){var n=Array.prototype.splice.call(arguments,1);this.undoManger.save.apply(this.undoManger,n)}),i.addListener("reset",function(n,t){t||this.undoManger.reset()}),i.commands.redo=i.commands.undo={execCommand:function(n){this.undoManger[n]()},queryCommandState:function(n){return this.undoManger["has"+(n.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1},notNeedUndo:1};var h={16:1,17:1,18:1,37:1,38:1,39:1,40:1},s=0,c,u=!1;i.addListener("ready",function(){n.on(this.body,"compositionstart",function(){u=!0});n.on(this.body,"compositionend",function(){u=!1})}),i.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89"}),f=!0,i.addListener("keydown",function(n,t){var i=this,e=t.keyCode||t.which;if(!h[e]&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey){if(u)return;if(!i.selection.getRange().collapsed){i.undoManger.save(!1,!0),f=!1;return}i.undoManger.list.length==0&&i.undoManger.save(!0),clearTimeout(o);function r(n){n.undoManger.save(!1,!0),n.fireEvent("selectionchange")}o=setTimeout(function(){if(u){var n=setInterval(function(){u||(r(i),clearInterval(n))},300);return}r(i)},200),c=e,s++,s>=y&&r(i)}}),i.addListener("keyup",function(n,t){var i=t.keyCode||t.which;if(!h[i]&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey){if(u)return;f||(this.undoManger.save(!1,!0),f=!0)}}),i.stopCmdUndo=function(){i.__hasEnterExecCommand=!0},i.startCmdUndo=function(){i.__hasEnterExecCommand=!1}},UE.plugin.register("copy",function(){function u(){ZeroClipboard.config({debug:!1,swfPath:i.options.UEDITOR_HOME_URL+"third-party/zeroclipboard/ZeroClipboard.swf"});var t=i.zeroclipboard=new ZeroClipboard;t.on("copy",function(n){var r=n.client,u=i.selection.getRange(),t=document.createElement("div");t.appendChild(u.cloneContents()),r.setText(t.innerText||t.textContent),r.setHtml(t.innerHTML),u.select()});t.on("mouseover mouseout",function(t){var i=t.target;t.type=="mouseover"?n.addClass(i,"edui-state-hover"):t.type=="mouseout"&&n.removeClasses(i,"edui-state-hover")});t.on("wrongflash noflash",function(){ZeroClipboard.destroy()})}var i=this;return{bindEvents:{ready:function(){r.ie||(window.ZeroClipboard?u():t.loadFile(document,{src:i.options.UEDITOR_HOME_URL+"third-party/zeroclipboard/ZeroClipboard.js",tag:"script",type:"text/javascript",defer:"defer"},function(){u()}))}},commands:{copy:{execCommand:function(){i.document.execCommand("copy")||alert(i.getLang("copymsg"))}}}}}),UE.plugins.paste=function(){function h(t){var u=this.document;if(u.getElementById("baidu_pastebin"))return;var f=this.selection.getRange(),e=f.createBookmark(),i=u.createElement("div");i.id="baidu_pastebin",r.webkit&&i.appendChild(u.createTextNode(n.fillChar+n.fillChar)),u.body.appendChild(i),e.start.style.display="",i.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+n.getXY(e.start).y+"px",f.selectNodeContents(i).select(!0),setTimeout(function(){if(r.webkit)for(var h=0,s=u.querySelectorAll("#baidu_pastebin"),o;o=s[h++];)if(n.isEmptyNode(o))n.remove(o);else{i=o;break}try{i.parentNode.removeChild(i)}catch(c){}f.moveToBookmark(e).select(!0),t(i)},0)}function s(n){return n.replace(/<(\/?)([\w\-]+)([^>]*)>/gi,function(n,i,r,u){return r=r.toLowerCase(),({img:1})[r]?n:(u=u.replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(n,t,i){return({src:1,href:1,name:1})[t.toLowerCase()]?t+"="+i+" ":""}),({span:1,div:1})[r]?"":"<"+i+r+" "+t.trim(u)+">")})}function o(o){var l,g,b,it,p,nt,v,k,tt,w,rt,d,h,a,c,y;if(o.firstChild){for(g=n.getElementsByTagName(o,"span"),h=0;b=g[h++];)(b.id=="_baidu_cut_start"||b.id=="_baidu_cut_end")&&n.remove(b);if(r.webkit){for(w=o.querySelectorAll("div br"),h=0;it=w[h++];)p=it.parentNode,p.tagName=="DIV"&&p.childNodes.length==1&&(p.innerHTML="<p><br/></p>",n.remove(p));for(nt=o.querySelectorAll("#baidu_pastebin"),h=0;v=nt[h++];){k=i.document.createElement("p"),v.parentNode.insertBefore(k,v);while(v.firstChild)k.appendChild(v.firstChild);n.remove(v)}for(tt=o.querySelectorAll("meta"),h=0;a=tt[h++];)n.remove(a);for(w=o.querySelectorAll("br"),h=0;a=w[h++];)/^apple-/i.test(a.className)&&n.remove(a)}if(r.gecko)for(rt=o.querySelectorAll("[_moz_dirty]"),h=0;a=rt[h++];)a.removeAttribute("_moz_dirty");if(!r.ie)for(d=o.querySelectorAll("span.Apple-style-span"),h=0;a=d[h++];)n.remove(a,!0);l=o.innerHTML,l=UE.filterWord(l),c=UE.htmlparser(l),i.options.filterRules&&UE.filterNode(c,i.options.filterRules),i.filterInputRule(c),r.webkit&&(y=c.lastChild(),y&&y.type=="element"&&y.tagName=="br"&&c.removeChild(y),t.each(i.body.querySelectorAll("div"),function(t){n.isEmptyBlock(t)&&n.remove(t,!0)})),l={html:c.toHtml()},i.fireEvent("beforepaste",l,c);if(!l.html)return;c=UE.htmlparser(l.html,!0),i.queryCommandState("pasteplain")===1?i.execCommand("insertHtml",UE.filterNode(c,i.options.filterTxtRules).toHtml(),!0):(UE.filterNode(c,i.options.filterTxtRules),e=c.toHtml(),u=l.html,f=i.selection.getRange().createAddress(!0),i.execCommand("insertHtml",i.getOpt("retainOnlyLabelPasted")===!0?s(u):u,!0)),i.fireEvent("afterpaste",l)}}var i=this,e,u,f;i.setOpt({retainOnlyLabelPasted:!1}),i.addListener("pasteTransfer",function(t,r){var o,l,v,c,y,a,h,p;if(f&&e&&u&&e!=u){o=i.selection.getRange(),o.moveToAddress(f,!0);if(!o.collapsed){while(!n.isBody(o.startContainer)){l=o.startContainer;if(l.nodeType==1){l=l.childNodes[o.startOffset];if(!l){o.setStartBefore(o.startContainer);continue}v=l.previousSibling,v&&v.nodeType==3&&new RegExp("^[\x0a\x0d\x09 "+n.fillChar+"]*$").test(v.nodeValue)&&o.setStartBefore(v)}if(o.startOffset==0)o.setStartBefore(o.startContainer);else break}while(!n.isBody(o.endContainer)){c=o.endContainer;if(c.nodeType==1){c=c.childNodes[o.endOffset];if(!c){o.setEndAfter(o.endContainer);continue}y=c.nextSibling,y&&y.nodeType==3&&new RegExp("^[\x0a\x0d\x09"+n.fillChar+"]*$").test(y.nodeValue)&&o.setEndAfter(y)}if(o.endOffset==o.endContainer[o.endContainer.nodeType==3?"nodeValue":"childNodes"].length)o.setEndAfter(o.endContainer);else break}}o.deleteContents(),o.select(!0),i.__hasEnterExecCommand=!0,a=u,r===2?a=s(a):r&&(a=e),i.execCommand("inserthtml",a,!0),i.__hasEnterExecCommand=!1,h=i.selection.getRange();while(!n.isBody(h.startContainer)&&!h.startOffset&&h.startContainer[h.startContainer.nodeType==3?"nodeValue":"childNodes"].length)h.setStartBefore(h.startContainer);p=h.createAddress(!0),f.endAddress=p.startAddress}}),i.addListener("ready",function(){n.on(i.body,"cut",function(){var n=i.selection.getRange();!n.collapsed&&i.undoManger&&i.undoManger.save()});n.on(i.body,r.ie||r.opera?"keydown":"paste",function(n){if((r.ie||r.opera)&&(!n.ctrlKey&&!n.metaKey||n.keyCode!="86"))return;h.call(i,function(n){o(n)})})}),i.commands.paste={execCommand:function(){r.ie?(h.call(i,function(n){o(n)}),i.document.execCommand("paste")):alert(i.getLang("pastemsg"))}}},UE.plugins.pasteplain=function(){var t=this,n;t.setOpt({pasteplain:!1,filterTxtRules:function(){function n(n){n.tagName="p",n.setStyle()}function t(n){n.parentNode.removeChild(n,!0)}return{"-":"script style object iframe embed input select",p:{$:{}},br:{$:{}},div:function(n){var i,t=UE.uNode.createElement("p");while(i=n.firstChild())i.type=="text"||!UE.dom.dtd.$block[i.tagName]?t.appendChild(i):t.firstChild()?(n.parentNode.insertBefore(t,n),t=UE.uNode.createElement("p")):n.parentNode.insertBefore(i,n);t.firstChild()&&n.parentNode.insertBefore(t,n),n.parentNode.removeChild(n)},ol:t,ul:t,dl:t,dt:t,dd:t,li:t,caption:n,th:n,tr:n,h1:n,h2:n,h3:n,h4:n,h5:n,h6:n,td:function(n){var t=!!n.innerText();t&&n.parentNode.insertAfter(UE.uNode.createText(" &nbsp; &nbsp;"),n),n.parentNode.removeChild(n,n.innerText())}}}()}),n=t.options.pasteplain,t.commands.pasteplain={queryCommandState:function(){return n?1:0},execCommand:function(){n=!n|0},notNeedUndo:1}},UE.plugins.list=function(){function w(n){var i=[],t;for(t in n)i.push(t);return i}function e(t){var i=t.className;return n.hasClass(t,/custom_/)?i.match(/custom_(\w+)/)[1]:n.getStyle(t,"list-style-type")}function p(i,r){t.each(n.getElementsByTagName(i,"ol ul"),function(f){var l,y,w,a,c,v,p;if(!n.inDoc(f,i))return;l=f.parentNode,l.tagName==f.tagName&&(y=e(f)||(f.tagName=="OL"?"decimal":"disc"),w=e(l)||(l.tagName=="OL"?"decimal":"disc"),y==w&&(a=t.indexOf(u[f.tagName],y),a=a+1==u[f.tagName].length?0:a+1,h(f,u[f.tagName][a]))),c=0,v=2,n.hasClass(f,/custom_/)?/[ou]l/i.test(l.tagName)&&n.hasClass(l,/custom_/)||(v=1):/[ou]l/i.test(l.tagName)&&n.hasClass(l,/custom_/)&&(v=3),p=n.getStyle(f,"list-style-type"),p&&(f.style.cssText="list-style-type:"+p),f.className=t.trim(f.className.replace(/list-paddingleft-\w+/,""))+" list-paddingleft-"+v,t.each(n.getElementsByTagName(f,"li"),function(t){var r,i,u;t.style.cssText&&(t.style.cssText="");if(!t.firstChild){n.remove(t);return}if(t.parentNode!==f)return;c++;if(n.hasClass(f,/custom_/)){r=1,i=e(f);if(f.tagName=="OL"){if(i)switch(i){case"cn":case"cn1":case"cn2":c>10&&(c%10==0||c>10&&c<20)?r=2:c>20&&(r=3);break;case"num2":c>9&&(r=2)}t.className="list-"+o[i]+c+" list-"+i+"-paddingleft-"+r}else t.className="list-"+o[i]+" list-"+i+"-paddingleft"}else t.className=t.className.replace(/list-[\w\-]+/gi,"");u=t.getAttribute("class"),u!==null&&!u.replace(/\s/g,"")&&n.removeAttributes(t,"class")}),!r&&s(f,f.tagName.toLowerCase(),e(f)||n.getStyle(f,"list-style-type"),!0)})}function s(t,i,r,u){var f=t.nextSibling,o;f&&f.nodeType==1&&f.tagName.toLowerCase()==i&&(e(f)||n.getStyle(f,"list-style-type")||(i=="ol"?"decimal":"disc"))==r&&(n.moveChild(f,t),f.childNodes.length==0&&n.remove(f)),f&&n.isFillChar(f)&&n.remove(f),o=t.previousSibling,o&&o.nodeType==1&&o.tagName.toLowerCase()==i&&(e(o)||n.getStyle(o,"list-style-type")||(i=="ol"?"decimal":"disc"))==r&&n.moveChild(t,o),o&&n.isFillChar(o)&&n.remove(o),!u&&n.isEmptyBlock(t)&&n.remove(t),e(t)&&p(t.ownerDocument,!0)}function h(t,i){o[i]&&(t.className="custom_"+i);try{n.setStyle(t,"list-style-type",i)}catch(r){}}function l(t){var i=t.previousSibling;i&&n.isEmptyBlock(i)&&n.remove(i),i=t.nextSibling,i&&n.isEmptyBlock(i)&&n.remove(i)}function v(t){while(t&&!n.isBody(t)){if(t.nodeName=="TABLE")return null;if(t.nodeName=="LI")return t;t=t.parentNode}}var i=this,y={TD:1,PRE:1,BLOCKQUOTE:1},o={cn:"cn-1-",cn1:"cn-2-",cn2:"cn-3-",num:"num-1-",num1:"num-2-",num2:"num-3-",dash:"dash",dot:"dot"},u,a,c;i.setOpt({autoTransWordToList:!1,insertorderedlist:{num:"",num1:"",num2:"",cn:"",cn1:"",cn2:"",decimal:"","lower-alpha":"","lower-roman":"","upper-alpha":"","upper-roman":""},insertunorderedlist:{circle:"",disc:"",square:"",dash:"",dot:""},listDefaultPaddingLeft:"30",listiconpath:"http://bs.baidu.com/listicon/",maxListLevel:-1,disablePInList:!1}),u={OL:w(i.options.insertorderedlist),UL:w(i.options.insertunorderedlist)},a=i.options.listiconpath;for(c in o)!i.options.insertorderedlist.hasOwnProperty(c)&&!i.options.insertunorderedlist.hasOwnProperty(c)&&delete o[c];i.ready(function(){var u=[],n,f;for(n in o){if(n=="dash"||n=="dot")u.push("li.list-"+o[n]+"{background-image:url("+a+o[n]+".gif)}"),u.push("ul.custom_"+n+"{list-style:none;}ul.custom_"+n+" li{background-position:0 3px;background-repeat:no-repeat}");else{for(f=0;f<99;f++)u.push("li.list-"+o[n]+f+"{background-image:url("+a+"list-"+o[n]+f+".gif)}");u.push("ol.custom_"+n+"{list-style:none;}ol.custom_"+n+" li{background-position:0 3px;background-repeat:no-repeat}")}switch(n){case"cn":u.push("li.list-"+n+"-paddingleft-1{padding-left:25px}"),u.push("li.list-"+n+"-paddingleft-2{padding-left:40px}"),u.push("li.list-"+n+"-paddingleft-3{padding-left:55px}");break;case"cn1":u.push("li.list-"+n+"-paddingleft-1{padding-left:30px}"),u.push("li.list-"+n+"-paddingleft-2{padding-left:40px}"),u.push("li.list-"+n+"-paddingleft-3{padding-left:55px}");break;case"cn2":u.push("li.list-"+n+"-paddingleft-1{padding-left:40px}"),u.push("li.list-"+n+"-paddingleft-2{padding-left:55px}"),u.push("li.list-"+n+"-paddingleft-3{padding-left:68px}");break;case"num":case"num1":u.push("li.list-"+n+"-paddingleft-1{padding-left:25px}");break;case"num2":u.push("li.list-"+n+"-paddingleft-1{padding-left:35px}"),u.push("li.list-"+n+"-paddingleft-2{padding-left:40px}");break;case"dash":u.push("li.list-"+n+"-paddingleft{padding-left:35px}");break;case"dot":u.push("li.list-"+n+"-paddingleft{padding-left:20px}")}}u.push(".list-paddingleft-1{padding-left:0}"),u.push(".list-paddingleft-2{padding-left:"+i.options.listDefaultPaddingLeft+"px}"),u.push(".list-paddingleft-3{padding-left:"+i.options.listDefaultPaddingLeft*2+"px}"),t.cssRule("list","ol,ul{margin:0;pading:0;"+(r.ie?"":"width:95%")+"}li{clear:both;}"+u.join("\n"),i.document)}),i.ready(function(){n.on(i.body,"cut",function(){setTimeout(function(){var r=i.selection.getRange(),e,t,f,u;r.collapsed||(e=n.findParentByTagName(r.startContainer,"li",!0))&&!e.nextSibling&&n.isEmptyBlock(e)&&(t=e.parentNode,(f=t.previousSibling)?(n.remove(t),r.setStartAtLast(f).collapse(!0),r.select(!0)):(f=t.nextSibling)?(n.remove(t),r.setStartAtFirst(f).collapse(!0),r.select(!0)):(u=i.document.createElement("p"),n.fillNode(i.document,u),t.parentNode.insertBefore(u,t),n.remove(t),r.setStart(u,0).collapse(!0),r.select(!0)))})})}),i.addListener("beforepaste",function(i,r){var a=this,l=a.selection.getRange(),h,s=UE.htmlparser(r.html,!0),f,c;(h=n.findParentByTagName(l.startContainer,"li",!0))&&(f=h.parentNode,c=f.tagName=="OL"?"ul":"ol",t.each(s.getNodesByTagName(c),function(n){var c,r,h;n.tagName=f.tagName,n.setAttr(),n.parentNode===s?i=e(f)||(f.tagName=="OL"?"decimal":"disc"):(c=n.parentNode.getAttr("class"),i=c&&/custom_/.test(c)?c.match(/custom_(\w+)/)[1]:n.parentNode.getStyle("list-style-type"),i||(i=f.tagName=="OL"?"decimal":"disc")),r=t.indexOf(u[f.tagName],i),n.parentNode!==s&&(r=r+1==u[f.tagName].length?0:r+1),h=u[f.tagName][r],o[h]?n.setAttr("class","custom_"+h):n.setStyle("list-style-type",h)})),r.html=s.toHtml()}),i.getOpt("disablePInList")===!0&&i.addOutputRule(function(n){t.each(n.getNodesByTagName("li"),function(n){var i=[],r=0;t.each(n.children,function(t){var u,f;if(t.tagName=="p"){while(u=t.children.pop())i.splice(r,0,u),u.parentNode=n,lastNode=u;u=i[i.length-1],(!u||u.type!="element"||u.tagName!="br")&&(f=UE.uNode.createElement("br"),f.parentNode=n,i.push(f)),r=i.length}}),i.length&&(n.children=i)})}),i.addInputRule(function(n){t.each(n.getNodesByTagName("li"),function(n){for(var t=UE.uNode.createElement("p"),u,o,i,e=0;u=n.children[e];)u.type=="text"||f.p[u.tagName]?t.appendChild(u):t.firstChild()?(n.insertBefore(t,u),t=UE.uNode.createElement("p"),e=e+2):e++;(t.firstChild()&&!t.parentNode||!n.firstChild())&&n.appendChild(t),t.firstChild()||t.innerHTML(r.ie?"&nbsp;":"<br/>"),o=n.firstChild(),i=o.lastChild(),i&&i.type=="text"&&/^\s*$/.test(i.data)&&o.removeChild(i)});if(i.options.autoTransWordToList){var u={num1:/^\d+\)/,decimal:/^\d+\./,"lower-alpha":/^[a-z]+\)/,"upper-alpha":/^[A-Z]+\./,cn:/^[\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+[\u3001]/,cn2:/^\([\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+\)/},s={square:"n"};function e(n,t){var r=t.firstChild(),i;if(r&&r.type=="element"&&r.tagName=="span"&&/Wingdings|Symbol/.test(r.getStyle("font-family"))){for(i in s)if(s[i]==r.data)return i;return"disc"}for(i in u)if(u[i].test(n))return i}t.each(n.getNodesByTagName("p"),function(n){function l(n,t,i){var f,e;n.tagName=="ol"?r.ie?(f=t.firstChild(),f.type=="element"&&f.tagName=="span"&&u[i].test(f.innerText())&&t.removeChild(f)):t.innerHTML(t.innerHTML().replace(u[i],"")):t.removeChild(t.firstChild()),e=UE.uNode.createElement("li"),e.appendChild(t),n.appendChild(e)}var h,s,c,f,t;if(n.getAttr("class")!="MsoListParagraph")return;n.setStyle("margin",""),n.setStyle("margin-left",""),n.setAttr("class",""),h=n,c=n;if(n.parentNode.tagName!="li"&&(s=e(n.innerText(),n))){f=UE.uNode.createElement(i.options.insertorderedlist.hasOwnProperty(s)?"ol":"ul"),o[s]?f.setAttr("class","custom_"+s):f.setStyle("list-style-type",s);while(n&&n.parentNode.tagName!="li"&&e(n.innerText(),n))h=n.nextSibling(),h||n.parentNode.insertBefore(f,n),l(f,n,s),n=h;!f.parentNode&&n&&n.parentNode&&n.parentNode.insertBefore(f,n)}t=c.firstChild(),t&&t.type=="element"&&t.tagName=="span"&&/^\s*(&nbsp;)+\s*$/.test(t.innerText())&&t.parentNode.removeChild(t)})}}),i.addListener("contentchange",function(){p(i.document)}),i.addListener("keydown",function(t,r){function g(){r.preventDefault?r.preventDefault():r.returnValue=!1,i.fireEvent("contentchange"),i.undoManger&&i.undoManger.save()}function it(t,i){while(t&&!n.isBody(t)){if(i(t))return null;if(t.nodeType==1&&/[ou]l/i.test(t.tagName))return t;t=t.parentNode}return null}var tt=r.keyCode||r.which,nt,y,u,c,v,k,s,h,o,p;if(tt==13&&!r.shiftKey){var d=i.selection.getRange(),w=n.findParent(d.startContainer,function(t){return n.isBlockElm(t)},!0),u=n.findParentByTagName(d.startContainer,"li",!0);w&&w.tagName!="PRE"&&!u&&(nt=w.innerHTML.replace(new RegExp(n.fillChar,"g"),""),/^\s*1\s*\.[^\d]/.test(nt)&&(w.innerHTML=nt.replace(/^\s*1\s*\./,""),d.setStartAtLast(w).collapse(!0).select(),i.__hasEnterExecCommand=!0,i.execCommand("insertorderedlist"),i.__hasEnterExecCommand=!1));var e=i.selection.getRange(),a=it(e.startContainer,function(n){return n.tagName=="TABLE"}),b=e.collapsed?a:it(e.endContainer,function(n){return n.tagName=="TABLE"});if(a&&b&&a===b){if(!e.collapsed){a=n.findParentByTagName(e.startContainer,"li",!0),b=n.findParentByTagName(e.endContainer,"li",!0);if(a&&b&&a===b){e.deleteContents(),u=n.findParentByTagName(e.startContainer,"li",!0);if(u&&n.isEmptyBlock(u)){s=u.previousSibling,next=u.nextSibling,h=i.document.createElement("p"),n.fillNode(i.document,h),o=u.parentNode,s&&next?(e.setStart(next,0).collapse(!0).select(!0),n.remove(u)):(!s&&!next||!s?o.parentNode.insertBefore(h,o):u.parentNode.parentNode.insertBefore(h,o.nextSibling),n.remove(u),o.firstChild||n.remove(o),e.setStart(h,0).setCursor()),g();return}}else{y=e.cloneRange(),p=y.collapse(!1).createBookmark(),e.deleteContents(),y.moveToBookmark(p),u=n.findParentByTagName(y.startContainer,"li",!0),l(u),y.select(),g();return}}u=n.findParentByTagName(e.startContainer,"li",!0);if(u){if(n.isEmptyBlock(u)){p=e.createBookmark(),o=u.parentNode,u!==o.lastChild?(n.breakParent(u,o),l(u)):(o.parentNode.insertBefore(u,o.nextSibling),n.isEmptyNode(o)&&n.remove(o));if(!f.$list[u.parentNode.tagName])if(n.isBlockElm(u.firstChild))n.remove(u,!0);else{h=i.document.createElement("p"),u.parentNode.insertBefore(h,u);while(u.firstChild)h.appendChild(u.firstChild);n.remove(u)}e.moveToBookmark(p).select()}else{c=u.firstChild;if(!c||!n.isBlockElm(c)){h=i.document.createElement("p"),!u.firstChild&&n.fillNode(i.document,h);while(u.firstChild)h.appendChild(u.firstChild);u.appendChild(h),c=h}v=i.document.createElement("span"),e.insertNode(v),n.breakParent(v,u),k=v.nextSibling,c=k.firstChild,c||(h=i.document.createElement("p"),n.fillNode(i.document,h),k.appendChild(h),c=h),n.isEmptyNode(c)&&(c.innerHTML="",n.fillNode(i.document,c)),e.setStart(c,0).collapse(!0).shrinkBoundary().select(),n.remove(v),s=k.previousSibling,s&&n.isEmptyBlock(s)&&(s.innerHTML="<p></p>",n.fillNode(i.document,s.firstChild))}g()}}}if(tt==8){e=i.selection.getRange();if(e.collapsed&&n.isStartInblock(e)){y=e.cloneRange().trimBoundary(),u=n.findParentByTagName(e.startContainer,"li",!0);if(u&&n.isStartInblock(y)){a=n.findParentByTagName(e.startContainer,"p",!0);if(a&&a!==u.firstChild){o=n.findParentByTagName(a,["ol","ul"]),n.breakParent(a,o),l(a),i.fireEvent("contentchange"),e.setStart(a,0).setCursor(!1,!0),i.fireEvent("saveScene"),n.preventDefault(r);return}if(u&&(s=u.previousSibling)){if(tt==46&&u.childNodes.length)return;f.$list[s.tagName]&&(s=s.lastChild),i.undoManger&&i.undoManger.save(),c=u.firstChild;if(n.isBlockElm(c))if(n.isEmptyNode(c)){s.appendChild(c),e.setStart(c,0).setCursor(!1,!0);while(u.firstChild)s.appendChild(u.firstChild)}else v=i.document.createElement("span"),e.insertNode(v),n.isEmptyBlock(s)&&(s.innerHTML=""),n.moveChild(u,s),e.setStartBefore(v).collapse(!0).select(!0),n.remove(v);else if(n.isEmptyNode(u))h=i.document.createElement("p"),s.appendChild(h),e.setStart(h,0).setCursor();else{e.setEnd(s,s.childNodes.length).collapse().select(!0);while(u.firstChild)s.appendChild(u.firstChild)}n.remove(u),i.fireEvent("contentchange"),i.fireEvent("saveScene"),n.preventDefault(r);return}if(u&&!u.previousSibling){o=u.parentNode,p=e.createBookmark();if(n.isTagNode(o.parentNode,"ol ul"))o.parentNode.insertBefore(u,o),n.isEmptyNode(o)&&n.remove(o);else{while(u.firstChild)o.parentNode.insertBefore(u.firstChild,o);n.remove(u),n.isEmptyNode(o)&&n.remove(o)}e.moveToBookmark(p).setCursor(!1,!0),i.fireEvent("contentchange"),i.fireEvent("saveScene"),n.preventDefault(r);return}}}}}),i.addListener("keyup",function(t,r){var o=r.keyCode||r.which,f,u;o==8&&(f=i.selection.getRange(),(u=n.findParentByTagName(f.startContainer,["ol","ul"],!0))&&s(u,u.tagName.toLowerCase(),e(u)||n.getComputedStyle(u,"list-style-type"),!0))}),i.addListener("tabkeydown",function(){function b(n){if(i.options.maxListLevel!=-1){var t=n.parentNode,r=0;while(/[ou]l/i.test(t.tagName))r++,t=t.parentNode;if(r>=i.options.maxListLevel)return!0}}var l=i.selection.getRange(),r=n.findParentByTagName(l.startContainer,"li",!0),a,y,k,p,d,w,o;if(r)if(l.collapsed){if(b(r))return!0;var c=r.parentNode,f=i.document.createElement(c.tagName),v=t.indexOf(u[f.tagName],e(c)||n.getComputedStyle(c,"list-style-type"));v=v+1==u[f.tagName].length?0:v+1,y=u[f.tagName][v],h(f,y);if(n.isStartInblock(l))return i.fireEvent("saveScene"),a=l.createBookmark(),c.insertBefore(f,r),f.appendChild(r),s(f,f.tagName.toLowerCase(),y),i.fireEvent("contentchange"),l.moveToBookmark(a).select(!0),!0}else{for(i.fireEvent("saveScene"),a=l.createBookmark(),k=0,d=n.findParents(r);w=d[k++];)if(n.isTagNode(w,"ol ul")){p=w;break}o=r;if(a.end)while(o&&!(n.getPosition(o,a.end)&n.POSITION_FOLLOWING)){if(b(o)){o=n.getNextDomNode(o,!1,null,function(n){return n!==p});continue}var c=o.parentNode,f=i.document.createElement(c.tagName),v=t.indexOf(u[f.tagName],e(c)||n.getComputedStyle(c,"list-style-type")),g=v+1==u[f.tagName].length?0:v+1,y=u[f.tagName][g];h(f,y),c.insertBefore(f,o);while(o&&!(n.getPosition(o,a.end)&n.POSITION_FOLLOWING)){r=o.nextSibling,f.appendChild(o);if(!r||n.isTagNode(r,"ol ul")){if(r){while(r=r.firstChild)if(r.tagName=="LI")break}else r=n.getNextDomNode(o,!1,null,function(n){return n!==p});break}o=r}s(f,f.tagName.toLowerCase(),y),o=r}return i.fireEvent("contentchange"),l.moveToBookmark(a).select(),!0}}),i.commands.insertorderedlist=i.commands.insertunorderedlist={execCommand:function(t,i){var ft,wt,ht,tt,rt,et,at,it,k,lt,d,yt;i||(i=t.toLowerCase()=="insertorderedlist"?"decimal":"disc");var c=this,a=this.selection.getRange(),ut=function(t){return t.nodeType==1?t.tagName.toLowerCase()!="br":!n.isWhitespace(t)},st=t.toLowerCase()=="insertorderedlist"?"ol":"ul",l=c.document.createDocumentFragment();a.adjustmentBoundary().shrinkBoundary();var nt=a.createBookmark(!0),r=v(c.document.getElementById(nt.start)),vt=0,p=v(c.document.getElementById(nt.end)),bt=0,w,g,b,o;if(r||p){r&&(w=r.parentNode),nt.end||(p=r),p&&(g=p.parentNode);if(w===g){while(r!==p){o=r,r=r.nextSibling;if(!n.isBlockElm(o.firstChild)){ft=c.document.createElement("p");while(o.firstChild)ft.appendChild(o.firstChild);o.appendChild(ft)}l.appendChild(o)}o=c.document.createElement("span"),w.insertBefore(o,p);if(!n.isBlockElm(p.firstChild)){ft=c.document.createElement("p");while(p.firstChild)ft.appendChild(p.firstChild);p.appendChild(ft)}l.appendChild(p),n.breakParent(o,w),n.isEmptyNode(o.previousSibling)&&n.remove(o.previousSibling),n.isEmptyNode(o.nextSibling)&&n.remove(o.nextSibling),wt=e(w)||n.getComputedStyle(w,"list-style-type")||(t.toLowerCase()=="insertorderedlist"?"decimal":"disc");if(w.tagName.toLowerCase()==st&&wt==i){for(lt=0,ht=c.document.createDocumentFragment();d=l.firstChild;)if(n.isTagNode(d,"ol ul"))ht.appendChild(d);else while(d.firstChild)ht.appendChild(d.firstChild),n.remove(d);o.parentNode.insertBefore(ht,o)}else b=c.document.createElement(st),h(b,i),b.appendChild(l),o.parentNode.insertBefore(b,o);n.remove(o),b&&s(b,st,i),a.moveToBookmark(nt).select();return}if(r){while(r){o=r.nextSibling;if(n.isTagNode(r,"ol ul"))l.appendChild(r);else{tt=c.document.createDocumentFragment(),rt=0;while(r.firstChild)n.isBlockElm(r.firstChild)&&(rt=1),tt.appendChild(r.firstChild);rt?l.appendChild(tt):(et=c.document.createElement("p"),et.appendChild(tt),l.appendChild(et)),n.remove(r)}r=o}w.parentNode.insertBefore(l,w.nextSibling),n.isEmptyNode(w)?(a.setStartBefore(w),n.remove(w)):a.setStartAfter(w),vt=1}if(p&&n.inDoc(g,c.document)){r=g.firstChild;while(r&&r!==p){o=r.nextSibling;if(n.isTagNode(r,"ol ul"))l.appendChild(r);else{tt=c.document.createDocumentFragment(),rt=0;while(r.firstChild)n.isBlockElm(r.firstChild)&&(rt=1),tt.appendChild(r.firstChild);rt?l.appendChild(tt):(et=c.document.createElement("p"),et.appendChild(tt),l.appendChild(et)),n.remove(r)}r=o}at=n.createElement(c.document,"div",{tmpDiv:1}),n.moveChild(p,at),l.appendChild(at),n.remove(p),g.parentNode.insertBefore(l,g),a.setEndBefore(g),n.isEmptyNode(g)&&n.remove(g),bt=1}}vt||a.setStartBefore(c.document.getElementById(nt.start)),nt.end&&!bt&&a.setEndAfter(c.document.getElementById(nt.end)),a.enlarge(!0,function(n){return y[n.tagName]}),l=c.document.createDocumentFragment();var ot=a.createBookmark(),u=n.getNextDomNode(ot.start,!1,ut),ct=a.cloneRange(),k,pt=n.isBlockElm;while(u&&u!==ot.end&&n.getPosition(u,ot.end)&n.POSITION_PRECEDING)if(u.nodeType==3||f.li[u.tagName]){if(u.nodeType==1&&f.$list[u.tagName]){while(u.firstChild)l.appendChild(u.firstChild);k=n.getNextDomNode(u,!1,ut),n.remove(u),u=k;continue}k=u,ct.setStartBefore(u);while(u&&u!==ot.end&&(!pt(u)||n.isBookmarkNode(u)))k=u,u=n.getNextDomNode(u,!1,null,function(n){return!y[n.tagName]});u&&pt(u)&&(o=n.getNextDomNode(k,!1,ut),o&&n.isBookmarkNode(o)&&(u=n.getNextDomNode(o,!1,ut),k=o)),ct.setEndAfter(k),u=n.getNextDomNode(k,!1,ut),it=a.document.createElement("li"),it.appendChild(ct.extractContents());if(n.isEmptyNode(it)){k=a.document.createElement("p");while(it.firstChild)k.appendChild(it.firstChild);it.appendChild(k)}l.appendChild(it)}else u=n.getNextDomNode(u,!0,ut);for(a.moveToBookmark(ot).collapse(!0),b=c.document.createElement(st),h(b,i),b.appendChild(l),a.insertNode(b),s(b,st,i),lt=0,yt=n.getElementsByTagName(b,"div");d=yt[lt++];)d.getAttribute("tmpDiv")&&n.remove(d,!0);a.moveToBookmark(nt).select()},queryCommandState:function(n){for(var u=n.toLowerCase()=="insertorderedlist"?"ol":"ul",r=this.selection.getStartElementPath(),t,i=0;t=r[i++];){if(t.nodeName=="TABLE")return 0;if(u==t.nodeName.toLowerCase())return 1}return 0},queryCommandValue:function(t){for(var o=t.toLowerCase()=="insertorderedlist"?"ol":"ul",f=this.selection.getStartElementPath(),i,r,u=0;r=f[u++];){if(r.nodeName=="TABLE"){i=null;break}if(o==r.nodeName.toLowerCase()){i=r;break}}return i?e(i)||n.getComputedStyle(i,"list-style-type"):null}}},(function(){var i={textarea:function(n,t){var i=t.ownerDocument.createElement("textarea");return i.style.cssText="position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;",r.ie&&r.version<8&&(i.style.width=t.offsetWidth+"px",i.style.height=t.offsetHeight+"px",t.onresize=function(){i.style.width=t.offsetWidth+"px",i.style.height=t.offsetHeight+"px"}),t.appendChild(i),{setContent:function(n){i.value=n},getContent:function(){return i.value},select:function(){var n;r.ie?(n=i.createTextRange(),n.collapse(!0),n.select()):(i.setSelectionRange(0,0),i.focus())},dispose:function(){t.removeChild(i),t.onresize=null,i=null,t=null}}},codemirror:function(n,t){var i=window.CodeMirror(t,{mode:"text/html",tabMode:"indent",lineNumbers:!0,lineWrapping:!0}),r=i.getWrapperElement();return r.style.cssText='position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;',i.getScrollerElement().style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;",i.refresh(),{getCodeMirror:function(){return i},setContent:function(n){i.setValue(n)},getContent:function(){return i.getValue()},select:function(){i.focus()},dispose:function(){t.removeChild(r),r=null,i=null}}}};UE.plugins.source=function(){function y(n){return i[o.sourceEditor=="codemirror"&&window.CodeMirror?"codemirror":"textarea"](u,n)}var u=this,o=this.options,s=!1,e,a,v,c,h,l;o.sourceEditor=r.ie?"textarea":o.sourceEditor||"codemirror",u.setOpt({sourceEditorFirst:!1}),u.commands.source={execCommand:function(){var o,p,i,l,t;s=!s;if(s)h=u.selection.getRange().createAddress(!1,!0),u.undoManger&&u.undoManger.save(!0),r.gecko&&(u.body.contentEditable=!1),v=u.iframe.style.cssText,u.iframe.style.cssText+="position:absolute;left:-32768px;top:-32768px;",u.fireEvent("beforegetcontent"),o=UE.htmlparser(u.body.innerHTML),u.filterOutputRule(o),o.traversal(function(n){if(n.type=="element")switch(n.tagName){case"td":case"th":case"caption":n.children&&n.children.length==1&&n.firstChild().tagName=="br"&&n.removeChild(n.firstChild());break;case"pre":n.innerText(n.innerText().replace(/&nbsp;/g," "))}}),u.fireEvent("aftergetcontent"),p=o.toHtml(!0),e=y(u.iframe.parentNode),e.setContent(p),a=u.setContent,u.setContent=function(n){var t=UE.htmlparser(n);u.filterInputRule(t),n=t.toHtml(),e.setContent(n)},setTimeout(function(){e.select(),u.addListener("fullscreenchanged",function(){try{e.getCodeMirror().refresh()}catch(n){}})}),c=u.getContent,u.getContent=function(){return e.getContent()||"<p>"+(r.ie?"":"<br/>")+"</p>"};else{u.iframe.style.cssText=v,i=e.getContent()||"<p>"+(r.ie?"":"<br/>")+"</p>",i=i.replace(new RegExp("[\\r\\t\\n ]*</?(\\w+)\\s*(?:[^>]*)>","g"),function(n,t){return t&&!f.$inlineWithA[t.toLowerCase()]?n.replace(/(^[\n\r\t ]*)|([\n\r\t ]*$)/g,""):n.replace(/(^[\n\r\t]*)|([\n\r\t]*$)/g,"")}),u.setContent=a,u.setContent(i),e.dispose(),e=null,u.getContent=c,l=u.body.firstChild,l||(u.body.innerHTML="<p>"+(r.ie?"":"<br/>")+"</p>",l=u.body.firstChild),u.undoManger&&u.undoManger.save(!0);if(r.gecko)t=document.createElement("input"),t.style.cssText="position:absolute;left:0;top:-32768px",document.body.appendChild(t),u.body.contentEditable=!1,setTimeout(function(){n.setViewportOffset(t,{left:-32768,top:0}),t.focus(),setTimeout(function(){u.body.contentEditable=!0,u.selection.getRange().moveToAddress(h).select(!0),n.remove(t)})});else try{u.selection.getRange().moveToAddress(h).select(!0)}catch(w){}}this.fireEvent("sourcemodechanged",s)},queryCommandState:function(){return s|0},notNeedUndo:1},l=u.queryCommandState,u.queryCommandState=function(n){return n=n.toLowerCase(),s?n in{source:1,fullscreen:1}?1:-1:l.apply(this,arguments)},o.sourceEditor=="codemirror"&&u.addListener("ready",function(){t.loadFile(document,{src:o.codeMirrorJsUrl||o.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.js",tag:"script",type:"text/javascript",defer:"defer"},function(){o.sourceEditorFirst&&setTimeout(function(){u.execCommand("source")},0)}),t.loadFile(document,{tag:"link",rel:"stylesheet",type:"text/css",href:o.codeMirrorCssUrl||o.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.css"})})}})(),UE.plugins.enterkey=function(){var i,t=this,u=t.options.enterTag;t.addListener("keyup",function(u,f){var v=f.keyCode||f.which,o,c,l,a,s,e,h;if(v==13){o=t.selection.getRange(),c=o.startContainer;if(r.ie)t.fireEvent("saveScene",!0,!0);else{if(/h\d/i.test(i)){if(r.gecko)a=n.findParentByTagName(c,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],!0),a||(t.document.execCommand("formatBlock",!1,"<p>"),l=1);else if(c.nodeType==1){s=t.document.createTextNode(""),o.insertNode(s),e=n.findParentByTagName(s,"div",!0);if(e){h=t.document.createElement("p");while(e.firstChild)h.appendChild(e.firstChild);e.parentNode.insertBefore(h,e),n.remove(e),o.setStartBefore(s).setCursor(),l=1}n.remove(s)}t.undoManger&&l&&t.undoManger.save()}r.opera&&o.select()}}}),t.addListener("keydown",function(e,o){var y=o.keyCode||o.which,s,c,v;if(y==13){if(t.fireEvent("beforeenterkeydown")){n.preventDefault(o);return}t.fireEvent("saveScene",!0,!0),i="",s=t.selection.getRange();if(!s.collapsed){var h=s.startContainer,p=s.endContainer,a=n.findParentByTagName(h,"td",!0),l=n.findParentByTagName(p,"td",!0);if(a&&l&&a!==l||!a&&l||a&&!l){o.preventDefault?o.preventDefault():o.returnValue=!1;return}}if(u=="p")r.ie||(h=n.findParentByTagName(s.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],!0),!h&&!r.opera?(t.document.execCommand("formatBlock",!1,"<p>"),r.gecko&&(s=t.selection.getRange(),h=n.findParentByTagName(s.startContainer,"p",!0),h&&n.removeDirtyAttr(h))):(i=h.tagName,h.tagName.toLowerCase()=="p"&&r.gecko&&n.removeDirtyAttr(h)));else{o.preventDefault?o.preventDefault():o.returnValue=!1;if(s.collapsed)c=s.document.createElement("br"),s.insertNode(c),v=c.parentNode,v.lastChild===c?(c.parentNode.insertBefore(c.cloneNode(!0),c),s.setStartBefore(c)):s.setStartAfter(c),s.setCursor();else{s.deleteContents(),h=s.startContainer;if(h.nodeType==1&&(h=h.childNodes[s.startOffset])){while(h.nodeType==1){if(f.$empty[h.tagName])return s.setStartBefore(h).setCursor(),t.undoManger&&t.undoManger.save(),!1;if(!h.firstChild)return c=s.document.createElement("br"),h.appendChild(c),s.setStart(h,0).setCursor(),t.undoManger&&t.undoManger.save(),!1;h=h.firstChild}h===s.startContainer.childNodes[s.startOffset]?(c=s.document.createElement("br"),s.insertNode(c).setCursor()):s.setStart(h,0).setCursor()}else c=s.document.createElement("br"),s.insertNode(c).setStartAfter(c).setCursor()}}}})},UE.plugins.keystrokes=function(){var t=this,i=!0;t.addListener("keydown",function(u,f){var c=f.keyCode||f.which,e=t.selection.getRange(),s,o,y,nt,h,w,p,d,b,l,v;if(!e.collapsed&&!(f.ctrlKey||f.shiftKey||f.altKey||f.metaKey)&&(c>=65&&c<=90||c>=48&&c<=57||c>=96&&c<=111||({13:1,8:1,46:1})[c])){s=e.startContainer,n.isFillChar(s)&&e.setStartBefore(s),s=e.endContainer,n.isFillChar(s)&&e.setEndAfter(s),e.txtToElmBoundary(),e.endContainer&&e.endContainer.nodeType==1&&(s=e.endContainer.childNodes[e.endOffset],s&&n.isBr(s)&&e.setEndAfter(s));if(e.startOffset==0){s=e.startContainer;if(n.isBoundaryNode(s,"firstChild")){s=e.endContainer;if(e.endOffset==(s.nodeType==3?s.nodeValue.length:s.childNodes.length)&&n.isBoundaryNode(s,"lastChild")){t.fireEvent("saveScene"),t.body.innerHTML="<p>"+(r.ie?"":"<br/>")+"</p>",e.setStart(t.body.firstChild,0).setCursor(!1,!0),t._selectionChange();return}}}}if(c==a.Backspace){e=t.selection.getRange(),i=e.collapsed;if(t.fireEvent("delkeydown",f))return;e.collapsed&&e.inFillChar()&&(o=e.startContainer,n.isFillChar(o)?(e.setStartBefore(o).shrinkBoundary(!0).collapse(!0),n.remove(o)):(o.nodeValue=o.nodeValue.replace(new RegExp("^"+n.fillChar),""),e.startOffset--,e.collapse(!0).select(!0)));if(o=e.getClosedNode()){t.fireEvent("saveScene"),e.setStartBefore(o),n.remove(o),e.setCursor(),t.fireEvent("saveScene"),n.preventDefault(f);return}if(!r.ie){o=n.findParentByTagName(e.startContainer,"table",!0),y=n.findParentByTagName(e.endContainer,"table",!0);if(o&&!y||!o&&y||o!==y){f.preventDefault();return}}}if(c==a.Tab){nt={ol:1,ul:1,table:1};if(t.fireEvent("tabkeydown",f)){n.preventDefault(f);return}h=t.selection.getRange(),t.fireEvent("saveScene");for(var k=0,g="",it=t.options.tabSize||4,tt=t.options.tabNode||"&nbsp;";k<it;k++)g+=tt;w=t.document.createElement("span"),w.innerHTML=g+n.fillChar;if(h.collapsed)h.insertNode(w.cloneNode(!0).firstChild).setCursor(!0);else{p=function(t){return n.isBlockElm(t)&&!nt[t.tagName.toLowerCase()]},o=n.findParent(h.startContainer,p,!0),y=n.findParent(h.endContainer,p,!0);if(o&&y&&o===y)h.deleteContents(),h.insertNode(w.cloneNode(!0).firstChild).setCursor(!0);else{d=h.createBookmark(),h.enlarge(!0),b=h.createBookmark(),l=n.getNextDomNode(b.start,!1,p);while(l&&!(n.getPosition(l,b.end)&n.POSITION_FOLLOWING))l.insertBefore(w.cloneNode(!0).firstChild,l.firstChild),l=n.getNextDomNode(l,!1,p);h.moveToBookmark(b).moveToBookmark(d).select()}}n.preventDefault(f)}if(r.gecko&&c==46){h=t.selection.getRange();if(h.collapsed){o=h.startContainer;if(n.isEmptyBlock(o)){v=o.parentNode;while(n.getChildCount(v)==1&&!n.isBody(v))o=v,v=v.parentNode;o===v.lastChild&&f.preventDefault();return}}}}),t.addListener("keyup",function(t,u){var v=u.keyCode||u.which,f,c=this,l,s,o,e,h;if(v==a.Backspace){if(c.fireEvent("delkeyup"))return;f=c.selection.getRange();if(f.collapsed){l=["h1","h2","h3","h4","h5","h6"];if(e=n.findParentByTagName(f.startContainer,l,!0))if(n.isEmptyBlock(e)){s=e.previousSibling;if(s&&s.nodeName!="TABLE"){n.remove(e),f.setStartAtLast(s).setCursor(!1,!0);return}o=e.nextSibling;if(o&&o.nodeName!="TABLE"){n.remove(e),f.setStartAtFirst(o).setCursor(!1,!0);return}}n.isBody(f.startContainer)&&(e=n.createElement(c.document,"p",{innerHTML:r.ie?n.fillChar:"<br/>"}),f.insertNode(e).setStart(e,0).setCursor(!1,!0))}!i&&(f.startContainer.nodeType==3||f.startContainer.nodeType==1&&n.isEmptyBlock(f.startContainer))&&(r.ie?(h=f.document.createElement("span"),f.insertNode(h).setStartBefore(h).collapse(!0),f.select(),n.remove(h)):f.select())}})},UE.plugins.fiximgclick=function(){function f(){this.editor=null,this.resizer=null,this.cover=null,this.doc=document,this.prePos={x:0,y:0},this.startPos={x:0,y:0}}var u=!1;return(function(){var r=[[0,0,-1,-1],[0,0,0,-1],[0,0,1,-1],[0,0,-1,0],[0,0,1,0],[0,0,-1,1],[0,0,0,1],[0,0,1,1]];f.prototype={init:function(t){var r=this;r.editor=t,r.startPos=this.prePos={x:0,y:0},r.dragId=-1;var e=[],f=r.cover=document.createElement("div"),u=r.resizer=document.createElement("div");f.id=r.editor.ui.id+"_imagescale_cover",f.style.cssText="position:absolute;display:none;z-index:"+r.editor.options.zIndex+";filter:alpha(opacity=0); opacity:0;background:#CCC;";n.on(f,"mousedown click",function(){r.hide()});for(i=0;i<8;i++)e.push('<span class="edui-editor-imagescale-hand'+i+'"></span>');u.id=r.editor.ui.id+"_imagescale",u.className="edui-editor-imagescale",u.innerHTML=e.join(""),u.style.cssText+=";display:none;border:1px solid #3b77ff;z-index:"+r.editor.options.zIndex+";",r.editor.ui.getDom().appendChild(f),r.editor.ui.getDom().appendChild(u),r.initStyle(),r.initEvents()},initStyle:function(){t.cssRule("imagescale",".edui-editor-imagescale{display:none;position:absolute;border:1px solid #38B2CE;cursor:hand;-webkit-box-sizing: content-box;-moz-box-sizing: content-box;box-sizing: content-box;}.edui-editor-imagescale span{position:absolute;width:6px;height:6px;overflow:hidden;font-size:0px;display:block;background-color:#3C9DD0;}.edui-editor-imagescale .edui-editor-imagescale-hand0{cursor:nw-resize;top:0;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand1{cursor:n-resize;top:0;margin-top:-4px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand2{cursor:ne-resize;top:0;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand3{cursor:w-resize;top:50%;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand4{cursor:e-resize;top:50%;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand5{cursor:sw-resize;top:100%;margin-top:-3px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand6{cursor:s-resize;top:100%;margin-top:-3px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand7{cursor:se-resize;top:100%;margin-top:-3px;left:100%;margin-left:-3px;}")},initEvents:function(){var n=this;n.startPos.x=n.startPos.y=0,n.isDraging=!1},_eventHandler:function(t){var i=this,r;switch(t.type){case"mousedown":r=t.target||t.srcElement;if(r.className.indexOf("edui-editor-imagescale-hand")!=-1&&i.dragId==-1){i.dragId=r.className.slice(-1),i.startPos.x=i.prePos.x=t.clientX,i.startPos.y=i.prePos.y=t.clientY;n.on(i.doc,"mousemove",i.proxy(i._eventHandler,i))}break;case"mousemove":i.dragId!=-1&&(i.updateContainerStyle(i.dragId,{x:t.clientX-i.prePos.x,y:t.clientY-i.prePos.y}),i.prePos.x=t.clientX,i.prePos.y=t.clientY,u=!0,i.updateTargetElement());break;case"mouseup":i.dragId!=-1&&(i.updateContainerStyle(i.dragId,{x:t.clientX-i.prePos.x,y:t.clientY-i.prePos.y}),i.updateTargetElement(),i.target.parentNode&&i.attachTo(i.target),i.dragId=-1),n.un(i.doc,"mousemove",i.proxy(i._eventHandler,i)),u&&(u=!1,i.editor.fireEvent("contentchange"))}},updateTargetElement:function(){var t=this;n.setStyles(t.target,{width:t.resizer.style.width,height:t.resizer.style.height}),t.target.width=parseInt(t.resizer.style.width),t.target.height=parseInt(t.resizer.style.height),t.attachTo(t.target)},updateContainerStyle:function(n,t){var f=this,i=f.resizer,u;r[n][0]!=0&&(u=parseInt(i.style.left)+t.x,i.style.left=f._validScaledProp("left",u)+"px"),r[n][1]!=0&&(u=parseInt(i.style.top)+t.y,i.style.top=f._validScaledProp("top",u)+"px"),r[n][2]!=0&&(u=i.clientWidth+r[n][2]*t.x,i.style.width=f._validScaledProp("width",u)+"px"),r[n][3]!=0&&(u=i.clientHeight+r[n][3]*t.y,i.style.height=f._validScaledProp("height",u)+"px")},_validScaledProp:function(n,t){var r=this.resizer,i=document;t=isNaN(t)?0:t;switch(n){case"left":return t<0?0:t+r.clientWidth>i.clientWidth?i.clientWidth-r.clientWidth:t;case"top":return t<0?0:t+r.clientHeight>i.clientHeight?i.clientHeight-r.clientHeight:t;case"width":return t<=0?1:t+r.offsetLeft>i.clientWidth?i.clientWidth-r.offsetLeft:t;case"height":return t<=0?1:t+r.offsetTop>i.clientHeight?i.clientHeight-r.offsetTop:t}},hideCover:function(){this.cover.style.display="none"},showCover:function(){var t=this,r=n.getXY(t.editor.ui.getDom()),i=n.getXY(t.editor.iframe);n.setStyles(t.cover,{width:t.editor.iframe.offsetWidth+"px",height:t.editor.iframe.offsetHeight+"px",top:i.y-r.y+"px",left:i.x-r.x+"px",position:"absolute",display:""})},show:function(t){var i=this;i.resizer.style.display="block",t&&i.attachTo(t);n.on(this.resizer,"mousedown",i.proxy(i._eventHandler,i));n.on(i.doc,"mouseup",i.proxy(i._eventHandler,i));i.showCover(),i.editor.fireEvent("afterscaleshow",i),i.editor.fireEvent("saveScene")},hide:function(){var t=this;t.hideCover(),t.resizer.style.display="none",n.un(t.resizer,"mousedown",t.proxy(t._eventHandler,t)),n.un(t.doc,"mouseup",t.proxy(t._eventHandler,t)),t.editor.fireEvent("afterscalehide",t)},proxy:function(n,t){return function(){return n.apply(t||this,arguments)}},attachTo:function(t){var r=this,u=r.target=t,i=this.resizer,o=n.getXY(u),e=n.getXY(r.editor.iframe),f=n.getXY(i.parentNode);n.setStyles(i,{width:u.width+"px",height:u.height+"px",left:e.x+o.x-r.editor.document.body.scrollLeft-f.x-parseInt(i.style.borderLeftWidth)+"px",top:e.y+o.y-r.editor.document.body.scrollTop-f.y-parseInt(i.style.borderTopWidth)+"px"})}}})(),function(){var t=this,i;t.setOpt("imageScaleEnabled",!0),!r.ie&&t.options.imageScaleEnabled&&t.addListener("click",function(){var c=t.selection.getRange(),e=c.getClosedNode(),o,s,h;if(e&&e.tagName=="IMG"&&t.body.contentEditable!="false"){if(e.className.indexOf("edui-faked-music")!=-1||e.getAttribute("anchorname")||n.hasClass(e,"loadingclass")||n.hasClass(e,"loaderrorclass"))return;if(!i){i=new f,i.init(t),t.ui.getDom().appendChild(i.resizer),o=function(){i.hide(),i.target&&t.selection.getRange().selectNode(i.target).select()},s=function(n){var t=n.target||n.srcElement;t&&(t.className===undefined||t.className.indexOf("edui-editor-imagescale")==-1)&&o(n)},t.addListener("afterscaleshow",function(){t.addListener("beforekeydown",o),t.addListener("beforemousedown",s);n.on(document,"keydown",o);n.on(document,"mousedown",s);t.selection.getNative().removeAllRanges()}),t.addListener("afterscalehide",function(){t.removeListener("beforekeydown",o),t.removeListener("beforemousedown",s),n.un(document,"keydown",o),n.un(document,"mousedown",s);var u=i.target;u.parentNode&&t.selection.getRange().selectNode(u).select()});n.on(i.resizer,"mousedown",function(n){t.selection.getNative().removeAllRanges();var r=n.target||n.srcElement;r&&r.className.indexOf("edui-editor-imagescale-hand")==-1&&(h=setTimeout(function(){i.hide(),i.target&&t.selection.getRange().selectNode(r).select()},200))});n.on(i.resizer,"mouseup",function(n){var t=n.target||n.srcElement;t&&t.className.indexOf("edui-editor-imagescale-hand")==-1&&clearTimeout(h)})}i.show(e)}else i&&i.resizer.style.display!="none"&&i.hide()}),r.webkit&&t.addListener("click",function(n,i){if(i.target.tagName=="IMG"&&t.body.contentEditable!="false"){var r=new e.Range(t.document);r.selectNode(i.target).select()}})}}(),UE.plugin.register("autolink",function(){var i=0;return r.ie?{}:{bindEvents:{reset:function(){i=0},keydown:function(i,r){var s=this,v=r.keyCode||r.which,f,e,h,o;if(v==32||v==13){var c=s.selection.getNative(),u=c.getRangeAt(0).cloneRange(),l,a,f=u.startContainer;while(f.nodeType==1&&u.startOffset>0){f=u.startContainer.childNodes[u.startOffset-1];if(!f)break;u.setStart(f,f.nodeType==1?f.childNodes.length:f.nodeValue.length),u.collapse(!0),f=u.startContainer}do{if(u.startOffset==0){f=u.startContainer.previousSibling;while(f&&f.nodeType==1)f=f.lastChild;if(!f||n.isFillChar(f))break;l=f.nodeValue.length}else f=u.startContainer,l=u.startOffset;u.setStart(f,l-1),a=u.toString().charCodeAt(0)}while(a!=160&&a!=32);if(u.toString().replace(new RegExp(n.fillChar,"g"),"").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){while(u.toString().length){if(/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(u.toString()))break;try{u.setStart(u.startContainer,u.startOffset+1)}catch(y){f=u.startContainer;while(!(next=f.nextSibling)){if(n.isBody(f))return;f=f.parentNode}u.setStart(next,0)}}if(n.findParentByTagName(u.startContainer,"a",!0))return;e=s.document.createElement("a"),h=s.document.createTextNode(" "),s.undoManger&&s.undoManger.save(),e.appendChild(u.extractContents()),e.href=e.innerHTML=e.innerHTML.replace(/<[^>]+>/g,""),o=e.getAttribute("href").replace(new RegExp(n.fillChar,"g"),""),o=/^(?:https?:\/\/)/ig.test(o)?o:"http://"+o,e.setAttribute("_src",t.html(o)),e.href=t.html(o),u.insertNode(e),e.parentNode.insertBefore(h,e.nextSibling),u.setStart(h,0),u.collapse(!0),c.removeAllRanges(),c.addRange(u),s.undoManger&&s.undoManger.save()}}}}}},function(){function t(t){if(t.nodeType==3)return null;if(t.nodeName=="A")return t;var i=t.lastChild;while(i){if(i.nodeName=="A")return i;if(i.nodeType==3){if(n.isWhitespace(i)){i=i.previousSibling;continue}return null}i=i.lastChild}}var i={37:1,38:1,39:1,40:1,13:1,32:1};r.ie&&this.addListener("keyup",function(r,u){var c=this,s=u.keyCode,o,f,e,h;if(i[s]){o=c.selection.getRange(),f=o.startContainer;if(s==13){while(f&&!n.isBody(f)&&!n.isBlockElm(f))f=f.parentNode;f&&!n.isBody(f)&&f.nodeName=="P"&&(e=f.previousSibling,e&&e.nodeType==1&&(e=t(e),e&&!e.getAttribute("_href")&&n.remove(e,!0)))}else s==32?f.nodeType==3&&/^\s$/.test(f.nodeValue)&&(f=f.previousSibling,f&&f.nodeName=="A"&&!f.getAttribute("_href")&&n.remove(f,!0)):(f=n.findParentByTagName(f,"a",!0),f&&!f.getAttribute("_href")&&(h=o.createBookmark(),n.remove(f,!0),o.moveToBookmark(h).select(!0)))}})}),UE.plugins.autoheight=function(){function i(){var t=this;clearTimeout(h);if(o)return;(!t.queryCommandState||t.queryCommandState&&t.queryCommandState("source")!=1)&&(h=setTimeout(function(){var i=t.body.lastChild;while(i&&i.nodeType!=1)i=i.previousSibling;i&&i.nodeType==1&&(i.style.clear="both",u=Math.max(n.getXY(i).y+i.offsetHeight+25,Math.max(f.minFrameHeight,f.initialFrameHeight)),u!=e&&(u!==parseInt(t.iframe.parentNode.style.height)&&(t.iframe.parentNode.style.height=u+"px"),t.body.style.height=u+"px",e=u),n.removeStyle(i,"clear"))},50))}var t=this,s,e,f,u,h,o;t.autoHeightEnabled=t.options.autoHeightEnabled!==!1;if(!t.autoHeightEnabled)return;e=0,f=t.options,t.addListener("fullscreenchanged",function(n,t){o=t}),t.addListener("destroy",function(){t.removeListener("contentchange afterinserthtml keyup mouseup",i)}),t.enableAutoHeight=function(){var n=this,t;if(!n.autoHeightEnabled)return;t=n.document,n.autoHeightEnabled=!0,s=t.body.style.overflowY,t.body.style.overflowY="hidden",n.addListener("contentchange afterinserthtml keyup mouseup",i),setTimeout(function(){i.call(n)},r.gecko?100:0),n.fireEvent("autoheightchanged",n.autoHeightEnabled)},t.disableAutoHeight=function(){t.body.style.overflowY=s||"",t.removeListener("contentchange",i),t.removeListener("keyup",i),t.removeListener("mouseup",i),t.autoHeightEnabled=!1,t.fireEvent("autoheightchanged",t.autoHeightEnabled)};t.on("setHeight",function(){t.disableAutoHeight()});t.addListener("ready",function(){var f,u;t.enableAutoHeight();n.on(r.ie?t.body:t.document,r.webkit?"dragover":"drop",function(){clearTimeout(f),f=setTimeout(function(){i.call(t)},100)});window.onscroll=function(){u===null?u=this.scrollY:this.scrollY==0&&u!=0&&(t.window.scrollTo(0,0),u=null)}})},UE.plugins.autofloat=function(){function d(){return UE.ui?1:(alert(b.autofloatMsg),0)}function w(){var n=document.body.style;n.backgroundImage='url("about:blank")',n.backgroundAttachment="fixed"}function k(){var s=n.getXY(i),t=n.getComputedStyle(i,"position"),f=n.getComputedStyle(i,"left");i.style.width=i.offsetWidth+"px",i.style.zIndex=u.options.zIndex*1+1,i.parentNode.insertBefore(e,i),p||g&&r.ie?(i.style.position!="absolute"&&(i.style.position="absolute"),i.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-a+l+"px"):(r.ie7Compat&&o&&(o=!1,i.style.left=n.getXY(i).x-document.documentElement.getBoundingClientRect().left+2+"px"),i.style.position!="fixed"&&(i.style.position="fixed",i.style.top=l+"px",(t=="absolute"||t=="relative")&&parseFloat(f)&&(i.style.left=s.x+"px")))}function h(){o=!0,e.parentNode&&e.parentNode.removeChild(e),i.style.cssText=y}function f(){var n=c(u.container),t=u.options.toolbarTopOffset||0;h(),n.top<0&&n.bottom-i.offsetHeight>t?k():h()}var u=this,b=u.getLang(),v,l,y,e,i,a,c,o,s;u.setOpt({topOffset:0}),v=u.options.autoFloatEnabled!==!1,l=u.options.topOffset;if(!v)return;var nt=UE.ui.uiUtils,p=r.ie&&r.version<=6,g=r.quirks;e=document.createElement("div"),o=!0,s=t.defer(function(){f()},r.ie?200:100,!0),u.addListener("destroy",function(){n.un(window,["scroll","resize"],f),u.removeListener("keydown",s)}),u.addListener("ready",function(){if(d(u)){if(!u.ui)return;c=nt.getClientRect,i=u.ui.getDom("toolbarbox"),a=c(i).top,y=i.style.cssText,e.style.height=i.offsetHeight+"px",p&&w();n.on(window,["scroll","resize"],f);u.addListener("keydown",s);try{jQuery(u.options.scrollContainer).on("scroll",f)}catch(t){}u.addListener("beforefullscreenchange",function(n,t){t&&h()}),u.addListener("fullscreenchanged",function(n,t){t||f()}),u.addListener("sourcemodechanged",function(){setTimeout(function(){f()},0)}),u.addListener("clearDoc",function(){setTimeout(function(){f()},0)})}})},UE.plugins.video=function(){function r(n,r,u,f,e,o,s){var c,h;switch(s){case"image":c="<img "+(f?'id="'+f+'"':"")+' width="'+r+'" height="'+u+'" _url="'+n+'" class="'+o.replace(/\bvideo-js\b/,"")+'" src="'+i.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" style="background:url('+i.options.UEDITOR_HOME_URL+"themes/default/images/videologo.gif) no-repeat center center; border:1px solid gray;"+(e?"float:"+e+";":"")+'" />';break;case"embed":c='<embed type="application/x-shockwave-flash" class="'+o+'" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+t.html(n)+'" width="'+r+'" height="'+u+'"'+(e?' style="float:'+e+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >';break;case"video":h=n.substr(n.lastIndexOf(".")+1),h=="ogv"&&(h="ogg"),c="<video"+(f?' id="'+f+'"':"")+' class="'+o+' video-js" '+(e?' style="float:'+e+'"':"")+' controls preload="none" width="'+r+'" height="'+u+'" src="'+n+'" data-setup="{}"><source src="'+n+'" type="video/'+h+'" /></video>'}return c}function u(n,i){t.each(n.getNodesByTagName(i?"img":"embed video"),function(n){var t=n.getAttr("class"),u;t&&t.indexOf("edui-faked-video")!=-1&&(u=r(i?n.getAttr("_url"):n.getAttr("src"),n.getAttr("width"),n.getAttr("height"),null,n.getStyle("float")||"",t,i?"embed":"image"),n.parentNode.replaceChild(UE.uNode.createElement(u),n)),t&&t.indexOf("edui-upload-video")!=-1&&(u=r(i?n.getAttr("_url"):n.getAttr("src"),n.getAttr("width"),n.getAttr("height"),null,n.getStyle("float")||"",t,i?"video":"image"),n.parentNode.replaceChild(UE.uNode.createElement(u),n))})}var i=this;i.addOutputRule(function(n){u(n,!0)}),i.addInputRule(function(n){u(n)}),i.commands.insertvideo={execCommand:function(u,f,e){var c,y,a,h,v,o,s,l;for(f=t.isArray(f)?f:[f],c=[],y="tmpVedio",o=0,s=f.length;o<s;o++)h=f[o],a=e=="upload"?"edui-upload-video video-js vjs-default-skin":"edui-faked-video",c.push(r(h.url,h.width||420,h.height||280,y+o,null,a,"image"));for(i.execCommand("inserthtml",c.join(""),!0),v=this.selection.getRange(),o=0,s=f.length;o<s;o++)l=this.document.getElementById("tmpVedio"+o),n.removeAttributes(l,"id"),v.selectNode(l).select(),i.execCommand("imagefloat",f[o].align)},queryCommandState:function(){var n=i.selection.getRange().getClosedNode(),t=n&&(n.className=="edui-faked-video"||n.className.indexOf("edui-upload-video")!=-1);return t?1:0}}},(function(){function u(){}var i=UE.UETable=function(n){this.table=n,this.indexTable=[],this.selectedTds=[],this.cellsRange={},this.update(n)};i.removeSelectedClass=function(i){t.each(i,function(t){n.removeClasses(t,"selectTdClass")})},i.addSelectedClass=function(i){t.each(i,function(t){n.addClass(t,"selectTdClass")})},i.isEmptyBlock=function(t){var u=new RegExp(n.fillChar,"g"),i;if(t[r.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(u,"").length>0)return 0;for(i in f.$isNotEmpty)if(f.$isNotEmpty.hasOwnProperty(i))if(t.getElementsByTagName(i).length)return 0;return 1},i.getWidth=function(t){return t?parseInt(n.getComputedStyle(t,"width"),10):0},i.getTableCellAlignState=function(n){!t.isArray(n)&&(n=[n]);var i={},f=["align","valign"],r=null,u=!0;return t.each(n,function(n){return t.each(f,function(t){r=n.getAttribute(t);if(!i[t]&&r)i[t]=r;else if(!i[t]||r!==i[t])return u=!1,!1}),u}),u?i:null},i.getTableItemsByRange=function(t){var i=t.selection.getStart();i&&i.id&&i.id.indexOf("_baidu_bookmark_start_")===0&&i.nextSibling&&(i=i.nextSibling);var f=i&&n.findParentByTagName(i,["td","th"],!0),u=f&&f.parentNode,r=i&&n.findParentByTagName(i,"caption",!0),e=r?r.parentNode:u&&u.parentNode.parentNode;return{cell:f,tr:u,table:e,caption:r}},i.getUETableBySelected=function(n){var t=i.getTableItemsByRange(n).table;return t&&t.ueTable&&t.ueTable.selectedTds.length?t.ueTable:null},i.getDefaultValue=function(t,i){var f={thin:"0px",medium:"1px",thick:"2px"},e,o,s,r,u;return i?(u=i.getElementsByTagName("td")[0],r=n.getComputedStyle(i,"border-left-width"),e=parseInt(f[r]||r,10),r=n.getComputedStyle(u,"padding-left"),o=parseInt(f[r]||r,10),r=n.getComputedStyle(u,"border-left-width"),s=parseInt(f[r]||r,10),{tableBorder:e,tdPadding:o,tdBorder:s}):(i=t.document.createElement("table"),i.insertRow(0).insertCell(0).innerHTML="xxx",t.body.appendChild(i),u=i.getElementsByTagName("td")[0],r=n.getComputedStyle(i,"border-left-width"),e=parseInt(f[r]||r,10),r=n.getComputedStyle(u,"padding-left"),o=parseInt(f[r]||r,10),r=n.getComputedStyle(u,"border-left-width"),s=parseInt(f[r]||r,10),n.remove(i),{tableBorder:e,tdPadding:o,tdBorder:s})},i.getUETable=function(t){var r=t.tagName.toLowerCase();return t=r=="td"||r=="th"||r=="caption"?n.findParentByTagName(t,"table",!0):t,t.ueTable||(t.ueTable=new i(t)),t.ueTable},i.cloneCell=function(i,r,u){var e,f;return!i||t.isString(i)?this.table.ownerDocument.createElement(i||"td"):(e=n.hasClass(i,"selectTdClass"),e&&n.removeClasses(i,"selectTdClass"),f=i.cloneNode(!0),r&&(f.rowSpan=f.colSpan=1),!u&&n.removeAttributes(f,"width height"),!u&&n.removeAttributes(f,"style"),f.style.borderLeftStyle="",f.style.borderTopStyle="",f.style.borderLeftColor=i.style.borderRightColor,f.style.borderLeftWidth=i.style.borderRightWidth,f.style.borderTopColor=i.style.borderBottomColor,f.style.borderTopWidth=i.style.borderBottomWidth,e&&n.addClass(i,"selectTdClass"),f)},i.prototype={getMaxRows:function(){for(var e=this.table.rows,i=1,u,t,r,f,n=0;u=e[n];n++){for(t=1,r=0;f=u.cells[r++];)t=Math.max(f.rowSpan||1,t);i=Math.max(t+n,i)}return i},getMaxCols:function(){for(var s=this.table.rows,f=0,u={},o,r,e,t,i,n=0;o=s[n];n++){for(r=0,e=0;t=o.cells[e++];){r+=t.colSpan||1;if(t.rowSpan&&t.rowSpan>1)for(i=1;i<t.rowSpan;i++)u["row_"+(n+i)]?u["row_"+(n+i)]++:u["row_"+(n+i)]=t.colSpan||1}r+=u["row_"+n]||0,f=Math.max(r,f)}return f},getCellColIndex:function(){},getHSideCell:function(n,t){try{var i=this.getCellInfo(n),e,o,r=this.selectedTds.length,f=this.cellsRange;return!t&&(r?!f.beginColIndex:!i.colIndex)||t&&(r?f.endColIndex==this.colsNum-1:i.colIndex==this.colsNum-1)?null:(e=r?f.beginRowIndex:i.rowIndex,o=t?r?f.endColIndex+1:i.colIndex+1:r?f.beginColIndex-1:i.colIndex<1?0:i.colIndex-1,this.getCell(this.indexTable[e][o].rowIndex,this.indexTable[e][o].cellIndex))}catch(s){u(s)}},getTabNextCell:function(n,t){var f=this.getCellInfo(n),i=t||f.rowIndex,r=f.colIndex+1+(f.colSpan-1),u;try{u=this.getCell(this.indexTable[i][r].rowIndex,this.indexTable[i][r].cellIndex)}catch(e){try{i=i*1+1,r=0,u=this.getCell(this.indexTable[i][r].rowIndex,this.indexTable[i][r].cellIndex)}catch(e){}}return u},getVSideCell:function(n,t,i){try{var r=this.getCellInfo(n),o,s,f=this.selectedTds.length&&!i,e=this.cellsRange;return!t&&r.rowIndex==0||t&&(f?e.endRowIndex==this.rowsNum-1:r.rowIndex+r.rowSpan>this.rowsNum-1)?null:(o=t?f?e.endRowIndex+1:r.rowIndex+r.rowSpan:f?e.beginRowIndex-1:r.rowIndex-1,s=f?e.beginColIndex:r.colIndex,this.getCell(this.indexTable[o][s].rowIndex,this.indexTable[o][s].cellIndex))}catch(h){u(h)}},getSameEndPosCells:function(t,i){var e,s,f,o;try{var r=i.toLowerCase()==="x",h=n.getXY(t)[r?"x":"y"]+t["offset"+(r?"Width":"Height")],a=this.table.rows,c=null,l=[];for(e=0;e<this.rowsNum;e++)for(c=a[e].cells,s=0;f=c[s++];){o=n.getXY(f)[r?"x":"y"]+f["offset"+(r?"Width":"Height")];if(o>h&&r)break;if(t==f||h==o){f[r?"colSpan":"rowSpan"]==1&&l.push(f);if(r)break}}return l}catch(v){u(v)}},setCellContent:function(t,i){t.innerHTML=i||(r.ie?n.fillChar:"<br />")},cloneCell:i.cloneCell,getSameStartPosXCells:function(t){var i,e,r,f;try{var o=n.getXY(t).x+t.offsetWidth,c=this.table.rows,s,h=[];for(i=0;i<this.rowsNum;i++)for(s=c[i].cells,e=0;r=s[e++];){f=n.getXY(r).x;if(f>o)break;if(f==o&&r.colSpan==1){h.push(r);break}}return h}catch(l){u(l)}},update:function(i){var nt,h,s,l,r,k,u,f,b,o,e;this.table=i||this.table,this.selectedTds=[],this.cellsRange={},this.indexTable=[];var c=this.table.rows,a=this.getMaxRows(),it=a-c.length,p=this.getMaxCols();while(it--)this.table.insertRow(c.length);for(this.rowsNum=a,this.colsNum=p,e=0,nt=c.length;e<nt;e++)this.indexTable[e]=new Array(p);for(h=0;s=c[h];h++)for(l=0,k=s.cells;r=k[l];l++){r.rowSpan>a&&(r.rowSpan=a);var v=l,d=r.rowSpan||1,g=r.colSpan||1;while(this.indexTable[h][v])v++;for(u=0;u<d;u++)for(f=0;f<g;f++)this.indexTable[h+u][v+f]={rowIndex:h,cellIndex:l,colIndex:v,rowSpan:d,colSpan:g}}for(u=0;u<a;u++)for(f=0;f<p;f++)this.indexTable[u][f]===undefined&&(s=c[u],r=s.cells[s.cells.length-1],r=r?r.cloneNode(!0):this.table.ownerDocument.createElement("td"),this.setCellContent(r),r.colSpan!==1&&(r.colSpan=1),r.rowSpan!==1&&(r.rowSpan=1),s.appendChild(r),this.indexTable[u][f]={rowIndex:u,cellIndex:r.cellIndex,colIndex:f,rowSpan:1,colSpan:1});b=n.getElementsByTagName(this.table,"td"),o=[],t.each(b,function(t){n.hasClass(t,"selectTdClass")&&o.push(t)});if(o.length){var tt=o[0],rt=o[o.length-1],w=this.getCellInfo(tt),y=this.getCellInfo(rt);this.selectedTds=o,this.cellsRange={beginRowIndex:w.rowIndex,beginColIndex:w.colIndex,endRowIndex:y.rowIndex+y.rowSpan-1,endColIndex:y.colIndex+y.colSpan-1}}if(!n.hasClass(this.table.rows[0],"firstRow"))for(n.addClass(this.table.rows[0],"firstRow"),e=1;e<this.table.rows.length;e++)n.removeClasses(this.table.rows[e],"firstRow")},getCellInfo:function(n){var i,t;if(!n)return;var r=n.cellIndex,u=n.parentNode.rowIndex,f=this.indexTable[u],e=this.colsNum;for(i=r;i<e;i++){t=f[i];if(t.rowIndex===u&&t.cellIndex===r)return t}},getCell:function(n,t){return n<this.rowsNum&&this.table.rows[n].cells[t]||null},deleteCell:function(n,t){t=typeof t=="number"?t:n.parentNode.rowIndex;var i=this.table.rows[t];i.deleteCell(n.cellIndex)},getCellsRange:function(n,t){function f(n,t,i,u){var c=n,h=t,l=i,a=u,s,o,e;if(n>0)for(o=t;o<u;o++)s=r.indexTable[n][o],e=s.rowIndex,e<n&&(c=Math.min(e,c));if(u<r.colsNum)for(e=n;e<i;e++)s=r.indexTable[e][u],o=s.colIndex+s.colSpan-1,o>u&&(a=Math.max(o,a));if(i<r.rowsNum)for(o=t;o<u;o++)s=r.indexTable[i][o],e=s.rowIndex+s.rowSpan-1,e>i&&(l=Math.max(e,l));if(t>0)for(e=n;e<i;e++)s=r.indexTable[e][t],o=s.colIndex,o<t&&(h=Math.min(s.colIndex,h));return c!=n||h!=t||l!=i||a!=u?f(c,h,l,a):{beginRowIndex:n,beginColIndex:t,endRowIndex:i,endColIndex:u}}var r,i;try{r=this,i=r.getCellInfo(n);if(n===t)return{beginRowIndex:i.rowIndex,beginColIndex:i.colIndex,endRowIndex:i.rowIndex+i.rowSpan-1,endColIndex:i.colIndex+i.colSpan-1};var u=r.getCellInfo(t),s=Math.min(i.rowIndex,u.rowIndex),h=Math.min(i.colIndex,u.colIndex),e=Math.max(i.rowIndex+i.rowSpan-1,u.rowIndex+u.rowSpan-1),o=Math.max(i.colIndex+i.colSpan-1,u.colIndex+u.colSpan-1);return f(s,h,e,o)}catch(c){}},getCells:function(n){var i,u,e;this.clearSelected();var a=n.beginRowIndex,l=n.beginColIndex,h=n.endRowIndex,s=n.endColIndex,t,r,f,c={},o=[];for(i=a;i<=h;i++)for(u=l;u<=s;u++){t=this.indexTable[i][u],r=t.rowIndex,f=t.colIndex,e=r+"|"+f;if(c[e])continue;c[e]=1;if(r<i||f<u||r+t.rowSpan-1>h||f+t.colSpan-1>s)return null;o.push(this.getCell(r,t.cellIndex))}return o},clearSelected:function(){i.removeSelectedClass(this.selectedTds),this.selectedTds=[],this.cellsRange={}},setSelected:function(n){var t=this.getCells(n);i.addSelectedClass(t),this.selectedTds=t,this.cellsRange=n},isFullRow:function(){var n=this.cellsRange;return n.endColIndex-n.beginColIndex+1==this.colsNum},isFullCol:function(){var t=this.cellsRange,i=this.table,r=i.getElementsByTagName("th"),n=t.endRowIndex-t.beginRowIndex+1;return r.length?n==this.rowsNum||n==this.rowsNum-1:n==this.rowsNum},getNextCell:function(n,t,i){try{var r=this.getCellInfo(n),o,s,f=this.selectedTds.length&&!i,e=this.cellsRange;return!t&&r.rowIndex==0||t&&(f?e.endRowIndex==this.rowsNum-1:r.rowIndex+r.rowSpan>this.rowsNum-1)?null:(o=t?f?e.endRowIndex+1:r.rowIndex+r.rowSpan:f?e.beginRowIndex-1:r.rowIndex-1,s=f?e.beginColIndex:r.colIndex,this.getCell(this.indexTable[o][s].rowIndex,this.indexTable[o][s].cellIndex))}catch(h){u(h)}},getPreviewCell:function(n,t){try{var i=this.getCellInfo(n),e,o,r=this.selectedTds.length,f=this.cellsRange;return!t&&(r?!f.beginColIndex:!i.colIndex)||t&&(r?f.endColIndex==this.colsNum-1:i.rowIndex>this.colsNum-1)?null:(e=t?r?f.beginRowIndex:i.rowIndex<1?0:i.rowIndex-1:r?f.beginRowIndex:i.rowIndex,o=t?r?f.endColIndex+1:i.colIndex:r?f.beginColIndex-1:i.colIndex<1?0:i.colIndex-1,this.getCell(this.indexTable[e][o].rowIndex,this.indexTable[e][o].cellIndex))}catch(s){u(s)}},moveContent:function(n,t){if(i.isEmptyBlock(t))return;if(i.isEmptyBlock(n)){n.innerHTML=t.innerHTML;return}var r=n.lastChild;(r.nodeType==3||!f.$block[r.tagName])&&n.appendChild(n.ownerDocument.createElement("br"));while(r=t.firstChild)n.appendChild(r)},mergeRight:function(n){var i=this.getCellInfo(n),u=i.colIndex+i.colSpan,t=this.indexTable[i.rowIndex][u],r=this.getCell(t.rowIndex,t.cellIndex);n.colSpan=i.colSpan+t.colSpan,n.removeAttribute("width"),this.moveContent(n,r),this.deleteCell(r,t.rowIndex),this.update()},mergeDown:function(n){var i=this.getCellInfo(n),u=i.rowIndex+i.rowSpan,t=this.indexTable[u][i.colIndex],r=this.getCell(t.rowIndex,t.cellIndex);n.rowSpan=i.rowSpan+t.rowSpan,n.removeAttribute("height"),this.moveContent(n,r),this.deleteCell(r,t.rowIndex),this.update()},mergeRange:function(){var t=this.cellsRange,n=this.getCell(t.beginRowIndex,this.indexTable[t.beginRowIndex][t.beginColIndex].cellIndex),f,e,h,r,u,i,o,s;for(n.tagName=="TH"&&t.endRowIndex!==t.beginRowIndex&&(f=this.indexTable,e=this.getCellInfo(n),n=this.getCell(1,f[1][e.colIndex].cellIndex),t=this.getCellsRange(n,this.getCell(f[this.rowsNum-1][e.colIndex].rowIndex,f[this.rowsNum-1][e.colIndex].cellIndex))),h=this.getCells(t),i=0;r=h[i++];)r!==n&&(this.moveContent(n,r),this.deleteCell(r));n.rowSpan=t.endRowIndex-t.beginRowIndex+1,n.rowSpan>1&&n.removeAttribute("height"),n.colSpan=t.endColIndex-t.beginColIndex+1,n.colSpan>1&&n.removeAttribute("width"),n.rowSpan==this.rowsNum&&n.colSpan!=1&&(n.colSpan=1);if(n.colSpan==this.colsNum&&n.rowSpan!=1){u=n.parentNode.rowIndex;if(this.table.deleteRow)for(var i=u+1,c=u+1,o=n.rowSpan;i<o;i++)this.table.deleteRow(c);else for(i=0,o=n.rowSpan-1;i<o;i++)s=this.table.rows[u+1],s.parentNode.removeChild(s);n.rowSpan=1}this.update()},insertRow:function(t,i){function s(t,i,r){var e,u,f;t==0?(e=r.nextSibling||r.previousSibling,u=e.cells[t],u.tagName=="TH"&&(u=i.ownerDocument.createElement("th"),u.appendChild(i.firstChild),r.insertBefore(u,i),n.remove(i))):i.tagName=="TH"&&(f=i.ownerDocument.createElement("td"),f.appendChild(i.firstChild),r.insertBefore(f,i),n.remove(i))}var h=this.colsNum,l=this.table,e=l.insertRow(t),r,c=typeof i=="string"&&i.toUpperCase()=="TH",u,o,a,f;if(t==0||t==this.rowsNum)for(u=0;u<h;u++)r=this.cloneCell(i,!0),this.setCellContent(r),r.getAttribute("vAlign")&&r.setAttribute("vAlign",r.getAttribute("vAlign")),e.appendChild(r),c||s(u,r,e);else for(o=this.indexTable[t],a=0,u=0;u<h;u++)f=o[u],f.rowIndex<t?(r=this.getCell(f.rowIndex,f.cellIndex),r.rowSpan=f.rowSpan+1):(r=this.cloneCell(i,!0),this.setCellContent(r),e.appendChild(r)),c||s(u,r,e);return this.update(),e},deleteRow:function(i){for(var w=this.table.rows[i],l=this.indexTable[i],k=this.colsNum,d=0,e,u,f,c,h,s,r=0;r<k;){e=l[r],u=this.getCell(e.rowIndex,e.cellIndex);if(u.rowSpan>1)if(e.rowIndex==i){f=u.cloneNode(!0),f.rowSpan=u.rowSpan-1,f.innerHTML="",u.rowSpan=1;var y=i+1,o=this.table.rows[y],b,g=this.getPreviewMergedCellsNum(y,r)-d;g<r?(b=r-g-1,n.insertAfter(o.cells[b],f)):o.cells.length&&o.insertBefore(f,o.cells[0]),d+=1}r+=u.colSpan||1}for(c=[],h={},r=0;r<k;r++){var v=l[r].rowIndex,a=l[r].cellIndex,p=v+"_"+a;if(h[p])continue;h[p]=1,u=this.getCell(v,a),c.push(u)}s=[],t.each(c,function(n){n.rowSpan==1?n.parentNode.removeChild(n):s.push(n)}),t.each(s,function(n){n.rowSpan--}),w.parentNode.removeChild(w),this.update()},insertCol:function(t,i,r){function l(t,i,r){var u,f;t==0?(u=i.nextSibling||i.previousSibling,u.tagName=="TH"&&(u=i.ownerDocument.createElement("th"),u.appendChild(i.firstChild),r.insertBefore(u,i),n.remove(i))):i.tagName=="TH"&&(f=i.ownerDocument.createElement("td"),f.appendChild(i.firstChild),r.insertBefore(f,i),n.remove(i))}var h=this.rowsNum,e=0,f,u,a=parseInt((this.table.offsetWidth-(this.colsNum+1)*20-(this.colsNum+1))/(this.colsNum+1),10),c=typeof i=="string"&&i.toUpperCase()=="TH",o,s;if(t==0||t==this.colsNum)for(;e<h;e++)f=this.table.rows[e],o=f.cells[t==0?t:f.cells.length],u=this.cloneCell(i,!0),this.setCellContent(u),u.setAttribute("vAlign",u.getAttribute("vAlign")),o&&u.setAttribute("width",o.getAttribute("width")),t?n.insertAfter(f.cells[f.cells.length-1],u):f.insertBefore(u,f.cells[0]),c||l(e,u,f);else for(;e<h;e++)s=this.indexTable[e][t],s.colIndex<t?(u=this.getCell(s.rowIndex,s.cellIndex),u.colSpan=s.colSpan+1):(f=this.table.rows[e],o=f.cells[s.cellIndex],u=this.cloneCell(i,!0),this.setCellContent(u),u.setAttribute("vAlign",u.getAttribute("vAlign")),o&&u.setAttribute("width",o.getAttribute("width")),o?f.insertBefore(u,o):f.appendChild(u)),c||l(e,u,f);this.update(),this.updateWidth(a,r||{tdPadding:10,tdBorder:1})},updateWidth:function(r,u){var f=this.table,o=i.getWidth(f)-u.tdPadding*2-u.tdBorder+r,e;if(o<f.ownerDocument.body.offsetWidth){f.setAttribute("width",o);return}e=n.getElementsByTagName(this.table,"td th"),t.each(e,function(n){n.setAttribute("width",r)})},deleteCol:function(n){for(var o=this.indexTable,h=this.table.rows,c=this.table.getAttribute("width"),u=0,s=this.rowsNum,f={},t,r=0;r<s;){var l=o[r],i=l[n],e=i.rowIndex+"_"+i.colIndex;if(f[e])continue;f[e]=1,t=this.getCell(i.rowIndex,i.cellIndex),u||(u=t&&parseInt(t.offsetWidth/t.colSpan,10).toFixed(0)),t.colSpan>1?t.colSpan--:h[r].deleteCell(i.cellIndex),r+=i.rowSpan||1}this.table.setAttribute("width",c-u),this.update()},splitToCells:function(n){var r=this,i=this.splitToRows(n);t.each(i,function(n){r.splitToCols(n)})},splitToRows:function(n){var r=this.getCellInfo(n),f=r.rowIndex,e=r.colIndex,u=[],i,s,o,t;for(n.rowSpan=1,u.push(n),i=f,s=f+r.rowSpan;i<s;i++){if(i==f)continue;o=this.table.rows[i],t=o.insertCell(e-this.getPreviewMergedCellsNum(i,e)),t.colSpan=r.colSpan,this.setCellContent(t),t.setAttribute("vAlign",n.getAttribute("vAlign")),t.setAttribute("align",n.getAttribute("align")),n.style.cssText&&(t.style.cssText=n.style.cssText),u.push(t)}return this.update(),u},getPreviewMergedCellsNum:function(n,t){for(var f=this.indexTable[n],e=0,r,u,i=0;i<t;)r=f[i].colSpan,u=f[i].rowIndex,e+=r-(u==n?1:0),i+=r;return e},splitToCols:function(t){var c=(t.offsetWidth/t.colSpan-22).toFixed(0),f=this.getCellInfo(t),l=f.rowIndex,s=f.colIndex,o=[],u,h,e,i,r;for(t.colSpan=1,t.setAttribute("width",c),o.push(t),u=s,h=s+f.colSpan;u<h;u++){if(u==s)continue;e=this.table.rows[l],i=e.insertCell(this.indexTable[l][u].cellIndex+1),i.rowSpan=f.rowSpan,this.setCellContent(i),i.setAttribute("vAlign",t.getAttribute("vAlign")),i.setAttribute("align",t.getAttribute("align")),i.setAttribute("width",c),t.style.cssText&&(i.style.cssText=t.style.cssText),t.tagName=="TH"&&(r=t.ownerDocument.createElement("th"),r.appendChild(i.firstChild),r.setAttribute("vAlign",t.getAttribute("vAlign")),r.rowSpan=i.rowSpan,e.insertBefore(r,i),n.remove(i)),o.push(i)}return this.update(),o},isLastCell:function(n,t,i){t=t||this.rowsNum,i=i||this.colsNum;var r=this.getCellInfo(n);return r.rowIndex+r.rowSpan==t&&r.colIndex+r.colSpan==i},getLastCell:function(n){n=n||this.table.getElementsByTagName("td");var s=this.getCellInfo(n[0]),e=this,i=n[0],o=i.parentNode,f=0,r=0,u;return t.each(n,function(n){n.parentNode==o&&(r+=n.colSpan||1),f+=n.rowSpan*n.colSpan||1}),u=f/r,t.each(n,function(n){if(e.isLastCell(n,u,r))return i=n,!1}),i},selectRow:function(n){var t=this.indexTable[n],u=this.getCell(t[0].rowIndex,t[0].cellIndex),r=this.getCell(t[this.colsNum-1].rowIndex,t[this.colsNum-1].cellIndex),i=this.getCellsRange(u,r);this.setSelected(i)},selectTable:function(){var n=this.table.getElementsByTagName("td"),t=this.getCellsRange(n[0],n[n.length-1]);this.setSelected(t)},setBackground:function(n,i){var f,u,e;if(typeof i=="string")t.each(n,function(n){n.style.backgroundColor=i});else if(typeof i=="object"){i=t.extend({repeat:!0,colorList:["#ddd","#fff"]},i);var s=this.getCellInfo(n[0]).rowIndex,r=0,o=i.colorList,h=function(n,t,i){return n[t]?n[t]:i?n[t%n.length]:""};for(f=0;u=n[f++];)e=this.getCellInfo(u),u.style.backgroundColor=h(o,s+r==e.rowIndex?r:++r,i.repeat)}},removeBackground:function(n){t.each(n,function(n){n.style.backgroundColor=""})}}})(),(function(){function h(i,r){var f=n.getElementsByTagName(i,"td th"),u;t.each(f,function(n){n.removeAttribute("width")}),i.setAttribute("width",c(r,!0,s(r,i))),u=[],setTimeout(function(){t.each(f,function(n){n.colSpan==1&&u.push(n.offsetWidth)}),t.each(f,function(n,t){n.colSpan==1&&n.setAttribute("width",u[t]+"")})},0)}function c(t,i,r){var u=t.body;return u.offsetWidth-(i?parseInt(n.getComputedStyle(u,"margin-left"),10)*2:0)-r.tableBorder*2-(t.options.offsetWidth||0)}function f(n){var r=i(n).cell,t;return r?(t=u(r),t.selectedTds.length?t.selectedTds:[r]):[]}var o=UE.UETable,i=function(n){return o.getTableItemsByRange(n)},e=function(n){return o.getUETableBySelected(n)},s=function(n,t){return o.getDefaultValue(n,t)},u=function(n){return o.getUETable(n)};UE.commands.inserttable={queryCommandState:function(){return i(this).table?-1:0},execCommand:function(i,u){function l(t,i){for(var f=[],o=t.numRows,s=t.numCols,e,u=0;u<o;u++){for(f.push("<tr"+(u==0?' class="firstRow"':"")+">"),e=0;e<s;e++)f.push('<td width="'+i+'"  vAlign="'+t.tdvalign+'" >'+(r.ie&&r.version<11?n.fillChar:"<br/>")+"</td>");f.push("</tr>")}return"<table><tbody>"+f.join("")+"</tbody></table>"}u||(u=t.extend({},{numCols:this.options.defaultCols,numRows:this.options.defaultRows,tdvalign:this.options.tdvalign}));var f=this,a=this.selection.getRange(),v=a.startContainer,c=n.findParent(v,function(t){return n.isBlockElm(t)},!0)||f.body,e=s(f),h=c.offsetWidth,o=Math.floor(h/u.numCols-e.tdPadding*2-e.tdBorder);!u.tdvalign&&(u.tdvalign=f.options.tdvalign),f.execCommand("inserthtml",l(u,o))}},UE.commands.insertparagraphbeforetable={queryCommandState:function(){return i(this).cell?0:-1},execCommand:function(){var t=i(this).table,n;t&&(n=this.document.createElement("p"),n.innerHTML=r.ie?"&nbsp;":"<br />",t.parentNode.insertBefore(n,t),this.selection.getRange().setStart(n,0).setCursor())}},UE.commands.deletetable={queryCommandState:function(){var t=this.selection.getRange();return n.findParentByTagName(t.startContainer,"table",!0)?0:-1},execCommand:function(t,i){var f=this.selection.getRange(),u;i=i||n.findParentByTagName(f.startContainer,"table",!0),i&&(u=i.nextSibling,u||(u=n.createElement(this.document,"p",{innerHTML:r.ie?n.fillChar:"<br/>"}),i.parentNode.insertBefore(u,i)),n.remove(i),f=this.selection.getRange(),u.nodeType==3?f.setStartBefore(u):f.setStart(u,0),f.setCursor(!1,!0),this.fireEvent("tablehasdeleted"))}},UE.commands.cellalign={queryCommandState:function(){return f(this).length?0:-1},execCommand:function(n,t){var u=f(this),r,i;if(u.length)for(r=0;i=u[r++];)i.setAttribute("align",t)}},UE.commands.cellvalign={queryCommandState:function(){return f(this).length?0:-1},execCommand:function(n,t){var u=f(this),r,i;if(u.length)for(r=0;i=u[r++];)i.setAttribute("vAlign",t)}},UE.commands.insertcaption={queryCommandState:function(){var n=i(this).table;return n?n.getElementsByTagName("caption").length==0?1:-1:-1},execCommand:function(){var u=i(this).table,t,f;u&&(t=this.document.createElement("caption"),t.innerHTML=r.ie?n.fillChar:"<br/>",u.insertBefore(t,u.firstChild),f=this.selection.getRange(),f.setStart(t,0).setCursor())}},UE.commands.deletecaption={queryCommandState:function(){var i=this.selection.getRange(),t=n.findParentByTagName(i.startContainer,"table");return t?t.getElementsByTagName("caption").length==0?-1:1:-1},execCommand:function(){var r=this.selection.getRange(),t=n.findParentByTagName(r.startContainer,"table"),i;t&&(n.remove(t.getElementsByTagName("caption")[0]),i=this.selection.getRange(),i.setStart(t.rows[0].cells[0],0).setCursor())}},UE.commands.inserttitle={queryCommandState:function(){var t=i(this).table,n;return t?(n=t.rows[0],n.cells[n.cells.length-1].tagName.toLowerCase()!="th"?0:-1):-1},execCommand:function(){var n=i(this).table,t;n&&u(n).insertRow(0,"th"),t=n.getElementsByTagName("th")[0],this.selection.getRange().setStart(t,0).setCursor(!1,!0)}},UE.commands.deletetitle={queryCommandState:function(){var t=i(this).table,n;return t?(n=t.rows[0],n.cells[n.cells.length-1].tagName.toLowerCase()=="th"?0:-1):-1},execCommand:function(){var t=i(this).table,r;t&&n.remove(t.rows[0]),r=t.getElementsByTagName("td")[0],this.selection.getRange().setStart(r,0).setCursor(!1,!0)}},UE.commands.inserttitlecol={queryCommandState:function(){var n=i(this).table,t;return n?(t=n.rows[n.rows.length-1],t.getElementsByTagName("th").length?-1:0):-1},execCommand:function(){var t=i(this).table,r;t&&u(t).insertCol(0,"th"),h(t,this),r=t.getElementsByTagName("th")[0],this.selection.getRange().setStart(r,0).setCursor(!1,!0)}},UE.commands.deletetitlecol={queryCommandState:function(){var n=i(this).table,t;return n?(t=n.rows[n.rows.length-1],t.getElementsByTagName("th").length?0:-1):-1},execCommand:function(){var t=i(this).table,r,u;if(t)for(r=0;r<t.rows.length;r++)n.remove(t.rows[r].children[0]);h(t,this),u=t.getElementsByTagName("td")[0],this.selection.getRange().setStart(u,0).setCursor(!1,!0)}},UE.commands.mergeright={queryCommandState:function(){var c=i(this),h=c.table,s=c.cell,r,t,e,f,o;if(!h||!s)return-1;r=u(h);if(r.selectedTds.length)return-1;t=r.getCellInfo(s),e=t.colIndex+t.colSpan;if(e>=r.colsNum)return-1;return f=r.indexTable[t.rowIndex][e],o=h.rows[f.rowIndex].cells[f.cellIndex],!o||s.tagName!=o.tagName?-1:f.rowIndex==t.rowIndex&&f.rowSpan==t.rowSpan?0:-1},execCommand:function(){var r=this.selection.getRange(),e=r.createBookmark(!0),t=i(this).cell,f=u(t);f.mergeRight(t),r.moveToBookmark(e).select()}},UE.commands.mergedown={queryCommandState:function(){var c=i(this),h=c.table,s=c.cell,r,t,e,f,o;if(!h||!s)return-1;r=u(h);if(r.selectedTds.length)return-1;t=r.getCellInfo(s),e=t.rowIndex+t.rowSpan;if(e>=r.rowsNum)return-1;return f=r.indexTable[e][t.colIndex],o=h.rows[f.rowIndex].cells[f.cellIndex],!o||s.tagName!=o.tagName?-1:f.colIndex==t.colIndex&&f.colSpan==t.colSpan?0:-1},execCommand:function(){var t=this.selection.getRange(),f=t.createBookmark(!0),n=i(this).cell,r=u(n);r.mergeDown(n),t.moveToBookmark(f).select()}},UE.commands.mergecells={queryCommandState:function(){return e(this)?0:-1},execCommand:function(){var r=e(this),i,t;r&&r.selectedTds.length&&(i=r.selectedTds[0],r.mergeRange(),t=this.selection.getRange(),n.isEmptyBlock(i)?t.setStart(i,0).collapse(!0):t.selectNodeContents(i),t.select())}},UE.commands.insertrow={queryCommandState:function(){var n=i(this),t=n.cell;return t&&(t.tagName=="TD"||t.tagName=="TH"&&n.tr!==n.table.rows[0])&&u(n.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var h=this.selection.getRange(),c=h.createBookmark(!0),s=i(this),f=s.cell,r=s.table,n=u(r),l=n.getCellInfo(f),t,e,o;if(n.selectedTds.length)for(t=n.cellsRange,e=0,o=t.endRowIndex-t.beginRowIndex+1;e<o;e++)n.insertRow(t.beginRowIndex,f);else n.insertRow(l.rowIndex,f);h.moveToBookmark(c).select(),r.getAttribute("interlaced")==="enabled"&&this.fireEvent("interlacetable",r)}},UE.commands.insertrownext={queryCommandState:function(){var t=i(this),n=t.cell;return n&&n.tagName=="TD"&&u(t.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var c=this.selection.getRange(),l=c.createBookmark(!0),h=i(this),f=h.cell,r=h.table,n=u(r),s=n.getCellInfo(f),t,e,o;if(n.selectedTds.length)for(t=n.cellsRange,e=0,o=t.endRowIndex-t.beginRowIndex+1;e<o;e++)n.insertRow(t.endRowIndex+1,f);else n.insertRow(s.rowIndex+s.rowSpan,f);c.moveToBookmark(l).select(),r.getAttribute("interlaced")==="enabled"&&this.fireEvent("interlacetable",r)}},UE.commands.deleterow={queryCommandState:function(){var n=i(this);return n.cell?0:-1},execCommand:function(){var s=i(this).cell,r=u(s),e=r.cellsRange,o=r.getCellInfo(s),y=r.getVSideCell(s),v=r.getVSideCell(s,!0),a=this.selection.getRange(),h,f,c,l;if(t.isEmptyObject(e))r.deleteRow(o.rowIndex);else for(h=e.beginRowIndex;h<e.endRowIndex+1;h++)r.deleteRow(e.beginRowIndex);f=r.table,f.getElementsByTagName("td").length?o.rowSpan==1||o.rowSpan==e.endRowIndex-e.beginRowIndex+1?(v||y)&&a.selectNodeContents(v||y).setCursor(!1,!0):(l=r.getCell(o.rowIndex,r.indexTable[o.rowIndex][o.colIndex].cellIndex),l&&a.selectNodeContents(l).setCursor(!1,!0)):(c=f.nextSibling,n.remove(f),c&&a.setStart(c,0).setCursor(!1,!0)),f.getAttribute("interlaced")==="enabled"&&this.fireEvent("interlacetable",f)}},UE.commands.insertcol={queryCommandState:function(){var r=i(this),t=r.cell;return t&&(t.tagName=="TD"||t.tagName=="TH"&&t!==r.tr.cells[0])&&u(r.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(n){var s=this.selection.getRange(),h=s.createBookmark(!0),r,e,o;if(this.queryCommandState(n)==-1)return;var f=i(this).cell,t=u(f),c=t.getCellInfo(f);if(t.selectedTds.length)for(r=t.cellsRange,e=0,o=r.endColIndex-r.beginColIndex+1;e<o;e++)t.insertCol(r.beginColIndex,f);else t.insertCol(c.colIndex,f);s.moveToBookmark(h).select(!0)}},UE.commands.insertcolnext={queryCommandState:function(){var n=i(this),t=n.cell;return t&&u(n.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(){var o=this.selection.getRange(),h=o.createBookmark(!0),r=i(this).cell,n=u(r),s=n.getCellInfo(r),t,f,e;if(n.selectedTds.length)for(t=n.cellsRange,f=0,e=t.endColIndex-t.beginColIndex+1;f<e;f++)n.insertCol(t.endColIndex+1,r);else n.insertCol(s.colIndex+s.colSpan,r);o.moveToBookmark(h).select()}},UE.commands.deletecol={queryCommandState:function(){var n=i(this);return n.cell?0:-1},execCommand:function(){var f=i(this).cell,r=u(f),s=r.cellsRange,v=r.getCellInfo(f),l=r.getHSideCell(f),a=r.getHSideCell(f,!0),c,o,e,h;if(t.isEmptyObject(s))r.deleteCol(v.colIndex);else for(c=s.beginColIndex;c<s.endColIndex+1;c++)r.deleteCol(s.beginColIndex);o=r.table,e=this.selection.getRange(),o.getElementsByTagName("td").length?n.inDoc(f,this.document)?e.setStart(f,0).setCursor(!1,!0):a&&n.inDoc(a,this.document)?e.selectNodeContents(a).setCursor(!1,!0):l&&n.inDoc(l,this.document)&&e.selectNodeContents(l).setCursor(!0,!0):(h=o.nextSibling,n.remove(o),h&&e.setStart(h,0).setCursor(!1,!0))}},UE.commands.splittocells={queryCommandState:function(){var r=i(this),n=r.cell,t;if(!n)return-1;return t=u(r.table),t.selectedTds.length>0?-1:n&&(n.colSpan>1||n.rowSpan>1)?0:-1},execCommand:function(){var t=this.selection.getRange(),f=t.createBookmark(!0),n=i(this).cell,r=u(n);r.splitToCells(n),t.moveToBookmark(f).select()}},UE.commands.splittorows={queryCommandState:function(){var r=i(this),n=r.cell,t;if(!n)return-1;return t=u(r.table),t.selectedTds.length>0?-1:n&&n.rowSpan>1?0:-1},execCommand:function(){var t=this.selection.getRange(),f=t.createBookmark(!0),n=i(this).cell,r=u(n);r.splitToRows(n),t.moveToBookmark(f).select()}},UE.commands.splittocols={queryCommandState:function(){var r=i(this),n=r.cell,t;if(!n)return-1;return t=u(r.table),t.selectedTds.length>0?-1:n&&n.colSpan>1?0:-1},execCommand:function(){var t=this.selection.getRange(),f=t.createBookmark(!0),n=i(this).cell,r=u(n);r.splitToCols(n),t.moveToBookmark(f).select()}},UE.commands.adaptbytext=UE.commands.adaptbywindow={queryCommandState:function(){return i(this).table?0:-1},execCommand:function(r){var e=i(this),u=e.table,f;u&&(r=="adaptbywindow"?h(u,this):(f=n.getElementsByTagName(u,"td th"),t.each(f,function(n){n.removeAttribute("width")}),u.removeAttribute("width")))}},UE.commands.averagedistributecol={queryCommandState:function(){var n=e(this);return n?n.isFullRow()||n.isFullCol()?0:-1:-1},execCommand:function(){function o(){var o=r.table,h,f=0,t=0,c=s(u,o),l,e,i,n;if(r.isFullRow())f=o.offsetWidth,t=r.colsNum;else for(l=r.cellsRange.beginColIndex,e=r.cellsRange.endColIndex,n=l;n<=e;)i=r.selectedTds[n],f+=i.offsetWidth,n+=i.colSpan,t+=1;return h=Math.ceil(f/t)-c.tdBorder*2-c.tdPadding*2}function f(i){t.each(n.getElementsByTagName(r.table,"th"),function(n){n.setAttribute("width","")});var u=r.isFullRow()?n.getElementsByTagName(r.table,"td"):r.selectedTds;t.each(u,function(n){n.colSpan==1&&n.setAttribute("width",i)})}var u=this,r=e(u);r&&r.selectedTds.length&&f(o())}},UE.commands.averagedistributerow={queryCommandState:function(){var n=e(this);return n?n.selectedTds&&/th/ig.test(n.selectedTds[0].tagName)?-1:n.isFullRow()||n.isFullCol()?0:-1:-1},execCommand:function(){function h(){var c,h,e=0,t=u.table,b=s(f,t),p=parseInt(n.getComputedStyle(t.getElementsByTagName("td")[0],"padding-top")),l,o,y,a,i;if(u.isFullCol())l=n.getElementsByTagName(t,"caption"),o=n.getElementsByTagName(t,"th"),l.length>0&&(y=l[0].offsetHeight),o.length>0&&(a=o[0].offsetHeight),e=t.offsetHeight-(y||0)-(a||0),h=o.length==0?u.rowsNum:u.rowsNum-1;else{var k=u.cellsRange.beginRowIndex,d=u.cellsRange.endRowIndex,v=0,w=n.getElementsByTagName(t,"tr");for(i=k;i<=d;i++)e+=w[i].offsetHeight,v+=1;h=v}return c=r.ie&&r.version<9?Math.ceil(e/h):Math.ceil(e/h)-b.tdBorder*2-p*2}function o(i){var r=u.isFullCol()?n.getElementsByTagName(u.table,"td"):u.selectedTds;t.each(r,function(n){n.rowSpan==1&&n.setAttribute("height",i)})}var f=this,u=e(f);u&&u.selectedTds.length&&o(h())}},UE.commands.cellalignment={queryCommandState:function(){return i(this).table?0:-1},execCommand:function(i,r){var f=this,s=e(f),o,u;s?t.each(s.selectedTds,function(t){n.setAttributes(t,r)}):(o=f.selection.getStart(),u=o&&n.findParentByTagName(o,["td","th","caption"],!0),/caption/ig.test(u.tagName)?(u.style.textAlign=r.align,u.style.verticalAlign=r.vAlign):n.setAttributes(u,r),f.selection.getRange().setCursor(!0))},queryCommandValue:function(){var t=i(this).cell,r;return t||(t=f(this)[0]),t?(r=UE.UETable.getUETable(t).selectedTds,!r.length&&(r=t),UE.UETable.getTableCellAlignState(r)):null}},UE.commands.tablealignment={queryCommandState:function(){return r.ie&&r.version<8?-1:i(this).table?0:-1},execCommand:function(t,i){var f=this,r=f.selection.getStart(),u=r&&n.findParentByTagName(r,["table"],!0);u&&u.setAttribute("align",i)}},UE.commands.edittable={queryCommandState:function(){return i(this).table?0:-1},execCommand:function(i,r){var e=this.selection.getRange(),u=n.findParentByTagName(e.startContainer,"table"),f;u&&(f=n.getElementsByTagName(u,"td").concat(n.getElementsByTagName(u,"th"),n.getElementsByTagName(u,"caption")),t.each(f,function(n){n.style.borderColor=r}))}},UE.commands.edittd={queryCommandState:function(){return i(this).table?0:-1},execCommand:function(i,r){var o=this,s=e(o),u,f;s?t.each(s.selectedTds,function(n){n.style.backgroundColor=r}):(u=o.selection.getStart(),f=u&&n.findParentByTagName(u,["td","th","caption"],!0),f&&(f.style.backgroundColor=r))}},UE.commands.settablebackground={queryCommandState:function(){return f(this).length>1?0:-1},execCommand:function(n,t){var i,r;i=f(this),r=u(i[0]),r.setBackground(i,t)}},UE.commands.cleartablebackground={queryCommandState:function(){var i=f(this),t,n;if(!i.length)return-1;for(t=0;n=i[t++];)if(n.style.backgroundColor!=="")return 0;return-1},execCommand:function(){var n=f(this),t=u(n[0]);t.removeBackground(n)}},UE.commands.interlacetable=UE.commands.uninterlacetable={queryCommandState:function(n){var r=i(this).table,t;return r?(t=r.getAttribute("interlaced"),n=="interlacetable"?t==="enabled"?-1:0:!t||t==="disabled"?-1:0):-1},execCommand:function(n,t){var r=i(this).table;n=="interlacetable"?(r.setAttribute("interlaced","enabled"),this.fireEvent("interlacetable",r,t)):(r.setAttribute("interlaced","disabled"),this.fireEvent("uninterlacetable",r))}},UE.commands.setbordervisible={queryCommandState:function(){var t=i(this).table;return t?0:-1},execCommand:function(){var r=i(this).table;t.each(n.getElementsByTagName(r,"td"),function(n){n.style.borderWidth="1px",n.style.borderStyle="solid"})}}})(),UE.plugins.table=function(){function wt(){}function ei(n){ci(n,"width",!0),ci(n,"height",!0)}function ci(n,t,i){n.style[t]&&(i&&n.setAttribute(t,parseInt(n.style[t],10)),n.style[t]="")}function pt(t){if(t.tagName=="TD"||t.tagName=="TH")return t;var i;return(i=n.findParentByTagName(t,"td",!0)||n.findParentByTagName(t,"th",!0))?i:null}function ht(t){var u=new RegExp(n.fillChar,"g"),i;if(t[r.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(u,"").length>0)return 0;for(i in f.$isNotEmpty)if(t.getElementsByTagName(i).length)return 0;return 1}function w(n){return n.pageX||n.pageY?{x:n.pageX,y:n.pageY}:{x:n.clientX+i.document.body.scrollLeft-i.document.body.clientLeft,y:n.clientY+i.document.body.scrollTop-i.document.body.clientTop}}function di(t){var u,o,f,e,h;if(ft())return;try{u=pt(t.target||t.srcElement),it&&(i.body.style.webkitUserSelect="none",(Math.abs(ct.x-t.clientX)>li||Math.abs(ct.y-t.clientY)>li)&&(yt(),it=!1,v=0,ii(t)));if(y&&a){v=0,i.body.style.webkitUserSelect="none",i.selection.getNative()[r.ie9below?"empty":"removeAllRanges"](),o=w(t),b(i,!0,y,o,u),y=="h"?c.style.left=sr(a,t)+"px":y=="v"&&(c.style.top=lr(a,t)+"px");return}if(u){if(i.fireEvent("excludetable",u)===!0)return;o=w(t),f=nt(u,o),e=n.findParentByTagName(u,"table",!0);if(tt(e,u,t,!0)){if(i.fireEvent("excludetable",e)===!0)return;i.body.style.cursor="url("+i.options.cursorpath+"h.png),pointer"}else if(tt(e,u,t)){if(i.fireEvent("excludetable",e)===!0)return;i.body.style.cursor="url("+i.options.cursorpath+"v.png),pointer"}else i.body.style.cursor="text",h=u,/\d/.test(f)&&(f=f.replace(/\d/,""),u=s(u).getPreviewCell(u,f=="v")),b(i,u?!!f:!1,u?f:"",o,u)}else hi(!1,e,i)}catch(l){wt(l)}}function hi(n,t,i){if(n)nr(t,i);else{if(ot)return;yi=setTimeout(function(){!ot&&o&&o.parentNode&&o.parentNode.removeChild(o)},2e3)}}function nr(t,i){function h(n,u){clearTimeout(r),r=setTimeout(function(){i.fireEvent("tableClicked",t,u)},300)}function e(){clearTimeout(r);var u=s(t),f=t.rows[0].cells[0],o=u.getLastCell(),e=u.getCellsRange(f,o);i.selection.getRange().setStart(f,0).setCursor(!1,!0),u.setSelected(e)}var f=n.getXY(t),u=t.ownerDocument,r;if(o&&o.parentNode)return o;o=u.createElement("div"),o.contentEditable=!1,o.innerHTML="",o.style.cssText="width:15px;height:15px;background-image:url("+i.options.UEDITOR_HOME_URL+"dialogs/table/dragicon.png);position: absolute;cursor:move;top:"+(f.y-15)+"px;left:"+f.x+"px;",n.unSelectable(o),o.onmouseover=function(){ot=!0},o.onmouseout=function(){ot=!1};n.on(o,"click",function(n,t){h(t,this)});n.on(o,"dblclick",function(n,t){e(t)});n.on(o,"dragstart",function(t,i){n.preventDefault(i)});u.body.appendChild(o)}function tt(t,i,r,u){var e=w(r),s=nt(i,e),f,o;return u?(f=t.getElementsByTagName("caption")[0],o=f?f.offsetHeight:0,s=="v1"&&e.y-n.getXY(t).y-o<8):s=="h1"&&e.x-n.getXY(t).x<8}function sr(t,r){var u=s(t);if(u){var c=u.getSameEndPosCells(t,"x")[0],h=u.getSameStartPosXCells(t)[0],f=w(r).x,e=(c?n.getXY(c).x:n.getXY(u.table).x)+20,o=h?n.getXY(h).x+h.offsetWidth-20:i.body.offsetWidth+5||parseInt(n.getComputedStyle(i.body,"width"),10);return e+=bt,o-=bt,f<e?e:f>o?o:f}}function lr(t,i){try{var u=n.getXY(t).y,r=w(i).y;return r<u?u:r}catch(f){wt(f)}}function b(n,t,i,u,f){try{n.body.style.cursor=i=="h"?"col-resize":i=="v"?"row-resize":"text",r.ie&&(i&&!d&&!l(n)?(fi(n,n.document),ni(i,f)):g(n)),lt=t}catch(e){wt(e)}}function nt(t,i){var r=n.getXY(t);return r?r.x+t.offsetWidth-i.x<k?"h":i.x-r.x<k?"h1":r.y+t.offsetHeight-i.y<k?"v":i.y-r.y<k?"v1":"":""}function er(r,u){var f,o,e;if(ft())return;ct={x:u.clientX,y:u.clientY},u.button==2?(f=l(i),o=!1,f&&(e=si(i,u),t.each(f.selectedTds,function(n){n===e&&(o=!0)}),o?(e=f.selectedTds[0],setTimeout(function(){i.selection.getRange().setStart(e,0).setCursor(!1,!0)},0)):(st(n.getElementsByTagName(i.body,"th td")),f.clearSelected()))):ir(u)}function tr(r){var u,e,l,o,h;v=0,r=r||i.window.event,u=pt(r.target||r.srcElement);if(u)if(e=nt(u,w(r))){g(i),e=="h1"&&(e="h",tt(n.findParentByTagName(u,"table"),u,r)?i.execCommand("adaptbywindow"):(u=s(u).getPreviewCell(u),u&&(l=i.selection.getRange(),l.selectNodeContents(u).setCursor(!0,!0))));if(e=="h"){var c=s(u),a=c.table,f=ui(u,a,!0);f=cr(f,"left"),c.width=c.offsetWidth,o=[],h=[],t.each(f,function(n){o.push(n.offsetWidth)}),t.each(f,function(n){n.removeAttribute("width")}),window.setTimeout(function(){var i=!0,n;t.each(f,function(n,t){var r=n.offsetWidth;if(r>o[t])return i=!1,!1;h.push(r)}),n=i?h:o,t.each(f,function(t,i){t.width=n[i]-rt()})},0)}}}function ir(r){st(n.getElementsByTagName(i.body,"td th")),t.each(i.document.getElementsByTagName("table"),function(n){n.ueTable=null}),u=si(i,r);if(!u)return;var f=n.findParentByTagName(u,"table",!0);ut=s(f),ut&&ut.clearSelected(),lt?rr(r):(i.document.body.style.webkitUserSelect="",d=!0,i.addListener("mouseover",ri))}function rr(n){r.ie&&(n=or(n)),yt(),it=!0,et=setTimeout(function(){ii(n)},ai)}function cr(n,t){for(var f=[],r=null,i=0,u=n.length;i<u;i++)r=n[i][t],r&&f.push(r);return f}function yt(){et&&clearTimeout(et),et=null}function or(n){var f=["pageX","pageY","clientX","clientY","srcElement","target"],u={},t,i,r;if(n)for(t=0;i=f[t];t++)r=n[i],r&&(u[i]=r);return u}function ii(n){it=!1,u=n.target||n.srcElement;if(!u)return;var t=nt(u,w(n));/\d/.test(t)&&(t=t.replace(/\d/,""),u=s(u).getPreviewCell(u,t=="v")),g(i),fi(i,i.document),i.fireEvent("saveScene"),ni(t,u),d=!0,y=t,a=u}function ti(t,i){var nt,b,p,k,w,l,h;if(ft())return;yt(),it=!1;if(lt){v=++v%3,ct={x:i.clientX,y:i.clientY},bi=setTimeout(function(){v>0&&v--},ai);if(v===2){v=0,tr(i);return}}if(i.button==2)return;var o=this,f=o.selection.getRange(),l=n.findParentByTagName(f.startContainer,"table",!0),h=n.findParentByTagName(f.endContainer,"table",!0);(l||h)&&(l===h?(l=n.findParentByTagName(f.startContainer,["td","th","caption"],!0),h=n.findParentByTagName(f.endContainer,["td","th","caption"],!0),l!==h&&o.selection.clearRange()):o.selection.clearRange()),d=!1,o.document.body.style.webkitUserSelect="";if(y&&a){o.selection.getNative()[r.ie9below?"empty":"removeAllRanges"](),v=0,c=o.document.getElementById("ue_tableDragLine");if(c){nt=n.getXY(a),b=n.getXY(c);switch(y){case"h":pi(a,b.x-nt.x);break;case"v":vi(a,b.y-nt.y-a.offsetHeight)}y="",a=null,g(o),o.fireEvent("saveScene");return}}if(u)k=s(u),w=k?k.selectedTds[0]:null,w?(f=new e.Range(o.document),n.isEmptyBlock(w)?f.setStart(w,0).setCursor(!1,!0):f.selectNodeContents(w).shrinkBoundary().setCursor(!1,!0)):(f=o.selection.getRange().shrinkBoundary(),f.collapsed||(l=n.findParentByTagName(f.startContainer,["td","th"],!0),h=n.findParentByTagName(f.endContainer,["td","th"],!0),(l&&!h||!l&&h||l&&h&&l!==h)&&f.setCursor(!1,!0))),u=null,o.removeListener("mouseover",ri);else{p=n.findParentByTagName(i.target||i.srcElement,"td",!0),p||(p=n.findParentByTagName(i.target||i.srcElement,"th",!0));if(p&&(p.tagName=="TD"||p.tagName=="TH")){if(o.fireEvent("excludetable",p)===!0)return;f=new e.Range(o.document),f.setStart(p,0).setCursor(!1,!0)}}o._selectionChange(250,i)}function ri(t,i){var e,o,f,h;if(ft())return;e=this,o=i.target||i.srcElement,p=n.findParentByTagName(o,"td",!0)||n.findParentByTagName(o,"th",!0),u&&p&&(u.tagName=="TD"&&p.tagName=="TD"||u.tagName=="TH"&&p.tagName=="TH")&&n.findParentByTagName(u,"table")==n.findParentByTagName(p,"table")&&(f=s(p),u!=p?(e.document.body.style.webkitUserSelect="none",e.selection.getNative()[r.ie9below?"empty":"removeAllRanges"](),h=f.getCellsRange(u,p),f.setSelected(h)):(e.document.body.style.webkitUserSelect="",f.clearSelected())),i.preventDefault?i.preventDefault():i.returnValue=!1}function hr(t,i,r){var f=parseInt(n.getComputedStyle(t,"line-height"),10),u=r+i;i=u<f?f:u,t.style.height&&(t.style.height=""),t.rowSpan==1?t.setAttribute("height",i):t.removeAttribute&&t.removeAttribute("height")}function pi(n,i){var f=s(n),r,u,e;f&&(r=f.table,u=ui(n,r),r.style.width="",r.removeAttribute("width"),i=gi(i,n,u),n.nextSibling?(e=0,t.each(u,function(n){n.left.width=+n.left.width+i,n.right&&(n.right.width=+n.right.width-i)})):t.each(u,function(n){n.left.width-=-i}))}function ft(){return i.body.contentEditable==="false"}function vi(n,t){var r,i,e,f,u;if(Math.abs(t)<10)return;r=s(n);if(r)for(i=r.getSameEndPosCells(n,"y"),e=i[0]?i[0].offsetHeight:0,f=0;u=i[f++];)hr(u,t,e)}function ui(i,r,u){var e;r||(r=n.findParentByTagName(i,"table"));if(!r)return null;var h=n.getNodeIndex(i),f=i,s=r.rows,o=0;while(f)f.nodeType===1&&(o+=f.colSpan||1),f=f.previousSibling;return f=null,e=[],t.each(s,function(n){var r=n.cells,i=0;t.each(r,function(n){return i+=n.colSpan||1,i===o?(e.push({left:n,right:n.nextSibling||null}),!1):i>o?(u&&e.push({left:n}),!1):void 0})}),e}function gi(n,i,r){n-=rt();if(n<0)return 0;n-=gt(i);var u=n<0?"left":"right";return n=Math.abs(n),t.each(r,function(t){var i=t[u];i&&(n=Math.min(n,gt(i)-bt))}),n=n<0?0:n,u==="left"?-n:n}function gt(n){var t=0,r=0,t=n.offsetWidth-rt();n.nextSibling||(t-=wi(n)),t=t<0?0:t;try{n.width=t}catch(i){}return t}function wi(t){tab=n.findParentByTagName(t,"table",!1);if(tab.offsetVal===undefined){var i=t.previousSibling;tab.offsetVal=i?t.offsetWidth-i.offsetWidth===h.borderWidth?h.borderWidth:0:0}return tab.offsetVal}function rt(){var e;if(h.tabcellSpace===undefined){var o=null,t=i.document.createElement("table"),f=i.document.createElement("tbody"),r=i.document.createElement("tr"),n=i.document.createElement("td"),u=null;n.style.cssText="border: 0;",n.width=1,r.appendChild(n),r.appendChild(u=n.cloneNode(!1)),f.appendChild(r),t.appendChild(f),t.style.cssText="visibility: hidden;",i.body.appendChild(t),h.paddingSpace=n.offsetWidth-1,e=t.offsetWidth,n.style.cssText="",u.style.cssText="",h.borderWidth=(t.offsetWidth-e)/3,h.tabcellSpace=h.paddingSpace+h.borderWidth,i.body.removeChild(t)}return rt=function(){return h.tabcellSpace},h.tabcellSpace}function fi(t){if(d)return;c=t.document.createElement("div"),n.setAttributes(c,{id:"ue_tableDragLine",unselectable:"on",contenteditable:!1,onresizestart:"return false",ondragstart:"return false",onselectstart:"return false",style:"background-color:blue;position:absolute;padding:0;margin:0;background-image:none;border:0px none;opacity:0;filter:alpha(opacity=0)"}),t.body.appendChild(c)}function g(t){if(d)return;var i;while(i=t.document.getElementById("ue_tableDragLine"))n.remove(i)}function ni(t,i){if(!i)return;var f=n.findParentByTagName(i,"table"),u=f.getElementsByTagName("caption"),s=f.offsetWidth,h=f.offsetHeight-(u.length>0?u[0].offsetHeight:0),o=n.getXY(f),e=n.getXY(i),r;switch(t){case"h":r="height:"+h+"px;top:"+(o.y+(u.length>0?u[0].offsetHeight:0))+"px;left:"+(e.x+i.offsetWidth),c.style.cssText=r+"px;position: absolute;display:block;background-color:blue;width:1px;border:0; color:blue;opacity:.3;filter:alpha(opacity=30)";break;case"v":r="width:"+s+"px;left:"+o.x+"px;top:"+(e.y+i.offsetHeight),c.style.cssText=r+"px;overflow:hidden;position: absolute;display:block;background-color:blue;height:1px;border:0;color:blue;opacity:.2;filter:alpha(opacity=20)"}}function at(t,i){for(var o=n.getElementsByTagName(t.body,"table"),f,r,u,e=0;r=o[e++];)u=n.getElementsByTagName(r,"td"),u[0]&&(i?(f=u[0].style.borderColor.replace(/\s/g,""),/(#ffffff)|(rgb\(255,255,255\))/ig.test(f)&&n.addClass(r,"noBorderTable")):n.removeClasses(r,"noBorderTable"))}function ki(t,i,r){var u=t.body;return u.offsetWidth-(i?parseInt(n.getComputedStyle(u,"margin-left"),10)*2:0)-r.tableBorder*2-(t.options.offsetWidth||0)}function si(t,i){var r=n.findParentByTagName(i.target||i.srcElement,["td","th"],!0),o=null,e,u,f;if(!r)return null;return o=nt(r,w(i)),r?(o==="h1"&&r.previousSibling?(u=n.getXY(r),e=r.offsetWidth,Math.abs(u.x+e-i.clientX)>e/3&&(r=r.previousSibling)):o==="v1"&&r.parentNode.previousSibling&&(u=n.getXY(r),f=r.offsetHeight,Math.abs(u.y+f-i.clientY)>f/3&&(r=r.parentNode.previousSibling.firstChild)),r&&!(t.fireEvent("excludetable",r)===!0)?r:null):null}var i=this,vt=null,et=null,bi=null,bt=5,it=!1,k=5,li=10,v=0,ct=null,ai=360,h=UE.UETable,s=function(n){return h.getUETable(n)},l=function(n){return h.getUETableBySelected(n)},kt=function(n,t){return h.getDefaultValue(n,t)},st=function(n){return h.removeSelectedClass(n)},oi,yi;i.ready(function(){var n=this,i=n.selection.getText;n.selection.getText=function(){var f=l(n),u;return f?(u="",t.each(f.selectedTds,function(n){u+=n[r.ie?"innerText":"textContent"]}),u):i.call(n.selection)}});var u=null,p=null,y="",lt=!1,o=null,ot=!1,c=null,a=null,d=!1,dt=!0;i.setOpt({maxColNum:20,maxRowNum:100,defaultCols:5,defaultRows:5,tdvalign:"top",cursorpath:i.options.UEDITOR_HOME_URL+"themes/default/images/cursor_",tableDragable:!1,classList:["ue-table-interlace-color-single","ue-table-interlace-color-double"]}),i.getUETable=s,oi={deletetable:1,inserttable:1,cellvalign:1,insertcaption:1,deletecaption:1,inserttitle:1,deletetitle:1,mergeright:1,mergedown:1,mergecells:1,insertrow:1,insertrownext:1,deleterow:1,insertcol:1,insertcolnext:1,deletecol:1,splittocells:1,splittorows:1,splittocols:1,adaptbytext:1,adaptbywindow:1,adaptbycustomer:1,insertparagraph:1,insertparagraphbeforetable:1,averagedistributecol:1,averagedistributerow:1},i.ready(function(){var u,a,v,y,f,c;t.cssRule("table",".selectTdClass{background-color:#edf5fa !important}table.noBorderTable td,table.noBorderTable th,table.noBorderTable caption{border:1px dashed #ddd !important}table{margin-bottom:10px;border-collapse:collapse;display:table;}td,th{padding: 5px 10px;border: 1px solid #DDD;}caption{border:1px dashed #DDD;border-bottom:0;padding:3px;text-align:center;}th{border-top:1px solid #BBB;background-color:#F7F7F7;}table tr.firstRow th{border-top-width:2px;}.ue-table-interlace-color-single{ background-color: #fcfcfc; } .ue-table-interlace-color-double{ background-color: #f7faff; }td p{margin:0;padding:0;}",i.document),i.addListener("keydown",function(t,i){var r=this,b=i.keyCode||i.which,w,s,o,e,y,f,p,h,c;b==8&&(f=l(r),f&&f.selectedTds.length&&(f.isFullCol()?r.execCommand("deletecol"):f.isFullRow()?r.execCommand("deleterow"):r.fireEvent("delcells"),n.preventDefault(i)),o=n.findParentByTagName(r.selection.getStart(),"caption",!0),w=r.selection.getRange(),w.collapsed&&o&&ht(o)&&(r.fireEvent("saveScene"),e=o.parentNode,n.remove(o),e&&w.setStart(e.rows[0].cells[0],0).setCursor(!1,!0),r.fireEvent("saveScene")));if(b==46){f=l(r);if(f){for(r.fireEvent("saveScene"),h=0;c=f.selectedTds[h++];)n.fillNode(r.document,c);r.fireEvent("saveScene"),n.preventDefault(i)}}if(b==13){s=r.selection.getRange(),o=n.findParentByTagName(s.startContainer,"caption",!0);if(o){e=n.findParentByTagName(o,"table"),s.collapsed?o&&s.setStart(e.rows[0].cells[0],0).setCursor(!1,!0):(s.deleteContents(),r.fireEvent("saveScene")),n.preventDefault(i);return}if(s.collapsed){e=n.findParentByTagName(s.startContainer,"table");if(e){var g=e.rows[0].cells[0],d=n.findParentByTagName(r.selection.getStart(),["td","th"],!0),k=e.previousSibling;g===d&&(!k||k.nodeType==1&&k.tagName=="TABLE")&&n.isStartInblock(s)&&(y=n.findParent(r.selection.getStart(),function(t){return n.isBlockElm(t)},!0),y&&(/t(h|d)/i.test(y.tagName)||y===d.firstChild)&&(r.execCommand("insertparagraphbeforetable"),n.preventDefault(i)))}}}if((i.ctrlKey||i.metaKey)&&i.keyCode=="67"){u=null,f=l(r);if(f)for(p=f.selectedTds,a=f.isFullCol(),v=f.isFullRow(),u=[[f.cloneCell(p[0],null,!0)]],h=1;c=p[h];h++)c.parentNode!==p[h-1].parentNode?u.push([f.cloneCell(c,null,!0)]):u[u.length-1].push(f.cloneCell(c,null,!0))}}),i.addListener("tablehasdeleted",function(){b(this,!1,"",null),o&&n.remove(o)}),i.addListener("beforepaste",function(i,f){var y=this,ft=y.selection.getRange(),tt,c,rt,st,w,et,g,ut,d,it,b,p,nt,o,e,lt,ct,k,ot;if(n.findParentByTagName(ft.startContainer,"caption",!0)){k=y.document.createElement("div"),k.innerHTML=f.html,f.html=k[r.ie9below?"innerText":"textContent"];return}tt=l(y);if(u){y.fireEvent("saveScene"),ft=y.selection.getRange(),c=n.findParentByTagName(ft.startContainer,["td","th"],!0);if(c){w=s(c);if(v)for(et=w.getCellInfo(c).rowIndex,c.tagName=="TH"&&et++,b=0;p=u[b++];){for(nt=w.insertRow(et++,"td"),o=0;e=p[o];o++)g=nt.cells[o],g||(g=nt.insertCell(o)),g.innerHTML=e.innerHTML,e.getAttribute("width")&&g.setAttribute("width",e.getAttribute("width")),e.getAttribute("vAlign")&&g.setAttribute("vAlign",e.getAttribute("vAlign")),e.getAttribute("align")&&g.setAttribute("align",e.getAttribute("align")),e.style.cssText&&(g.style.cssText=e.style.cssText);for(o=0;e=nt.cells[o];o++){if(!p[o])break;e.innerHTML=p[o].innerHTML,p[o].getAttribute("width")&&e.setAttribute("width",p[o].getAttribute("width")),p[o].getAttribute("vAlign")&&e.setAttribute("vAlign",p[o].getAttribute("vAlign")),p[o].getAttribute("align")&&e.setAttribute("align",p[o].getAttribute("align")),p[o].style.cssText&&(e.style.cssText=p[o].style.cssText)}}else{if(a){for(it=w.getCellInfo(c),ut=0,o=0,p=u[0];e=p[o++];)ut+=e.colSpan||1;for(y.__hasEnterExecCommand=!0,b=0;b<ut;b++)y.execCommand("insertcol");y.__hasEnterExecCommand=!1,c=w.table.rows[0].cells[it.cellIndex],c.tagName=="TH"&&(c=w.table.rows[1].cells[it.cellIndex])}for(b=0;p=u[b++];){for(rt=c,o=0;e=p[o++];)c?(c.innerHTML=e.innerHTML,e.getAttribute("width")&&c.setAttribute("width",e.getAttribute("width")),e.getAttribute("vAlign")&&c.setAttribute("vAlign",e.getAttribute("vAlign")),e.getAttribute("align")&&c.setAttribute("align",e.getAttribute("align")),e.style.cssText&&(c.style.cssText=e.style.cssText),st=c,c=c.nextSibling):(d=e.cloneNode(!0),n.removeAttributes(d,["class","rowSpan","colSpan"]),st.parentNode.appendChild(d));c=w.getNextCell(rt,!0,!0);if(!u[b])break;c||(it=w.getCellInfo(rt),w.table.insertRow(w.table.rows.length),w.update(),c=w.getVSideCell(rt,!0))}}w.update()}else{for(tt=y.document.createElement("table"),b=0;p=u[b++];){for(nt=tt.insertRow(tt.rows.length),o=0;e=p[o++];)d=h.cloneCell(e,null,!0),n.removeAttributes(d,["class"]),nt.appendChild(d);o==2&&d.rowSpan>1&&(d.rowSpan=1)}lt=kt(y),ct=y.body.offsetWidth-(dt?parseInt(n.getComputedStyle(y.body,"margin-left"),10)*2:0)-lt.tableBorder*2-(y.options.offsetWidth||0),y.execCommand("insertHTML","<table  "+(a&&v?'width="'+ct+'"':"")+">"+tt.innerHTML.replace(/>\s*</g,"><").replace(/\bth\b/gi,"td")+"</table>")}return y.fireEvent("contentchange"),y.fireEvent("saveScene"),f.html="",!0}k=y.document.createElement("div"),k.innerHTML=f.html,ot=k.getElementsByTagName("table"),n.findParentByTagName(y.selection.getStart(),"table")?(t.each(ot,function(t){n.remove(t)}),n.findParentByTagName(y.selection.getStart(),"caption",!0)&&(k.innerHTML=k[r.ie?"innerText":"textContent"])):t.each(ot,function(i){ei(i,!0),n.removeAttributes(i,["style","border"]),t.each(n.getElementsByTagName(i,"td"),function(t){ht(t)&&n.fillNode(y.document,t),ei(t,!0)})}),f.html=k.innerHTML}),i.addListener("afterpaste",function(){t.each(n.getElementsByTagName(i.body,"table"),function(t){if(t.offsetWidth>i.body.offsetWidth){var r=kt(i,t);t.style.width=i.body.offsetWidth-(dt?parseInt(n.getComputedStyle(i.body,"margin-left"),10)*2:0)-r.tableBorder*2-(i.options.offsetWidth||0)+"px"}})}),i.addListener("blur",function(){u=null}),i.addListener("keydown",function(){clearTimeout(y),y=setTimeout(function(){var u=i.selection.getRange(),r=n.findParentByTagName(u.startContainer,["th","td"],!0),t;r&&(t=r.parentNode.parentNode.parentNode,t.offsetWidth>t.getAttribute("width")&&(r.style.wordBreak="break-all"))},100)}),i.addListener("selectionchange",function(){b(i,!1,"",null)}),i.addListener("contentchange",function(){var i=this,u,r;g(i);if(l(i))return;u=i.selection.getRange(),r=u.startContainer,r=n.findParentByTagName(r,["td","th"],!0),t.each(n.getElementsByTagName(i.document,"table"),function(n){if(i.fireEvent("excludetable",n)===!0)return;n.ueTable=new h(n),n.onmouseover=function(){i.fireEvent("tablemouseover",n)},n.onmousemove=function(){i.fireEvent("tablemousemove",n),i.options.tableDragable&&hi(!0,this,i),t.defer(function(){i.fireEvent("contentchange",50)},!0)},n.onmouseout=function(){i.fireEvent("tablemouseout",n),b(i,!1,"",null),g(i)},n.onclick=function(n){var r,e,o;n=i.window.event||n,r=pt(n.target||n.srcElement);if(!r)return;var t=s(r),c=t.table,h=t.getCellInfo(r),f,u=i.selection.getRange();if(tt(c,r,n,!0)){e=t.getCell(t.indexTable[t.rowsNum-1][h.colIndex].rowIndex,t.indexTable[t.rowsNum-1][h.colIndex].cellIndex),n.shiftKey&&t.selectedTds.length?t.selectedTds[0]!==e?(f=t.getCellsRange(t.selectedTds[0],e),t.setSelected(f)):u&&u.selectNodeContents(e).select():r!==e?(f=t.getCellsRange(r,e),t.setSelected(f)):u&&u.selectNodeContents(e).select();return}tt(c,r,n)&&(o=t.getCell(t.indexTable[h.rowIndex][t.colsNum-1].rowIndex,t.indexTable[h.rowIndex][t.colsNum-1].cellIndex),n.shiftKey&&t.selectedTds.length?t.selectedTds[0]!==o?(f=t.getCellsRange(t.selectedTds[0],o),t.setSelected(f)):u&&u.selectNodeContents(o).select():r!==o?(f=t.getCellsRange(r,o),t.setSelected(f)):u&&u.selectNodeContents(o).select())}}),at(i,!0)});n.on(i.document,"mousemove",di);n.on(i.document,"mouseout",function(n){var t=n.target||n.srcElement;t.tagName=="TABLE"&&b(i,!1,"",null)});i.addListener("interlacetable",function(n,t,i){var r;if(!t)return;var f=this,u=t.rows,o=u.length,e=function(n,t,i){return n[t]?n[t]:i?n[t%n.length]:""};for(r=0;r<o;r++)u[r].className=e(i||f.options.classList,r,!0)}),i.addListener("uninterlacetable",function(t,i){var r;if(!i)return;var f=this,u=i.rows,o=f.options.classList,e=u.length;for(r=0;r<e;r++)n.removeClasses(u[r],o)}),i.addListener("mousedown",er),i.addListener("mouseup",ti);n.on(i.body,"dragstart",function(n){ti.call(i,"dragstart",n)});i.addOutputRule(function(n){t.each(n.getNodesByTagName("div"),function(n){n.getAttr("id")=="ue_tableDragLine"&&n.parentNode.removeChild(n)})}),f=0,i.addListener("mousedown",function(){f=0}),i.addListener("tabkeydown",function(){var r=this.selection.getRange(),o=r.getCommonAncestor(!0,!0),e=n.findParentByTagName(o,"table"),t,h,u;if(e)return n.findParentByTagName(o,"caption",!0)?(t=n.getElementsByTagName(e,"th td"),t&&t.length&&r.setStart(t[0],0).setCursor(!1,!0)):(t=n.findParentByTagName(o,["td","th"],!0),h=s(t),f=t.rowSpan>1?f:h.getCellInfo(t).rowIndex,u=h.getTabNextCell(t,f),u?ht(u)?r.setStart(u,0).setCursor(!1,!0):r.selectNodeContents(u).select():(i.fireEvent("saveScene"),i.__hasEnterExecCommand=!0,this.execCommand("insertrownext"),i.__hasEnterExecCommand=!1,r=this.selection.getRange(),r.setStart(e.rows[e.rows.length-1].cells[0],0).setCursor(),i.fireEvent("saveScene"))),!0}),r.ie&&i.addListener("selectionchange",function(){b(this,!1,"",null)}),i.addListener("keydown",function(t,i){var f=this,e=i.keyCode||i.which,r,u;if(e==8||e==46)return;r=!i.ctrlKey&&!i.metaKey&&!i.shiftKey&&!i.altKey,r&&st(n.getElementsByTagName(f.body,"td")),u=l(f);if(!u)return;r&&u.clearSelected()}),i.addListener("beforegetcontent",function(){at(this,!1),r.ie&&t.each(this.document.getElementsByTagName("caption"),function(t){n.isEmptyNode(t)&&(t.innerHTML="&nbsp;")})}),i.addListener("aftergetcontent",function(){at(this,!0)}),i.addListener("getAllHtml",function(){st(i.document.getElementsByTagName("td"))}),i.addListener("fullscreenchanged",function(r,u){if(!u){var e=this.body.offsetWidth/document.body.offsetWidth,f=n.getElementsByTagName(this.body,"table");t.each(f,function(r){var o,f,u,s;if(r.offsetWidth<i.body.offsetWidth)return!1;for(o=n.getElementsByTagName(r,"td"),f=[],t.each(o,function(n){f.push(n.offsetWidth)}),u=0;s=o[u];u++)s.setAttribute("width",Math.floor(f[u]*e));r.setAttribute("width",Math.floor(ki(i,dt,kt(i))))})}}),c=i.execCommand,i.execCommand=function(t){var r=this,k=arguments,a,s,b,h,o,u;t=t.toLowerCase();var w=l(r),v,y=new e.Range(r.document),p=r.commands[t]||UE.commands[t],f;if(!p)return;if(w&&!oi[t]&&!p.notNeedUndo&&!r.__hasEnterExecCommand){for(r.__hasEnterExecCommand=!0,r.fireEvent("beforeexeccommand",t),v=w.selectedTds,a=-2,s=-2,o=0;u=v[o];o++)ht(u)?y.setStart(u,0).setCursor(!1,!0):y.selectNode(u).select(!0),h=r.queryCommandState(t),b=r.queryCommandValue(t),h!=-1&&((a!==h||s!==b)&&(r._ignoreContentChange=!0,f=c.apply(r,arguments),r._ignoreContentChange=!1),a=r.queryCommandState(t),s=r.queryCommandValue(t),n.isEmptyBlock(u)&&n.fillNode(r.document,u));y.setStart(v[0],0).shrinkBoundary(!0).setCursor(!1,!0),r.fireEvent("contentchange"),r.fireEvent("afterexeccommand",t),r.__hasEnterExecCommand=!1,r._selectionChange()}else f=c.apply(r,arguments);return f}})},UE.UETable.prototype.sortTable=function(n,i){var c=this.table,s=c.rows,f=[],p=s[0].cells[0].tagName==="TH",y=0,e,u,h,l,a,o,v;if(this.selectedTds.length){for(e=this.cellsRange,o=e.endRowIndex+1,u=e.beginRowIndex;u<o;u++)f[u]=s[u];f.splice(0,e.beginRowIndex),y=e.endRowIndex+1===this.rowsNum?0:e.endRowIndex+1}else for(u=0,o=s.length;u<o;u++)f[u]=s[u];for(h={reversecurrent:function(){return 1},orderbyasc:function(n,t){var r=n.innerText||n.textContent,i=t.innerText||t.textContent;return r.localeCompare(i)},reversebyasc:function(n,t){var r=n.innerHTML,i=t.innerHTML;return i.localeCompare(r)},orderbynum:function(n,t){var u=n[r.ie?"innerText":"textContent"].match(/\d+/),i=t[r.ie?"innerText":"textContent"].match(/\d+/);return u&&(u=+u[0]),i&&(i=+i[0]),(u||0)-(i||0)},reversebynum:function(n,t){var u=n[r.ie?"innerText":"textContent"].match(/\d+/),i=t[r.ie?"innerText":"textContent"].match(/\d+/);return u&&(u=+u[0]),i&&(i=+i[0]),(i||0)-(u||0)}},c.setAttribute("data-sort-type",i&&typeof i=="string"&&h[i]?i:""),p&&f.splice(0,1),f=t.sort(f,function(t,r){var u;return u=i&&typeof i=="function"?i.call(this,t.cells[n],r.cells[n]):i&&typeof i=="number"?1:i&&typeof i=="string"&&h[i]?h[i].call(this,t.cells[n],r.cells[n]):h.orderbyasc.call(this,t.cells[n],r.cells[n])}),l=c.ownerDocument.createDocumentFragment(),a=0,o=f.length;a<o;a++)l.appendChild(f[a]);v=c.getElementsByTagName("tbody")[0],y?v.insertBefore(l,s[y-e.endRowIndex+e.beginRowIndex-1]):v.appendChild(l)},UE.plugins.tablesort=function(){var i=this,u=UE.UETable,f=function(n){return u.getUETable(n)},r=function(n){return u.getTableItemsByRange(n)};i.ready(function(){t.cssRule("tablesort","table.sortEnabled tr.firstRow th,table.sortEnabled tr.firstRow td{padding-right:20px;background-repeat: no-repeat;background-position: center right;   background-image:url("+i.options.themePath+i.options.theme+"/images/sortable.png);}",i.document),i.addListener("afterexeccommand",function(n,t){(t=="mergeright"||t=="mergedown"||t=="mergecells")&&this.execCommand("disablesort")})}),UE.commands.sorttable={queryCommandState:function(){var e=this,u=r(e),f,t,i,n;if(!u.cell)return-1;for(f=u.table,t=f.getElementsByTagName("td"),i=0;n=t[i++];)if(n.rowSpan!=1||n.colSpan!=1)return-1;return 0},execCommand:function(n,t){var o=this,i=o.selection.getRange(),h=i.createBookmark(!0),u=r(o),c=u.cell,e=f(u.table),s=e.getCellInfo(c);e.sortTable(s.cellIndex,t),i.moveToBookmark(h);try{i.select()}catch(l){}}},UE.commands.enablesort=UE.commands.disablesort={queryCommandState:function(t){var u=r(this).table,f,i;if(u&&t=="enablesort")for(f=n.getElementsByTagName(u,"th td"),i=0;i<f.length;i++)if(f[i].getAttribute("colspan")>1||f[i].getAttribute("rowspan")>1)return-1;return u?t=="enablesort"^u.getAttribute("data-sort")!="sortEnabled"?-1:0:-1},execCommand:function(t){var i=r(this).table;i.setAttribute("data-sort",t=="enablesort"?"sortEnabled":"sortDisabled"),t=="enablesort"?n.addClass(i,"sortEnabled"):n.removeClasses(i,"sortEnabled")}}},UE.plugins.contextmenu=function(){var i=this,t,u,f,o;i.setOpt("enableContextMenu",!0);if(i.getOpt("enableContextMenu")===!1)return;t=i.getLang("contextMenu"),f=i.options.contextMenu||[{label:t.selectall,cmdName:"selectall"},{label:t.cleardoc,cmdName:"cleardoc",exec:function(){confirm(t.confirmclear)&&this.execCommand("cleardoc")}},"-",{label:t.unlink,cmdName:"unlink"},"-",{group:t.paragraph,icon:"justifyjustify",subMenu:[{label:t.justifyleft,cmdName:"justify",value:"left"},{label:t.justifyright,cmdName:"justify",value:"right"},{label:t.justifycenter,cmdName:"justify",value:"center"},{label:t.justifyjustify,cmdName:"justify",value:"justify"}]},"-",{group:t.table,icon:"table",subMenu:[{label:t.inserttable,cmdName:"inserttable"},{label:t.deletetable,cmdName:"deletetable"},"-",{label:t.deleterow,cmdName:"deleterow"},{label:t.deletecol,cmdName:"deletecol"},{label:t.insertcol,cmdName:"insertcol"},{label:t.insertcolnext,cmdName:"insertcolnext"},{label:t.insertrow,cmdName:"insertrow"},{label:t.insertrownext,cmdName:"insertrownext"},"-",{label:t.insertcaption,cmdName:"insertcaption"},{label:t.deletecaption,cmdName:"deletecaption"},{label:t.inserttitle,cmdName:"inserttitle"},{label:t.deletetitle,cmdName:"deletetitle"},{label:t.inserttitlecol,cmdName:"inserttitlecol"},{label:t.deletetitlecol,cmdName:"deletetitlecol"},"-",{label:t.mergecells,cmdName:"mergecells"},{label:t.mergeright,cmdName:"mergeright"},{label:t.mergedown,cmdName:"mergedown"},"-",{label:t.splittorows,cmdName:"splittorows"},{label:t.splittocols,cmdName:"splittocols"},{label:t.splittocells,cmdName:"splittocells"},"-",{label:t.averageDiseRow,cmdName:"averagedistributerow"},{label:t.averageDisCol,cmdName:"averagedistributecol"},"-",{label:t.edittd,cmdName:"edittd",exec:function(){UE.ui.edittd&&new UE.ui.edittd(this),this.getDialog("edittd").open()}},{label:t.edittable,cmdName:"edittable",exec:function(){UE.ui.edittable&&new UE.ui.edittable(this),this.getDialog("edittable").open()}},{label:t.setbordervisible,cmdName:"setbordervisible"}]},{group:t.tablesort,icon:"tablesort",subMenu:[{label:t.enablesort,cmdName:"enablesort"},{label:t.disablesort,cmdName:"disablesort"},"-",{label:t.reversecurrent,cmdName:"sorttable",value:"reversecurrent"},{label:t.orderbyasc,cmdName:"sorttable",value:"orderbyasc"},{label:t.reversebyasc,cmdName:"sorttable",value:"reversebyasc"},{label:t.orderbynum,cmdName:"sorttable",value:"orderbynum"},{label:t.reversebynum,cmdName:"sorttable",value:"reversebynum"}]},{group:t.borderbk,icon:"borderBack",subMenu:[{label:t.setcolor,cmdName:"interlacetable",exec:function(){this.execCommand("interlacetable")}},{label:t.unsetcolor,cmdName:"uninterlacetable",exec:function(){this.execCommand("uninterlacetable")}},{label:t.setbackground,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["#bbb","#ccc"]})}},{label:t.unsetbackground,cmdName:"cleartablebackground",exec:function(){this.execCommand("cleartablebackground")}},{label:t.redandblue,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["red","blue"]})}},{label:t.threecolorgradient,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["#aaa","#bbb","#ccc"]})}}]},{group:t.aligntd,icon:"aligntd",subMenu:[{cmdName:"cellalignment",value:{align:"left",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"bottom"}}]},{group:t.aligntable,icon:"aligntable",subMenu:[{cmdName:"tablealignment",className:"left",label:t.tableleft,value:"left"},{cmdName:"tablealignment",className:"center",label:t.tablecenter,value:"center"},{cmdName:"tablealignment",className:"right",label:t.tableright,value:"right"}]},"-",{label:t.insertparagraphbefore,cmdName:"insertparagraph",value:!0},{label:t.insertparagraphafter,cmdName:"insertparagraph"},{label:t.copy,cmdName:"copy"},{label:t.paste,cmdName:"paste"}];if(!f.length)return;o=UE.ui.uiUtils,i.addListener("contextmenu",function(s,h){var w=o.getViewportOffsetByEvent(h),a,p,c,l,v,y;for(i.fireEvent("beforeselectionchange"),u&&u.destroy(),a=0,c=[];p=f[a];a++)(function(n){if(n=="-")(l=c[c.length-1])&&l!=="-"&&c.push("-");else if(n.hasOwnProperty("group")){for(var f=0,u,r=[];u=n.subMenu[f];f++)(function(n){n=="-"?(l=r[r.length-1])&&l!=="-"?r.push("-"):r.splice(r.length-1):(i.commands[n.cmdName]||UE.commands[n.cmdName]||n.query)&&(n.query?n.query():i.queryCommandState(n.cmdName))>-1&&r.push({label:n.label||i.getLang("contextMenu."+n.cmdName+(n.value||""))||"",className:"edui-for-"+n.cmdName+(n.className?" edui-for-"+n.cmdName+"-"+n.className:""),onclick:n.exec?function(){n.exec.call(i)}:function(){i.execCommand(n.cmdName,n.value)}})})(u);if(r.length){function e(){switch(n.icon){case"table":return i.getLang("contextMenu.table");case"justifyjustify":return i.getLang("contextMenu.paragraph");case"aligntd":return i.getLang("contextMenu.aligntd");case"aligntable":return i.getLang("contextMenu.aligntable");case"tablesort":return t.tablesort;case"borderBack":return t.borderbk;default:return""}}c.push({label:e(),className:"edui-for-"+n.icon,subMenu:{items:r,editor:i}})}}else(i.commands[n.cmdName]||UE.commands[n.cmdName]||n.query)&&(n.query?n.query.call(i):i.queryCommandState(n.cmdName))>-1&&c.push({label:n.label||i.getLang("contextMenu."+n.cmdName),className:"edui-for-"+(n.icon?n.icon:n.cmdName+(n.value||"")),onclick:n.exec?function(){n.exec.call(i)}:function(){i.execCommand(n.cmdName,n.value)}})})(p);c[c.length-1]=="-"&&c.pop(),u=new UE.ui.Menu({items:c,className:"edui-contextmenu",editor:i}),u.render(),u.showAt(w),i.fireEvent("aftershowcontextmenu",u),n.preventDefault(h);if(r.ie){try{v=i.selection.getNative().createRange()}catch(b){return}v.item&&(y=new e.Range(i.document),y.selectNode(v.item(0)).select(!0,!0))}}),i.addListener("aftershowcontextmenu",function(n,t){var r,u;if(i.zeroclipboard){r=t.items;for(u in r)r[u].className=="edui-for-copy"&&i.zeroclipboard.clip(r[u].getDom())}})},UE.plugins.shortcutmenu=function(){var i=this,t,f=i.options.shortcutMenu||[];if(!f.length)return;i.addListener("contextmenu mouseup",function(i,o){var s=this,l={type:i,target:o.target||o.srcElement,screenX:o.screenX,screenY:o.screenY,clientX:o.clientX,clientY:o.clientY},h,c;setTimeout(function(){var n=s.selection.getRange();(n.collapsed===!1||i=="contextmenu")&&(t||(t=new u.editor.ui.ShortCutMenu({editor:s,items:f,theme:s.options.theme,className:"edui-shortcutmenu"}),t.render(),s.fireEvent("afterrendershortcutmenu",t)),t.show(l,!!UE.plugins.contextmenu))});if(i=="contextmenu"){n.preventDefault(o);if(r.ie9below){try{h=s.selection.getNative().createRange()}catch(o){return}h.item&&(c=new e.Range(s.document),c.selectNode(h.item(0)).select(!0,!0))}}}),i.addListener("keydown",function(n){n=="keydown"&&t&&!t.isHidden&&t.hide()})},UE.plugins.basestyle=function(){var u={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},f=function(t,i){return n.filterNodeList(t.selection.getStartElementPath(),i)},i=this,r;i.addshortcutkey({Bold:"ctrl+66",Italic:"ctrl+73",Underline:"ctrl+85"}),i.addInputRule(function(n){t.each(n.getNodesByTagName("b i"),function(n){switch(n.tagName){case"b":n.tagName="strong";break;case"i":n.tagName="em"}})});for(r in u)(function(t,r){i.commands[t]={execCommand:function(t){var u=i.selection.getRange(),o=f(this,r),e,s;u.collapsed?(o?(e=i.document.createTextNode(""),u.insertNode(e).removeInlineStyle(r),u.setStartBefore(e),n.remove(e)):(s=u.document.createElement(r[0]),(t=="superscript"||t=="subscript")&&(e=i.document.createTextNode(""),u.insertNode(e).removeInlineStyle(["sub","sup"]).setStartBefore(e).collapse(!0)),u.insertNode(s).setStart(s,0)),u.collapse(!0)):((t=="superscript"||t=="subscript")&&(!o||o.tagName.toLowerCase()!=t)&&u.removeInlineStyle(["sub","sup"]),o?u.removeInlineStyle(r):u.applyInlineStyle(r[0])),u.select()},queryCommandState:function(){return f(this,r)?1:0}}})(r,u[r])},UE.plugins.elementpath=function(){var t,i,n=this;n.setOpt("elementPathEnabled",!0);if(!n.options.elementPathEnabled)return;n.commands.elementpath={execCommand:function(r,u){var e=i[u],f=n.selection.getRange();t=u*1,f.selectNode(e).select()},queryCommandValue:function(){var f=[].concat(this.selection.getStartElementPath()).reverse(),e=[],n,r,u;for(i=f,n=0;r=f[n];n++){if(r.nodeType==3)continue;u=r.tagName.toLowerCase(),u=="img"&&r.getAttribute("anchorname")&&(u="anchor"),e[n]=u;if(t==n){t=-1;break}}return e}}},UE.plugins.formatmatch=function(){function e(o,s){function p(n){return c&&n.selectNode(c),n.applyInlineStyle(u[u.length-1].tagName,null,u)}var a,h,l,y,c,v;r.webkit&&(a=s.target.tagName=="IMG"?s.target:null),t.undoManger&&t.undoManger.save(),h=t.selection.getRange(),l=a||h.getClosedNode(),i&&l&&l.tagName=="IMG"?(l.style.cssText+=";float:"+(i.style.cssFloat||i.style.styleFloat||"none")+";display:"+(i.style.display||"inline"),i=null):i||(y=h.collapsed,y&&(c=t.document.createTextNode("match"),h.insertNode(c).select()),t.__hasEnterExecCommand=!0,v=t.options.removeFormatAttributes,t.options.removeFormatAttributes="",t.execCommand("removeformat"),t.options.removeFormatAttributes=v,t.__hasEnterExecCommand=!1,h=t.selection.getRange(),u.length&&p(h),c&&h.setStartBefore(c).collapse(!0),h.select(),c&&n.remove(c)),t.undoManger&&t.undoManger.save(),t.removeListener("mouseup",e),f=0}var t=this,u=[],i,f=0;t.addListener("reset",function(){u=[],f=0}),t.commands.formatmatch={execCommand:function(){var s,c,o,h;if(f){f=0,u=[],t.removeListener("mouseup",e);return}s=t.selection.getRange(),i=s.getClosedNode();if(!i||i.tagName!="IMG")for(s.collapse(!0).shrinkBoundary(),c=s.startContainer,u=n.findParents(c,!0,function(t){return!n.isBlockElm(t)&&t.nodeType==1}),o=0;h=u[o];o++)if(h.tagName=="A"){u.splice(o,1);break}t.addListener("mouseup",e),f=1},queryCommandState:function(){return f},notNeedUndo:1}},UE.plugin.register("searchreplace",function(){function c(n,t,i){var u=t.searchStr,f,r;t.dir==-1&&(n=n.split("").reverse().join(""),u=u.split("").reverse().join(""),i=n.length-i),f=new RegExp(u,"g"+(t.casesensitive?"":"i"));while(r=f.exec(n))if(r.index>=i)return t.dir==-1?n.length-r.index-t.searchStr.length:r.index;return-1}function s(t,i,u){var s,f,o=u.all||u.dir==1?"getNextDomNode":"getPreDomNode",e;n.isBody(t)&&(t=t.firstChild),e=1;while(t){s=t.nodeType==3?t.nodeValue:t[r.ie?"innerText":"textContent"],f=c(s,u,i),e=0;if(f!=-1)return{node:t,index:f};t=n[o](t);while(t&&h[t.nodeName.toLowerCase()])t=n[o](t,!0);t&&(i=u.dir==-1?(t.nodeType==3?t.nodeValue:t[r.ie?"innerText":"textContent"]).length:0)}}function u(t,i,e){var h=0,o=t.firstChild,s=0,c;while(o){if(o.nodeType==3){s=o.nodeValue.replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,"").length,h+=s;if(h>=i)return{node:o,index:s-(h-i)}}else if(!f.$empty[o.tagName]){s=o[r.ie?"innerText":"textContent"].replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,"").length,h+=s;if(h>=i){c=u(o,s-(h-i),e);if(c)return c}}o=n.getNextDomNode(o)}}function e(t,i){var f=t.selection.getRange(),c,v=i.searchStr,h=t.document.createElement("span"),p,y,e,l,a;h.innerHTML="$$ueditor_searchreplace_key$$",f.shrinkBoundary(!0);if(!f.collapsed){f.select(),p=t.selection.getText();if(new RegExp("^"+i.searchStr+"$",i.casesensitive?"":"i").test(p)){if(i.replaceStr!=undefined)return o(f,i.replaceStr),f.select(),!0;f.collapse(i.dir==-1)}}f.insertNode(h),f.enlargeToBlockElm(!0),c=f.startContainer,y=c[r.ie?"innerText":"textContent"].indexOf("$$ueditor_searchreplace_key$$"),f.setStartBefore(h),n.remove(h),e=s(c,y,i);if(e)return l=u(e.node,e.index,v),a=u(e.node,e.index+v.length,v),f.setStart(l.node,l.index).setEnd(a.node,a.index),i.replaceStr!==undefined&&o(f,i.replaceStr),f.select(),!0;f.setCursor()}function o(n,t){t=i.document.createTextNode(t),n.deleteContents().insertNode(t)}var i=this,h={table:1,tbody:1,tr:1,ol:1,ul:1};return{commands:{searchreplace:{execCommand:function(n,r){var f,o,u;t.extend(r,{all:!1,casesensitive:!1,dir:1},!0),f=0;if(r.all){o=i.selection.getRange(),u=i.body.firstChild,u&&u.nodeType==1?(o.setStart(u,0),o.shrinkBoundary(!0)):u.nodeType==3&&o.setStartBefore(u),o.collapse(!0).select(!0),r.replaceStr!==undefined&&i.fireEvent("saveScene");while(e(this,r))f++;f&&i.fireEvent("saveScene")}else r.replaceStr!==undefined&&i.fireEvent("saveScene"),e(this,r)&&f++,f&&i.fireEvent("saveScene");return f},notNeedUndo:1}}}}),UE.plugins.customstyle=function(){var t=this;t.setOpt({customstyle:[{tag:"h1",name:"tc",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;"},{tag:"h1",name:"tl",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:left;margin:0 0 10px 0;"},{tag:"span",name:"im",style:"font-size:16px;font-style:italic;font-weight:bold;line-height:18px;"},{tag:"span",name:"hi",style:"font-size:16px;font-style:italic;font-weight:bold;color:rgb(51, 153, 204);line-height:18px;"}]}),t.commands.customstyle={execCommand:function(t,i){var e=this,h=i.tag,r=n.findParent(e.selection.getStart(),function(n){return n.getAttribute("label")},!0),u,o,a={},y,l,b,k,s,w,p,c,v;for(y in i)i[y]!==undefined&&(a[y]=i[y]);delete a.tag;if(r&&r.getAttribute("label")==i.label){u=this.selection.getRange(),o=u.createBookmark();if(u.collapsed)f.$block[r.tagName]?(c=e.document.createElement("p"),n.moveChild(r,c),r.parentNode.insertBefore(c,r),n.remove(r)):n.remove(r,!0);else{for(l=n.getCommonAncestor(o.start,o.end),b=n.getElementsByTagName(l,h),new RegExp(h,"i").test(l.tagName)&&b.push(l),k=0;s=b[k++];)s.getAttribute("label")==i.label&&(w=n.getPosition(s,o.start),p=n.getPosition(s,o.end),(w&n.POSITION_FOLLOWING||w&n.POSITION_CONTAINS)&&(p&n.POSITION_PRECEDING||p&n.POSITION_CONTAINS)&&f.$block[h]&&(c=e.document.createElement("p"),n.moveChild(s,c),s.parentNode.insertBefore(c,s)),n.remove(s,!0));r=n.findParent(l,function(n){return n.getAttribute("label")==i.label},!0),r&&n.remove(r,!0)}u.moveToBookmark(o).select()}else if(f.$block[h])this.execCommand("paragraph",h,a,"customstyle"),u=e.selection.getRange(),u.collapsed||(u.collapse(),r=n.findParent(e.selection.getStart(),function(n){return n.getAttribute("label")==i.label},!0),v=e.document.createElement("p"),n.insertAfter(r,v),n.fillNode(e.document,v),u.setStart(v,0).setCursor());else{u=e.selection.getRange();if(u.collapsed){r=e.document.createElement(h),n.setAttributes(r,a),u.insertNode(r).setStart(r,0).setCursor();return}o=u.createBookmark(),u.applyInlineStyle(h,a).moveToBookmark(o).select()}},queryCommandValue:function(){var t=n.filterNodeList(this.selection.getStartElementPath(),function(n){return n.getAttribute("label")});return t?t.getAttribute("label"):""}},t.addListener("keyup",function(i,r){var s=r.keyCode||r.which,o,u,e;(s==32||s==13)&&(o=t.selection.getRange(),o.collapsed&&(u=n.findParent(t.selection.getStart(),function(n){return n.getAttribute("label")},!0),u&&f.$block[u.tagName]&&n.isEmptyNode(u)&&(e=t.document.createElement("p"),n.insertAfter(u,e),n.fillNode(t.document,e),n.remove(u),o.setStart(e,0).setCursor())))})},UE.plugins.catchremoteimage=function(){var i=this,r=UE.ajax;if(i.options.catchRemoteImageEnable===!1)return;i.setOpt({catchRemoteImageEnable:!1}),i.addListener("afterpaste",function(){i.fireEvent("catchRemoteImage")}),i.addListener("catchRemoteImage",function(){function c(n,u){var o=t.serializeParam(i.queryCommandValue("serverparam"))||"",f=t.formatUrl(s+(s.indexOf("?")==-1?"?":"&")+o),h=t.isCrossDomainUrl(f),e={method:"POST",dataType:h?"jsonp":"",timeout:6e4,onsuccess:u.success,onerror:u.error};e[l]=n,r.request(f,e)}for(var y=i.getOpt("catcherLocalDomain"),s=i.getActionUrl(i.getOpt("catcherActionName")),a=i.getOpt("catcherUrlPrefix"),l=i.getOpt("catcherFieldName"),e=[],h=n.getElementsByTagName(i.document,"img"),v=function(n,t){if(n.indexOf(location.host)!=-1||/(^\.)|(^\/)/.test(n))return!0;if(t)for(var r=0,i;i=t[r++];)if(n.indexOf(i)!==-1)return!0;return!1},u,f,o=0;u=h[o++];){if(u.getAttribute("word_img"))continue;f=u.getAttribute("_src")||u.src||"",/^(https?|ftp):/i.test(f)&&(n.hasClass(u,"dzz-link-icon")?e.push(f):v(f,y)||e.push(f))}e.length&&c(e,{success:function(t){var l,c,s,u,r,e,f,o;try{l=t.state!==undefined?t:eval("("+t.responseText+")")}catch(v){return}for(o=l.list,c=0;u=h[c++];)for(e=u.getAttribute("_src")||u.src||"",s=0;r=o[s++];)if(e==r.source&&r.state=="SUCCESS"){f=a+r.url,n.setAttributes(u,{src:f,_src:f,"class":n.hasClass(u,"dzz-link-icon")?"dzz-link-icon":"dzz-image",path:"attach::"+r.attach.aid,apath:r.attach.apath,aid:r.attach.aid,ext:r.attach.filetype,dsize:r.attach.filesize});break}i.fireEvent("catchremotesuccess")},error:function(){i.fireEvent("catchremoteerror")}})})},UE.plugin.register("snapscreen",function(){function u(i){var f,u=document.createElement("a"),e=t.serializeParam(n.queryCommandValue("serverparam"))||"";return u.href=i,r.ie&&(u.href=u.href),f=u.search,e&&(f=f+(f.indexOf("?")==-1?"?":"&")+e,f=f.replace(/[&]+/ig,"&")),{port:u.port,hostname:u.hostname,path:u.pathname+f||+u.hash}}var n=this,i;return{commands:{snapscreen:{execCommand:function(){function h(t){try{t=eval("("+t+")");if(t.state=="SUCCESS"){var i=n.options;n.execCommand("insertimage",{src:i.snapscreenUrlPrefix+t.url,_src:i.snapscreenUrlPrefix+t.url,alt:t.title||"",floatStyle:i.snapscreenImgAlign,"class":"dzz-image",path:"attach::"+t.attach.aid,apath:t.attach.apath,aid:t.attach.aid,ext:t.attach.filetype,dsize:t.attach.size})}else alert(t.state)}catch(r){alert(c.callBackErrorMsg)}}var o,r,s,c=n.getLang("snapScreen_plugin"),f,e;if(!i){f=n.container,e=n.container.ownerDocument||n.container.document,i=e.createElement("object");try{i.type="application/x-pluginbaidusnap"}catch(l){return}i.style.cssText="position:absolute;left:-9999px;width:0;height:0;",i.setAttribute("width","0"),i.setAttribute("height","0"),f.appendChild(i)}o=n.getActionUrl(n.getOpt("snapscreenActionName")),r=u(o),setTimeout(function(){try{s=i.saveSnapshot(r.hostname,r.path,r.port)}catch(t){n.ui._dialogs.snapscreenDialog.open();return}h(s)},50)},queryCommandState:function(){return navigator.userAgent.indexOf("Windows",0)!=-1?0:-1}}}}}),UE.commands.insertparagraph={execCommand:function(t,i){var e=this,o=e.selection.getRange(),u=o.startContainer,r,f;while(u){if(n.isBody(u))break;r=u,u=u.parentNode}r&&(f=e.document.createElement("p"),i?r.parentNode.insertBefore(f,r):r.parentNode.insertBefore(f,r.nextSibling),n.fillNode(e.document,f),o.setStart(f,0).setCursor(!1,!0))}},UE.plugin.register("webapp",function(){function n(n,t){return t?'<iframe class="edui-faked-webapp" title="'+n.title+'" '+(n.align&&!n.cssfloat?'align="'+n.align+'"':"")+(n.cssfloat?'style="float:'+n.cssfloat+'"':"")+'width="'+n.width+'" height="'+n.height+'"  scrolling="no" frameborder="0" src="'+n.url+'" logo_url = "'+n.logo+'"></iframe>':'<img title="'+n.title+'" width="'+n.width+'" height="'+n.height+'" src="'+i.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" _logo_url="'+n.logo+'" style="background:url('+n.logo+') no-repeat center center; border:1px solid gray;" class="edui-faked-webapp" _url="'+n.url+'" '+(n.align&&!n.cssfloat?'align="'+n.align+'"':"")+(n.cssfloat?'style="float:'+n.cssfloat+'"':"")+"/>"}var i=this;return{outputRule:function(i){t.each(i.getNodesByTagName("img"),function(t){var r,i;t.getAttr("class")=="edui-faked-webapp"&&(r=n({title:t.getAttr("title"),width:t.getAttr("width"),height:t.getAttr("height"),align:t.getAttr("align"),cssfloat:t.getStyle("float"),url:t.getAttr("_url"),logo:t.getAttr("_logo_url")},!0),i=UE.uNode.createElement(r),t.parentNode.replaceChild(i,t))})},inputRule:function(i){t.each(i.getNodesByTagName("iframe"),function(t){if(t.getAttr("class")=="edui-faked-webapp"){var i=UE.uNode.createElement(n({title:t.getAttr("title"),width:t.getAttr("width"),height:t.getAttr("height"),align:t.getAttr("align"),cssfloat:t.getStyle("float"),url:t.getAttr("src"),logo:t.getAttr("logo_url")}));t.parentNode.replaceChild(i,t)}})},commands:{webapp:{execCommand:function(i,r){var f=this,u=n(t.extend(r,{align:"none"}),!1);f.execCommand("inserthtml",u)},queryCommandState:function(){var i=this,n=i.selection.getRange().getClosedNode(),t=n&&n.className=="edui-faked-webapp";return t?1:0}}}}}),UE.plugins.template=function(){UE.commands.template={execCommand:function(n,t){t.html&&this.execCommand("inserthtml",t.html)}},this.addListener("click",function(t,i){var u=i.target||i.srcElement,f=this.selection.getRange(),r=n.findParent(u,function(t){if(t.className&&n.hasClass(t,"ue_t"))return t},!0);r&&f.selectNode(r).shrinkBoundary().select()}),this.addListener("keydown",function(t,i){var u=this.selection.getRange(),r;u.collapsed||!i.ctrlKey&&!i.metaKey&&!i.shiftKey&&!i.altKey&&(r=n.findParent(u.startContainer,function(t){if(t.className&&n.hasClass(t,"ue_t"))return t},!0),r&&n.removeClasses(r,["ue_t"]))})},UE.plugin.register("music",function(){function n(n,t,r,u,f,e){return e?'<embed type="application/x-shockwave-flash" class="edui-faked-music" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+n+'" width="'+t+'" height="'+r+'" '+(u&&!f?'align="'+u+'"':"")+(f?'style="float:'+f+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >':"<img "+(u&&!f?'align="'+u+'"':"")+(f?'style="float:'+f+'"':"")+' width="'+t+'" height="'+r+'" _url="'+n+'" class="edui-faked-music" src="'+i.options.langPath+i.options.lang+'/images/music.png" />'}var i=this;return{outputRule:function(i){t.each(i.getNodesByTagName("img"),function(t){var u,f,i,r;t.getAttr("class")=="edui-faked-music"&&(f=t.getStyle("float"),i=t.getAttr("align"),u=n(t.getAttr("_url"),t.getAttr("width"),t.getAttr("height"),i,f,!0),r=UE.uNode.createElement(u),t.parentNode.replaceChild(r,t))})},inputRule:function(i){t.each(i.getNodesByTagName("embed"),function(t){var u,r,i;t.getAttr("class")=="edui-faked-music"&&(u=t.getStyle("float"),r=t.getAttr("align"),html=n(t.getAttr("src"),t.getAttr("width"),t.getAttr("height"),r,u,!1),i=UE.uNode.createElement(html),t.parentNode.replaceChild(i,t))})},commands:{music:{execCommand:function(t,i){var u=this,r=n(i.url,i.width||400,i.height||95,"none",!1);u.execCommand("inserthtml",r)},queryCommandState:function(){var i=this,n=i.selection.getRange().getClosedNode(),t=n&&n.className=="edui-faked-music";return t?1:0}}}}}),UE.plugin.register("autoupload",function(){function u(i,r){var u=r,p,a,w,l,y,v,o,c,f=/image\/\w+/i.test(i.type)?"image":"file",e="loading_"+(+new Date).toString(36),b;p=u.getOpt(f+"FieldName"),a=u.getOpt(f+"UrlPrefix"),w=u.getOpt(f+"MaxSize"),l=u.getOpt(f+"AllowFiles"),y=u.getActionUrl(u.getOpt(f+"ActionName")),o=function(t){var i=u.document.getElementById(e);i&&n.remove(i),u.fireEvent("showmessage",{id:e,content:t,type:"error",timeout:4e3})},f=="image"?(v='<img class="loadingclass" id="'+e+'" src="'+u.options.themePath+u.options.theme+'/images/spacer.gif" title="'+(u.getLang("autoupload.loading")||"")+'" >',c=function(t){var r=a+t.url,i=u.document.getElementById(e);i&&(i.setAttribute("src",r),i.setAttribute("_src",r),i.setAttribute("title",t.title||""),i.setAttribute("alt",t.original||""),i.setAttribute("class","dzz-image"),i.setAttribute("path","attach::"+t.attach.aid),i.setAttribute("apath",t.attach.apath),i.setAttribute("aid",t.attach.aid),i.setAttribute("ext",t.attach.filetype),i.setAttribute("dsize",t.attach.filesize),i.removeAttribute("id"),n.removeClasses(i,"loadingclass"))}):(v='<p><img class="loadingclass" id="'+e+'" src="'+u.options.themePath+u.options.theme+'/images/spacer.gif" title="'+(u.getLang("autoupload.loading")||"")+'" ></p>',c=function(n){var r=a+n.url,f=u.document.getElementById(e),t=u.selection.getRange(),i=t.createBookmark();t.selectNode(f).select(),u.execCommand("insertfile",{url:r,attach:n.attach}),t.moveToBookmark(i).select()}),u.execCommand("inserthtml",v);if(!u.getOpt(f+"ActionName")){o(u.getLang("autoupload.errorLoadConfig"));return}if(i.size>w){o(u.getLang("autoupload.exceedSizeError"));return}b=i.name?i.name.substr(i.name.lastIndexOf(".")):"";if(l&&(l.join("")+".").indexOf(b.toLowerCase()+".")==-1){o(u.getLang("autoupload.exceedTypeError"));return}var s=new XMLHttpRequest,h=new FormData,d=t.serializeParam(u.queryCommandValue("serverparam"))||"",k=t.formatUrl(y+(y.indexOf("?")==-1?"?":"&")+d);h.append(p,i,i.name||"blob."+i.type.substr("image/".length)),h.append("type","ajax"),s.open("post",k,!0),s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.addEventListener("load",function(n){try{var i=new Function("return "+t.trim(n.target.response))();i.state=="SUCCESS"&&i.url?c(i):o(i.state)}catch(r){o(u.getLang("autoupload.loadError"))}}),s.send(h)}function r(n){return n.clipboardData&&n.clipboardData.items&&n.clipboardData.items.length==1&&/^image\//.test(n.clipboardData.items[0].type)?n.clipboardData.items:null}function i(n){return n.dataTransfer&&n.dataTransfer.files?n.dataTransfer.files:null}return{outputRule:function(n){t.each(n.getNodesByTagName("img"),function(n){/\b(loaderrorclass)|(bloaderrorclass)\b/.test(n.getAttr("class"))&&n.parentNode.removeChild(n)}),t.each(n.getNodesByTagName("p"),function(n){/\bloadpara\b/.test(n.getAttr("class"))&&n.parentNode.removeChild(n)})},bindEvents:{ready:function(){var e=this;if(window.FormData&&window.FileReader){n.on(e.body,"paste drop",function(n){var s=!1,f,o,t;f=n.type=="paste"?r(n):i(n);if(f){o=f.length;while(o--)t=f[o],t.getAsFile&&(t=t.getAsFile()),t&&t.size>0&&(u(t,e),s=!0);s&&n.preventDefault()}});n.on(e.body,"dragover",function(n){n.dataTransfer.types[0]=="Files"&&n.preventDefault()});t.cssRule("loading",".loadingclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-left:1px;height: 22px;width: 22px;}\n.loaderrorclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}",this.document)}}}}}),UE.plugin.register("autosave",function(){function r(n){var r;if(new Date-u<f)return;if(!n.hasContents()){i&&t.removePreferences(i);return}u=new Date,n._saveFlag=null,r=t.body.innerHTML;if(n.fireEvent("beforeautosave",{content:r})===!1)return;t.setPreferences(i,r),n.fireEvent("afterautosave",{content:r})}var t=this,u=new Date,f=20,i=null;return{defaultOptions:{saveInterval:500},bindEvents:{ready:function(){var r="-drafts-data",n=null;n=t.key?t.key+r:(t.container.parentNode.id||"ue-common")+r,i=(location.protocol+location.host+location.pathname).replace(/[.:\/]/g,"_")+n},contentchange:function(){if(!i)return;t._saveFlag&&window.clearTimeout(t._saveFlag),t.options.saveInterval>0?t._saveFlag=window.setTimeout(function(){r(t)},t.options.saveInterval):r(t)}},commands:{clearlocaldata:{execCommand:function(){i&&t.getPreferences(i)&&t.removePreferences(i)},notNeedUndo:!0,ignoreContentChange:!0},getlocaldata:{execCommand:function(){return i?t.getPreferences(i)||"":""},notNeedUndo:!0,ignoreContentChange:!0},drafts:{execCommand:function(){i&&(t.body.innerHTML=t.getPreferences(i)||"<p>"+n.fillHtml+"</p>",t.focus(!0))},queryCommandState:function(){return i?t.getPreferences(i)===null?-1:0:-1},notNeedUndo:!0,ignoreContentChange:!0}}}}),UE.plugin.register("charts",function(){function i(n){var o=null,s=0,i,u,e,r,f;if(n.rows.length<2)return!1;if(n.rows[0].cells.length<2)return!1;for(o=n.rows[0].cells,s=o.length,i=0;r=o[i];i++)if(r.tagName.toLowerCase()!=="th")return!1;for(i=1;u=n.rows[i];i++){if(u.cells.length!=s)return!1;if(u.cells[0].tagName.toLowerCase()!=="th")return!1;for(e=1;r=u.cells[e];e++){f=t.trim(r.innerText||r.textContent||""),f=f.replace(new RegExp(UE.dom.domUtils.fillChar,"g"),"").replace(/^\s+|\s+$/g,"");if(!/^\d*\.?\d+$/.test(f))return!1}}return!0}var r=this;return{bindEvents:{chartserror:function(){}},commands:{charts:{execCommand:function(t,u){var o=n.findParentByTagName(this.selection.getRange().startContainer,"table",!0),s=[],f={},e;if(!o)return!1;if(!i(o))return r.fireEvent("chartserror"),!1;f.title=u.title||"",f.subTitle=u.subTitle||"",f.xTitle=u.xTitle||"",f.yTitle=u.yTitle||"",f.suffix=u.suffix||"",f.tip=u.tip||"",f.dataFormat=u.tableDataFormat||"",f.chartType=u.chartType||0;for(e in f){if(!f.hasOwnProperty(e))continue;s.push(e+":"+f[e])}o.setAttribute("data-chart",s.join(";")),n.addClass(o,"edui-charts-table")},queryCommandState:function(){var u=n.findParentByTagName(this.selection.getRange().startContainer,"table",!0);return u&&i(u)?0:-1}}},inputRule:function(n){t.each(n.getNodesByTagName("table"),function(n){n.getAttr("data-chart")!==undefined&&n.setAttr("style")})},outputRule:function(n){t.each(n.getNodesByTagName("table"),function(n){n.getAttr("data-chart")!==undefined&&n.setAttr("style","display: none;")})}}}),UE.plugin.register("section",function(){function f(){this.tag="",this.level=-1,this.dom=null,this.nextSection=null,this.previousSection=null,this.parentSection=null,this.startAddress=[],this.endAddress=[],this.children=[]}function u(n){var i=new f;return t.extend(i,n)}function r(n,t){for(var r=t,i=0;i<n.length;i++){if(!r.childNodes)return null;r=r.childNodes[n[i]]}return r}var i=this;return{bindMultiEvents:{type:"aftersetcontent afterscencerestore",handler:function(){i.fireEvent("updateSections")}},bindEvents:{ready:function(){i.fireEvent("updateSections");n.on(i.body,"drop paste",function(){i.fireEvent("updateSections")})},afterexeccommand:function(n,t){t=="paragraph"&&i.fireEvent("updateSections")},keyup:function(n,t){var r=this,u=r.selection.getRange(),i;u.collapsed!=!0?r.fireEvent("updateSections"):(i=t.keyCode||t.which,(i==13||i==8||i==46)&&r.fireEvent("updateSections"))}},commands:{getsections:{execCommand:function(n,i){function c(n){for(var t=0;t<f.length;t++)if(f[t](n))return t;return-1}function s(n,i){for(var v,a=null,f,r,p=n.childNodes,y,o,l=0,w=p.length;l<w;l++){r=p[l],v=c(r);if(v>=0){y=h.selection.getRange().selectNode(r).createAddress(!0).startAddress,o=u({tag:r.tagName,title:r.innerText||r.textContent||"",level:v,dom:r,startAddress:t.clone(y,[]),endAddress:t.clone(y,[]),children:[]}),e.nextSection=o,o.previousSection=e,f=e;while(v<=f.level)f=f.parentSection;o.parentSection=f,f.children.push(o),a=e=o}else r.nodeType===1&&s(r,i),a&&a.endAddress[a.endAddress.length-1]++}}for(var f=i||["h1","h2","h3","h4","h5","h6"],r=0;r<f.length;r++)typeof f[r]=="string"?f[r]=function(n){return function(t){return t.tagName==n.toUpperCase()}}(f[r]):typeof f[r]!="function"&&(f[r]=function(){return null});var h=this,o=u({level:-1,title:"root"}),e=o;return s(h.body,o),o},notNeedUndo:!0},movesection:{execCommand:function(t,i,u,f){function v(n,t,i){for(var u=!1,f=!1,r=0;r<n.length;r++){if(r>=i.length)break;if(i[r]>n[r]){u=!0;break}else if(i[r]<n[r])break}for(r=0;r<t.length;r++){if(r>=i.length)break;if(i[r]<n[r]){f=!0;break}else if(i[r]>n[r])break}return u&&f}var c=this,l,o,a,s,e,h;if(!i||!u||u.level==-1)return;l=f?u.endAddress:u.startAddress,o=r(l,c.body);if(!l||!o||v(i.startAddress,i.endAddress,l))return;a=r(i.startAddress,c.body),s=r(i.endAddress,c.body);if(f){e=s;while(e&&!(n.getPosition(a,e)&n.POSITION_FOLLOWING)){h=e.previousSibling,n.insertAfter(o,e);if(e==a)break;e=h}}else{e=a;while(e&&!(n.getPosition(e,s)&n.POSITION_FOLLOWING)){h=e.nextSibling,o.parentNode.insertBefore(e,o);if(e==s)break;e=h}}c.fireEvent("updateSections")}},deletesection:{execCommand:function(t,i,r){function s(n){for(var i=f.body,t=0;t<n.length;t++){if(!i.childNodes)return null;i=i.childNodes[n[t]]}return i}var f=this;if(!i)return;var h=s(i.startAddress),o=s(i.endAddress),u=h,e;if(r)n.remove(u);else while(u&&n.inDoc(o,f.document)&&!(n.getPosition(u,o)&n.POSITION_FOLLOWING))e=u.nextSibling,n.remove(u),u=e;f.fireEvent("updateSections")}},selectsection:{execCommand:function(n,i){if(!i&&!i.dom)return!1;var u=this,f=u.selection.getRange(),r={startAddress:t.clone(i.startAddress,[]),endAddress:t.clone(i.endAddress,[])};return r.endAddress[r.endAddress.length-1]++,f.moveToAddress(r).select().scrollToView(),!0},notNeedUndo:!0},scrolltosection:{execCommand:function(n,t){if(!t&&!t.dom)return!1;var r=this,u=r.selection.getRange(),i={startAddress:t.startAddress,endAddress:t.endAddress};return i.endAddress[i.endAddress.length-1]++,u.moveToAddress(i).scrollToView(),!0},notNeedUndo:!0}}}}),UE.plugin.register("simpleupload",function(){function f(){var o=r.offsetWidth||20,s=r.offsetHeight||20,f=document.createElement("iframe"),e="display:block;width:"+o+"px;height:"+s+"px;overflow:hidden;border:0;margin:0;padding:0;position:absolute;top:0;left:0;filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity: 0;opacity: 0;cursor:pointer;";n.on(f,"load",function(){var h=(+new Date).toString(36),a,c,r,p;c=f.contentDocument||f.contentWindow.document,r=c.body,a=c.createElement("div"),a.innerHTML='<form id="edui_form_'+h+'" target="edui_iframe_'+h+'" method="POST" enctype="multipart/form-data" action="'+i.getOpt("serverUrl")+'" style="'+e+'"><input id="edui_input_'+h+'" type="file" accept="image/*" name="'+i.options.imageFieldName+'" style="'+e+'"></form><iframe id="edui_iframe_'+h+'" name="edui_iframe_'+h+'" style="display:none;width:0;height:0;border:0;margin:0;padding:0;position:absolute;"></iframe>',a.className="edui-"+i.options.theme,a.id=i.ui.id+"_iframeupload",r.style.cssText=e,r.style.width=o+"px",r.style.height=s+"px",r.appendChild(a),r.parentNode&&(r.parentNode.style.width=o+"px",r.parentNode.style.height=o+"px");var y=c.getElementById("edui_form_"+h),l=c.getElementById("edui_input_"+h),v=c.getElementById("edui_iframe_"+h);n.on(l,"change",function(){function h(){try{var e,f,t,o=(v.contentDocument||v.contentWindow.document).body,s=o.innerText||o.textContent||"";f=new Function("return "+s)(),e=i.options.imageUrlPrefix+f.url,f.state=="SUCCESS"&&f.url?(t=i.document.getElementById(u),t.setAttribute("src",e),t.setAttribute("_src",e),t.setAttribute("title",f.title||""),t.setAttribute("alt",f.original||""),t.setAttribute("class","dzz-image"),t.setAttribute("path","attach::"+f.attach.aid),t.setAttribute("apath",f.attach.apath),t.setAttribute("aid",f.attach.aid),t.setAttribute("ext",f.attach.filetype),t.setAttribute("dsize",f.attach.filesize),t.removeAttribute("id"),n.removeClasses(t,"loadingclass")):r&&r(f.state)}catch(c){r&&r(i.getLang("simpleupload.loadError"))}y.reset(),n.un(v,"load",h)}function r(t){if(u){var r=i.document.getElementById(u);r&&n.remove(r),i.fireEvent("showmessage",{id:u,content:t,type:"error",timeout:4e3})}}var f,e;if(!l.value)return;var u="loading_"+(+new Date).toString(36),c=t.serializeParam(i.queryCommandValue("serverparam"))||"",s=i.getActionUrl(i.getOpt("imageActionName")),o=i.getOpt("imageAllowFiles");i.focus(),i.execCommand("inserthtml",'<img class="loadingclass" id="'+u+'" src="'+i.options.themePath+i.options.theme+'/images/spacer.gif" title="'+(i.getLang("simpleupload.loading")||"")+'" >');if(!i.getOpt("imageActionName")){errorHandler(i.getLang("autoupload.errorLoadConfig"));return}f=l.value,e=f?f.substr(f.lastIndexOf(".")):"";if(!e||o&&(o.join("")+".").indexOf(e.toLowerCase()+".")==-1){r(i.getLang("simpleupload.exceedTypeError"));return}n.on(v,"load",h);y.action=t.formatUrl(s+(s.indexOf("?")==-1?"?":"&")+c),y.submit()});i.addListener("selectionchange",function(){clearTimeout(p),p=setTimeout(function(){var n=i.queryCommandState("simpleupload");l.disabled=n==-1?"disabled":!1},400)}),u=!0});f.style.cssText=e,r.appendChild(f)}var i=this,u=!1,r;return{bindEvents:{ready:function(){t.cssRule("loading",".loadingclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}\n.loaderrorclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}",this.document)},simpleuploadbtnready:function(n,t){r=t,i.afterConfigReady(f)}},outputRule:function(n){t.each(n.getNodesByTagName("img"),function(n){/\b(loaderrorclass)|(bloaderrorclass)\b/.test(n.getAttr("class"))&&n.parentNode.removeChild(n)})},commands:{simpleupload:{queryCommandState:function(){return u?0:-1}}}}}),UE.plugin.register("serverparam",function(){var i=this,n={};return{commands:{serverparam:{execCommand:function(i,r,u){r===undefined||r===null?n={}:t.isString(r)?u===undefined||u===null?delete n[r]:n[r]=u:t.isObject(r)?t.extend(n,r,!0):t.isFunction(r)&&t.extend(n,r(),!0)},queryCommandValue:function(){return n||{}}}}}}),UE.plugin.register("insertfile",function(){function i(n){var i=n.substr(n.lastIndexOf(".")+1).toLowerCase(),t={rar:"icon_rar.gif",zip:"icon_rar.gif",tar:"icon_rar.gif",gz:"icon_rar.gif",bz2:"icon_rar.gif",doc:"icon_doc.gif",docx:"icon_doc.gif",pdf:"icon_pdf.gif",mp3:"icon_mp3.gif",xls:"icon_xls.gif",chm:"icon_chm.gif",ppt:"icon_ppt.gif",pptx:"icon_ppt.gif",avi:"icon_mv.gif",rmvb:"icon_mv.gif",wmv:"icon_mv.gif",flv:"icon_mv.gif",swf:"icon_mv.gif",rm:"icon_mv.gif",exe:"icon_exe.gif",psd:"icon_psd.gif",txt:"icon_txt.gif",jpg:"icon_jpg.gif",png:"icon_jpg.gif",jpeg:"icon_jpg.gif",gif:"icon_jpg.gif",ico:"icon_jpg.gif",bmp:"icon_jpg.gif"};return t[i]?t[i]:t.txt}var n=this;return{commands:{insertfile:{execCommand:function(r,u){u=t.isArray(u)?u:[u];for(var f,o,e,c="",h=n.getOpt("UEDITOR_HOME_URL"),l=h+(h.substr(h.length-1)=="/"?"":"/")+"dialogs/attachment/fileTypeImages/",s=0;s<u.length;s++)f=u[s],o=f.attach?f.attach.img:l+i(f.url),e=(f.attach?f.attach.filename:f.title)||f.url.substr(f.url.lastIndexOf("/")+1),c+=f.attach&&f.attach.aid>0?'<span class="dzz-attach"><img class="dzz-attach-icon" src="'+o+'" _src="'+o+'" /><a class="dzz-attach-title" href="'+f.url+'" title="'+e+'" aid="'+f.attach.aid+'"  dsize="'+f.attach.filesize+'" ext="'+f.attach.filetype+'" apath="'+f.attach.apath+'" path="attach::'+f.attach.aid+'">'+e+"</a></span>":'<p style="line-height: 16px;"><img style="vertical-align: middle; margin-right: 2px;" src="'+o+'" _src="'+o+'" /><a style="font-size:12px; color:#0066cc;" href="'+f.url+'" title="'+e+'">'+e+"</a></p>";n.execCommand("insertHtml",c)}}}}}),u=u||{},u.editor=u.editor||{},UE.ui=u.editor.ui={},(function(){function f(){var n=document.getElementById("edui_fixedlayer");t.setViewportOffset(n,{left:0,top:0})}function h(){i.on(window,"scroll",f);i.on(window,"resize",u.editor.utils.defer(f,0,!0))}var n=u.editor.browser,i=u.editor.dom.domUtils,r="$EDITORUI",o=window[r]={},s="ID"+r,e=0,t=u.editor.ui.uiUtils={uid:function(n){return n?n[s]||(n[s]=++e):++e},hook:function(n,t){var i;return n&&n._callbacks?i=n:(i=function(){var t,u,r,f;n&&(t=n.apply(this,arguments)),u=i._callbacks,r=u.length;while(r--)f=u[r].apply(this,arguments),t===undefined&&(t=f);return t},i._callbacks=[]),i._callbacks.push(t),i},createElementByHtml:function(n){var t=document.createElement("div");return t.innerHTML=n,t=t.firstChild,t.parentNode.removeChild(t),t},getViewportElement:function(){return n.ie&&n.quirks?document.body:document.documentElement},getClientRect:function(n){var t,r,u;try{t=n.getBoundingClientRect()}catch(f){t={left:0,top:0,height:0,width:0}}r={left:Math.round(t.left),top:Math.round(t.top),height:Math.round(t.bottom-t.top),width:Math.round(t.right-t.left)};while((u=n.ownerDocument)!==document&&(n=i.getWindow(u).frameElement))t=n.getBoundingClientRect(),r.left+=t.left,r.top+=t.top;return r.bottom=r.top+r.height,r.right=r.left+r.width,r},getViewportRect:function(){var r=t.getViewportElement(),i=(window.innerWidth||r.clientWidth)|0,n=(window.innerHeight||r.clientHeight)|0;return{left:0,top:0,height:n,width:i,bottom:n,right:i}},setViewportOffset:function(n,r){var f,u=t.getFixedLayer();n.parentNode===u?(n.style.left=r.left+"px",n.style.top=r.top+"px"):i.setViewportOffset(n,r)},getEventOffset:function(n){var u=n.target||n.srcElement,i=t.getClientRect(u),r=t.getViewportOffsetByEvent(n);return{left:r.left-i.left,top:r.top-i.top}},getViewportOffsetByEvent:function(n){var e=n.target||n.srcElement,f=i.getWindow(e).frameElement,r={left:n.clientX,top:n.clientY},u;return f&&e.ownerDocument!==document&&(u=t.getClientRect(f),r.left+=u.left,r.top+=u.top),r},setGlobal:function(n,t){return o[n]=t,r+'["'+n+'"]'},unsetGlobal:function(n){delete o[n]},copyAttributes:function(t,r){var f=r.attributes,e=f.length,u;while(e--)u=f[e],u.nodeName!="style"&&u.nodeName!="class"&&(!n.ie||u.specified)&&t.setAttribute(u.nodeName,u.nodeValue);r.className&&i.addClass(t,r.className),r.style.cssText&&(t.style.cssText+=";"+r.style.cssText)},removeStyle:function(n,t){if(n.style.removeProperty)n.style.removeProperty(t);else if(n.style.removeAttribute)n.style.removeAttribute(t);else throw"";},contains:function(n,t){return n&&t&&(n===t?!1:n.contains?n.contains(t):n.compareDocumentPosition(t)&16)},startDrag:function(n,t,i){function f(n){var r=n.clientX-s,i=n.clientY-o;t.ondragmove(r,i,n);n.stopPropagation?n.stopPropagation():n.cancelBubble=!0}var i=i||document,s=n.clientX,o=n.clientY,r;if(i.addEventListener){function u(){i.removeEventListener("mousemove",f,!0),i.removeEventListener("mouseup",u,!0),window.removeEventListener("mouseup",u,!0),t.ondragstop()}i.addEventListener("mousemove",f,!0),i.addEventListener("mouseup",u,!0),window.addEventListener("mouseup",u,!0),n.preventDefault()}else{r=n.srcElement,r.setCapture();function e(){r.releaseCapture(),r.detachEvent("onmousemove",f),r.detachEvent("onmouseup",e),r.detachEvent("onlosecaptrue",e),t.ondragstop()}r.attachEvent("onmousemove",f),r.attachEvent("onmouseup",e),r.attachEvent("onlosecaptrue",e),n.returnValue=!1}t.ondragstart()},getFixedLayer:function(){var t=document.getElementById("edui_fixedlayer");return t==null&&(t=document.createElement("div"),t.id="edui_fixedlayer",document.body.appendChild(t),n.ie&&n.version<=8?(t.style.position="absolute",h(),setTimeout(f)):t.style.position="fixed",t.style.left="0",t.style.top="0",t.style.width="0",t.style.height="0"),t},makeUnselectable:function(i){if(n.opera||n.ie&&n.version<9){i.unselectable="on";if(i.hasChildNodes())for(var r=0;r<i.childNodes.length;r++)i.childNodes[r].nodeType==1&&t.makeUnselectable(i.childNodes[r])}else i.style.MozUserSelect!==undefined?i.style.MozUserSelect="none":i.style.WebkitUserSelect!==undefined?i.style.WebkitUserSelect="none":i.style.KhtmlUserSelect!==undefined&&(i.style.KhtmlUserSelect="none")}}})(),(function(){var r=u.editor.utils,t=u.editor.ui.uiUtils,f=u.editor.EventBase,i=u.editor.ui.UIBase=function(){};i.prototype={className:"",uiName:"",initOptions:function(n){var r=this,i;for(i in n)r[i]=n[i];this.id=this.id||"edui"+t.uid()},initUIBase:function(){this._globalKey=r.unhtml(t.setGlobal(this.id,this))},render:function(i){for(var c=this.renderHtml(),u=t.createElementByHtml(c),h=n.getElementsByTagName(u,"*"),f="edui-"+(this.theme||this.editor.options.theme),e=document.getElementById("edui_fixedlayer"),o,r,s=0;o=h[s++];)n.addClass(o,f);n.addClass(u,f),e&&(e.className="",n.addClass(e,f)),r=this.getDom(),r!=null?(r.parentNode.replaceChild(u,r),t.copyAttributes(u,r)):(typeof i=="string"&&(i=document.getElementById(i)),i=i||t.getFixedLayer(),n.addClass(i,f),i.appendChild(u)),this.postRender()},getDom:function(n){return n?document.getElementById(this.id+"_"+n):document.getElementById(this.id)},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(n){var t="edui-"+this.uiName;return n.replace(/##/g,this.id).replace(/%%-/g,this.uiName?t+"-":"").replace(/%%/g,(this.uiName?t:"")+" "+this.className).replace(/\$\$/g,this._globalKey)},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var n=this.getDom();n&&u.editor.dom.domUtils.remove(n),t.unsetGlobal(this.id)}},r.inherits(i,f)})(),(function(){var t=u.editor.utils,i=u.editor.ui.UIBase,n=u.editor.ui.Separator=function(n){this.initOptions(n),this.initSeparator()};n.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}},t.inherits(n,i)})(),(function(){var i=u.editor.utils,r=u.editor.dom.domUtils,f=u.editor.ui.UIBase,t=u.editor.ui.uiUtils,n=u.editor.ui.Mask=function(n){this.initOptions(n),this.initUIBase()};n.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onclick="return $$._onClick(event, this);" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var n=this;r.on(window,"resize",function(){setTimeout(function(){n.isHidden()||n._fill()})})},show:function(n){this._fill(),this.getDom().style.display="",this.getDom().style.zIndex=n},hide:function(){this.getDom().style.display="none",this.getDom().style.zIndex=""},isHidden:function(){return this.getDom().style.display=="none"},_onMouseDown:function(){return!1},_onClick:function(n,t){this.fireEvent("click",n,t)},_fill:function(){var i=this.getDom(),n=t.getViewportRect();i.style.width=n.width+"px",i.style.height=n.height+"px"}},i.inherits(n,f)})(),(function(){function r(n,t){for(var r,u=0;u<i.length;u++){r=i[u];if(!r.isHidden())if(r.queryAutoHide(t)!==!1){if(n&&/scroll/ig.test(n.type)&&r.className=="edui-wordpastepop")return;r.hide()}}i.length&&r.editor.fireEvent("afterhidepop")}var s=u.editor.utils,n=u.editor.ui.uiUtils,t=u.editor.dom.domUtils,e=u.editor.ui.UIBase,f=u.editor.ui.Popup=function(n){this.initOptions(n),this.initPopup()},i=[],o;f.postHide=r,o=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"],f.prototype={SHADOW_RADIUS:5,content:null,_hidden:!1,autoRender:!0,canSideLeft:!0,canSideUp:!0,initPopup:function(){this.initUIBase(),i.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%" onmousedown="return false;"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},getContentHtmlTpl:function(){return this.content?typeof this.content=="string"?this.content:this.content.renderHtml():""},_UIBase_postRender:e.prototype.postRender,postRender:function(){this.content instanceof e&&this.content.postRender();if(this.captureWheel&&!this.captured){this.captured=!0;var o=(document.documentElement.clientHeight||document.body.clientHeight)-80,u=this.getDom().offsetHeight,s=n.getClientRect(this.combox.getDom()).top,r=this.getDom("content"),i=this.getDom("body").getElementsByTagName("iframe"),f=this;i.length&&(i=i[0]);while(s+u>o)u-=30;r.style.height=u+"px",i&&(i.style.height=u+"px");if(window.XMLHttpRequest)t.on(r,"onmousewheel"in document.body?"mousewheel":"DOMMouseScroll",function(n){n.preventDefault?n.preventDefault():n.returnValue=!1,r.scrollTop-=n.wheelDelta?n.wheelDelta/2:n.detail*-20});else t.on(this.getDom(),"mousewheel",function(n){n.returnValue=!1,f.getDom("content").scrollTop-=n.wheelDelta/2})}this.fireEvent("postRenderAfter"),this.hide(!0),this._UIBase_postRender()},_doAutoRender:function(){!this.getDom()&&this.autoRender&&this.render()},mesureSize:function(){var t=this.getDom("content");return n.getClientRect(t)},fitSize:function(){var t,n,i;return this.captureWheel&&this.sized?this.__size:(this.sized=!0,t=this.getDom("body"),t.style.width="",t.style.height="",n=this.mesureSize(),this.captureWheel?(t.style.width=-(-20-n.width)+"px",i=parseInt(this.getDom("content").style.height,10),!window.isNaN(i)&&(n.height=i)):t.style.width=n.width+"px",t.style.height=n.height+"px",this.__size=n,this.captureWheel&&(this.getDom("content").style.overflow="auto"),n)},showAnchor:function(t,i){this.showAnchorRect(n.getClientRect(t),i)},showAnchorRect:function(i,r){var h,e,l,c,a,v,s;this._doAutoRender(),h=n.getViewportRect(),this.getDom().style.visibility="hidden",this._show(),e=this.fitSize(),r?(l=this.canSideLeft&&i.right+e.width>h.right&&i.left>e.width,c=this.canSideUp&&i.top+e.height>h.bottom&&i.bottom>e.height,a=l?i.left-e.width:i.right,v=c?i.bottom-e.height:i.top):(l=this.canSideLeft&&i.right+e.width>h.right&&i.left>e.width,c=this.canSideUp&&i.top+e.height>h.bottom&&i.bottom>e.height,a=l?i.right-e.width:i.left,v=c?i.top-e.height:i.bottom),s=this.getDom(),n.setViewportOffset(s,{left:a,top:v}),t.removeClasses(s,o),s.className+=" "+o[(c?1:0)*2+(l?1:0)],this.editor&&(s.style.zIndex=this.editor.container.style.zIndex*1+10,u.editor.ui.uiUtils.getFixedLayer().style.zIndex=s.style.zIndex-1),this.getDom().style.visibility="visible"},showAt:function(n){var i=n.left,t=n.top,r={left:i,top:t,right:i,bottom:t,height:0,width:0};this.showAnchorRect(r,!1,!0)},_show:function(){if(this._hidden){var n=this.getDom();n.style.display="",this._hidden=!1,this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender(),this._show()},hide:function(n){!this._hidden&&this.getDom()&&(this.getDom().style.display="none",this._hidden=!0,n||this.fireEvent("hide"))},queryAutoHide:function(t){return!t||!n.contains(this.getDom(),t)}},s.inherits(f,e);t.on(document,"mousedown",function(n){var t=n.target||n.srcElement;r(n,t)});t.on(window,"scroll",function(n,t){r(n,t)})})(),(function(){function i(t,i){for(var u='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+t+'</div></div><table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0"><tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px"><td colspan="10">'+i.getLang("themeColor")+'</td> </tr><tr class="edui-colorpicker-tablefirstrow" >',r=0;r<n.length;r++)r&&r%10==0&&(u+="</tr>"+(r==60?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;"><td colspan="10">'+i.getLang("standardColor")+"</td></tr>":"")+"<tr"+(r==60?' class="edui-colorpicker-tablefirstrow"':"")+">"),u+=r<70?'<td style="padding: 0 2px;"><a hidefocus title="'+n[r]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell" data-color="#'+n[r]+'" style="background-color:#'+n[r]+";border:solid #ccc;"+(r<10||r>=60?"border-width:1px;":r>=10&&r<20?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"></a></td>':"";return u+="</tr></table></div>"}var f=u.editor.utils,r=u.editor.ui.UIBase,t=u.editor.ui.ColorPicker=function(n){this.initOptions(n),this.noColorText=this.noColorText||this.editor.getLang("clearColor"),this.initUIBase()},n;t.prototype={getHtmlTpl:function(){return i(this.noColorText,this.editor)},_onTableClick:function(n){var i=n.target||n.srcElement,t=i.getAttribute("data-color");t&&this.fireEvent("pickcolor",t)},_onTableOver:function(n){var i=n.target||n.srcElement,t=i.getAttribute("data-color");t&&(this.getDom("preview").style.backgroundColor=t)},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}},f.inherits(t,r),n="ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,".split(",")})(),(function(){var r=u.editor.utils,n=u.editor.ui.uiUtils,t=u.editor.ui.UIBase,i=u.editor.ui.TablePicker=function(n){this.initOptions(n),this.initTablePicker()};i.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase()},getHtmlTpl:function(){var n=this;return'<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"></span></div><div class="edui-pickarea" onmousemove="$$._onMouseMove(event, this);" onmouseover="$$._onMouseOver(event, this);" onmouseout="$$._onMouseOut(event, this);" onclick="$$._onClick(event, this);"><div id="##_overlay" class="edui-overlay"></div></div></div></div>'},_UIBase_render:t.prototype.render,render:function(n){this._UIBase_render(n),this.getDom("label").innerHTML="0"+this.editor.getLang("t_row")+" x 0"+this.editor.getLang("t_col")},_track:function(n,t){var u=this.getDom("overlay").style,r=this.lengthOfCellSide,i;u.width=n*r+"px",u.height=t*r+"px",i=this.getDom("label"),i.innerHTML=n+this.editor.getLang("t_col")+" x "+t+this.editor.getLang("t_row"),this.numCols=n,this.numRows=t},_onMouseOver:function(t,i){var r=t.relatedTarget||t.fromElement;!n.contains(i,r)&&i!==r&&(this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row"),this.getDom("overlay").style.visibility="")},_onMouseOut:function(t,i){var r=t.relatedTarget||t.toElement;!n.contains(i,r)&&i!==r&&(this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row"),this.getDom("overlay").style.visibility="hidden")},_onMouseMove:function(t){var o=this.getDom("overlay").style,u=n.getEventOffset(t),r=this.lengthOfCellSide,e=Math.ceil(u.left/r),f=Math.ceil(u.top/r);this._track(e,f)},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows)}},r.inherits(i,t)})(),(function(){var r=u.editor.browser,t=u.editor.dom.domUtils,n=u.editor.ui.uiUtils,i='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(r.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"');u.editor.ui.Stateful={alwalysHoverable:!1,target:null,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl,this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){var n=this._Stateful_dGetHtmlTpl();return n.replace(/stateful/g,function(){return i})},Stateful_onMouseEnter:function(n,t){this.target=t,(!this.isDisabled()||this.alwalysHoverable)&&(this.addState("hover"),this.fireEvent("over"))},Stateful_onMouseLeave:function(){(!this.isDisabled()||this.alwalysHoverable)&&(this.removeState("hover"),this.removeState("active"),this.fireEvent("out"))},Stateful_onMouseOver:function(t,i){var r=t.relatedTarget;!n.contains(i,r)&&i!==r&&this.Stateful_onMouseEnter(t,i)},Stateful_onMouseOut:function(t,i){var r=t.relatedTarget;!n.contains(i,r)&&i!==r&&this.Stateful_onMouseLeave(t,i)},Stateful_onMouseDown:function(){this.isDisabled()||this.addState("active")},Stateful_onMouseUp:function(){this.isDisabled()||this.removeState("active")},Stateful_postRender:function(){this.disabled&&!this.hasState("disabled")&&this.addState("disabled")},hasState:function(n){return t.hasClass(this.getStateDom(),"edui-state-"+n)},addState:function(n){this.hasState(n)||(this.getStateDom().className+=" edui-state-"+n)},removeState:function(n){this.hasState(n)&&t.removeClasses(this.getStateDom(),["edui-state-"+n])},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(n){!this.isDisabled()&&n?this.addState("checked"):this.removeState("checked")},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(n){n?(this.removeState("hover"),this.removeState("checked"),this.removeState("active"),this.addState("disabled")):this.removeState("disabled")}}})(),(function(){var t=u.editor.utils,i=u.editor.ui.UIBase,r=u.editor.ui.Stateful,n=u.editor.ui.Button=function(n){if(n.name){var t=n.name,i=n.cssRules;n.className||(n.className="edui-for-"+t),n.cssRules=".edui-default  .edui-for-"+t+" .edui-icon {"+i+"}"}this.initOptions(n),this.initButton()};n.prototype={uiName:"button",label:"",title:"",showIcon:!0,showText:!0,cssRules:"",initButton:function(){this.initUIBase(),this.Stateful_init(),this.cssRules&&t.cssRule("edui-customize-"+this.name+"-style",this.cssRules)},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return $$._onMouseDown(event, this);" onclick="return $$._onClick(event, this);">'+(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div></div></div></div>"},postRender:function(){this.Stateful_postRender(),this.setDisabled(this.disabled)},_onMouseDown:function(n){var i=n.target||n.srcElement,t=i&&i.tagName&&i.tagName.toLowerCase();if(t=="input"||t=="object"||t=="object")return!1},_onClick:function(){this.isDisabled()||this.fireEvent("click")},setTitle:function(n){var t=this.getDom("label");t.innerHTML=n}},t.inherits(n,i),t.extend(n.prototype,r)})(),(function(){var n=u.editor.utils,i=u.editor.ui.uiUtils,e=u.editor.dom.domUtils,r=u.editor.ui.UIBase,f=u.editor.ui.Stateful,t=u.editor.ui.SplitButton=function(n){this.initOptions(n),this.initSplitButton()};t.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){var t,n;this.initUIBase(),this.Stateful_init(),t=this,this.popup!=null&&(n=this.popup,this.popup=null,this.setPopup(n))},_UIBase_postRender:r.prototype.postRender,postRender:function(){this.Stateful_postRender(),this._UIBase_postRender()},setPopup:function(t){if(this.popup===t)return;this.popup!=null&&this.popup.dispose(),t.addListener("show",n.bind(this._onPopupShow,this)),t.addListener("hide",n.bind(this._onPopupHide,this)),t.addListener("postrender",n.bind(function(){t.getDom("body").appendChild(i.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(i.getClientRect(this.getDom()).width+20)+'px"></div>')),t.getDom().className+=" "+this.className},this)),this.popup=t},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"></div></div><div class="edui-box edui-splitborder"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>'},showPopup:function(){var n=i.getClientRect(this.getDom());n.top-=this.popup.SHADOW_RADIUS,n.height+=this.popup.SHADOW_RADIUS,this.popup.showAnchorRect(n)},_onArrowClick:function(){this.isDisabled()||this.showPopup()},_onButtonClick:function(){this.isDisabled()||this.fireEvent("buttonclick")}},n.inherits(t,r),n.extend(t.prototype,f,!0)})(),(function(){var i=u.editor.utils,f=u.editor.ui.uiUtils,e=u.editor.ui.ColorPicker,r=u.editor.ui.Popup,n=u.editor.ui.SplitButton,t=u.editor.ui.ColorButton=function(n){this.initOptions(n),this.initColorButton()};t.prototype={initColorButton:function(){var n=this;this.popup=new r({content:new e({noColorText:n.editor.getLang("clearColor"),editor:n.editor,onpickcolor:function(t,i){n._onPickColor(i)},onpicknocolor:function(t,i){n._onPickNoColor(i)}}),editor:n.editor}),this.initSplitButton()},_SplitButton_postRender:n.prototype.postRender,postRender:function(){this._SplitButton_postRender(),this.getDom("button_body").appendChild(f.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>')),this.getDom().className+=" edui-colorbutton"},setColor:function(n){this.getDom("colorlump").style.backgroundColor=n,this.color=n},_onPickColor:function(n){this.fireEvent("pickcolor",n)!==!1&&(this.setColor(n),this.popup.hide())},_onPickNoColor:function(){this.fireEvent("picknocolor")!==!1&&this.popup.hide()}},i.inherits(t,n)})(),(function(){var i=u.editor.utils,r=u.editor.ui.Popup,f=u.editor.ui.TablePicker,t=u.editor.ui.SplitButton,n=u.editor.ui.TableButton=function(n){this.initOptions(n),this.initTableButton()};n.prototype={initTableButton:function(){var n=this;this.popup=new r({content:new f({editor:n.editor,onpicktable:function(t,i,r){n._onPickTable(i,r)}}),editor:n.editor}),this.initSplitButton()},_onPickTable:function(n,t){this.fireEvent("picktable",n,t)!==!1&&this.popup.hide()}},i.inherits(n,t)})(),(function(){var i=u.editor.utils,t=u.editor.ui.UIBase,n=u.editor.ui.AutoTypeSetPicker=function(n){this.initOptions(n),this.initAutoTypeSetPicker()};n.prototype={initAutoTypeSetPicker:function(){this.initUIBase()},getHtmlTpl:function(){var i=this.editor,n=i.options.autotypeset,t=i.getLang("autoTypeSet"),u="textAlignValue"+i.uid,r="imageBlockLineValue"+i.uid,f="symbolConverValue"+i.uid;return'<div id="##" class="edui-autotypesetpicker %%"><div class="edui-autotypesetpicker-body"><table ><tr><td nowrap><input type="checkbox" name="mergeEmptyline" '+(n.mergeEmptyline?"checked":"")+">"+t.mergeLine+'</td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(n.removeEmptyline?"checked":"")+">"+t.delLine+'</td></tr><tr><td nowrap><input type="checkbox" name="removeClass" '+(n.removeClass?"checked":"")+">"+t.removeFormat+'</td><td colspan="2"><input type="checkbox" name="indent" '+(n.indent?"checked":"")+">"+t.indent+'</td></tr><tr><td nowrap><input type="checkbox" name="textAlign" '+(n.textAlign?"checked":"")+">"+t.alignment+'</td><td colspan="2" id="'+u+'"><input type="radio" name="'+u+'" value="left" '+(n.textAlign&&n.textAlign=="left"?"checked":"")+">"+i.getLang("justifyleft")+'<input type="radio" name="'+u+'" value="center" '+(n.textAlign&&n.textAlign=="center"?"checked":"")+">"+i.getLang("justifycenter")+'<input type="radio" name="'+u+'" value="right" '+(n.textAlign&&n.textAlign=="right"?"checked":"")+">"+i.getLang("justifyright")+'</td></tr><tr><td nowrap><input type="checkbox" name="imageBlockLine" '+(n.imageBlockLine?"checked":"")+">"+t.imageFloat+'</td><td nowrap id="'+r+'"><input type="radio" name="'+r+'" value="none" '+(n.imageBlockLine&&n.imageBlockLine=="none"?"checked":"")+">"+i.getLang("default")+'<input type="radio" name="'+r+'" value="left" '+(n.imageBlockLine&&n.imageBlockLine=="left"?"checked":"")+">"+i.getLang("justifyleft")+'<input type="radio" name="'+r+'" value="center" '+(n.imageBlockLine&&n.imageBlockLine=="center"?"checked":"")+">"+i.getLang("justifycenter")+'<input type="radio" name="'+r+'" value="right" '+(n.imageBlockLine&&n.imageBlockLine=="right"?"checked":"")+">"+i.getLang("justifyright")+'</td></tr><tr><td nowrap><input type="checkbox" name="clearFontSize" '+(n.clearFontSize?"checked":"")+">"+t.removeFontsize+'</td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(n.clearFontFamily?"checked":"")+">"+t.removeFontFamily+'</td></tr><tr><td nowrap colspan="3"><input type="checkbox" name="removeEmptyNode" '+(n.removeEmptyNode?"checked":"")+">"+t.removeHtml+'</td></tr><tr><td nowrap colspan="3"><input type="checkbox" name="pasteFilter" '+(n.pasteFilter?"checked":"")+">"+t.pasteFilter+'</td></tr><tr><td nowrap><input type="checkbox" name="symbolConver" '+(n.bdc2sb||n.tobdc?"checked":"")+">"+t.symbol+'</td><td id="'+f+'"><input type="radio" name="bdc" value="bdc2sb" '+(n.bdc2sb?"checked":"")+">"+t.bdc2sb+'<input type="radio" name="bdc" value="tobdc" '+(n.tobdc?"checked":"")+">"+t.tobdc+'</td><td nowrap align="right"><button >'+t.run+"</button></td></tr></table></div></div>"},_UIBase_render:t.prototype.render},i.inherits(n,t)})(),(function(){function t(t){for(var i={},p=t.getDom(),b=t.editor.uid,y=null,u=null,v=n.getElementsByTagName(p,"input"),f,e,l,w,h,a,c,s,o=v.length-1;f=v[o--];){y=f.getAttribute("type");if(y=="checkbox"){u=f.getAttribute("name"),i[u]&&delete i[u];if(f.checked){e=document.getElementById(u+"Value"+b);if(e){if(/input/ig.test(e.tagName))i[u]=e.value;else for(l=e.getElementsByTagName("input"),w=l.length-1;h=l[w--];)if(h.checked){i[u]=h.value;break}}else i[u]=!0}else i[u]=!1}else i[f.getAttribute("value")]=f.checked}for(a=n.getElementsByTagName(p,"select"),o=0;c=a[o++];)s=c.getAttribute("name"),i[s]=i[s]?c.value:"";r.extend(t.editor.options.autotypeset,i),t.editor.setPreferences("autotypeset",i)}var r=u.editor.utils,e=u.editor.ui.Popup,f=u.editor.ui.AutoTypeSetPicker,o=u.editor.ui.SplitButton,i=u.editor.ui.AutoTypeSetButton=function(n){this.initOptions(n),this.initAutoTypeSetButton()};i.prototype={initAutoTypeSetButton:function(){var i=this,r;this.popup=new e({content:new f({editor:i.editor}),editor:i.editor,hide:function(){!this._hidden&&this.getDom()&&(t(this),this.getDom().style.display="none",this._hidden=!0,this.fireEvent("hide"))}}),r=0,this.popup.addListener("postRenderAfter",function(){var f=this,u,e;if(r)return;u=this.getDom(),e=u.getElementsByTagName("button")[0],e.onclick=function(){t(f),i.editor.execCommand("autotypeset"),f.hide()};n.on(u,"click",function(n){var r=n.target||n.srcElement,s=i.editor.uid,u,o;if(r&&r.tagName=="INPUT"){if(r.name=="imageBlockLine"||r.name=="textAlign"||r.name=="symbolConver"){var c=r.checked,h=document.getElementById(r.name+"Value"+s),e=h.getElementsByTagName("input"),l={imageBlockLine:"none",textAlign:"left",symbolConver:"tobdc"};for(u=0;u<e.length;u++)c?e[u].value==l[r.name]&&(e[u].checked="checked"):e[u].checked=!1}(r.name=="imageBlockLineValue"+s||r.name=="textAlignValue"+s||r.name=="bdc")&&(o=r.parentNode.previousSibling.getElementsByTagName("input"),o&&(o[0].checked=!0)),t(f)}});r=1}),this.initSplitButton()}},r.inherits(i,o)})(),(function(){var i=u.editor.utils,f=u.editor.ui.Popup,r=u.editor.ui.Stateful,t=u.editor.ui.UIBase,n=u.editor.ui.CellAlignPicker=function(n){this.initOptions(n),this.initSelected(),this.initCellAlignPicker()};n.prototype={initSelected:function(){var n={valign:{top:0,middle:1,bottom:2},align:{left:0,center:1,right:2},count:3},t=-1;this.selected&&(this.selectedIndex=n.valign[this.selected.valign]*n.count+n.align[this.selected.align])},initCellAlignPicker:function(){this.initUIBase(),this.Stateful_init()},getHtmlTpl:function(){for(var u=["left","center","right"],f=9,r=null,t=-1,i=[],n=0;n<f;n++)r=this.selectedIndex===n?' class="edui-cellalign-selected" ':"",t=n%3,t===0&&i.push("<tr>"),i.push('<td index="'+n+'" '+r+' stateful><div class="edui-icon edui-'+u[t]+'"></div></td>'),t===2&&i.push("</tr>");return'<div id="##" class="edui-cellalignpicker %%"><div class="edui-cellalignpicker-body"><table onclick="$$._onClick(event);">'+i.join("")+"</table></div></div>"},getStateDom:function(){return this.target},_onClick:function(n){var t=n.target||n.srcElement;/icon/.test(t.className)&&(this.items[t.parentNode.getAttribute("index")].onclick(),f.postHide(n))},_UIBase_render:t.prototype.render},i.inherits(n,t),i.extend(n.prototype,r,!0)})(),(function(){var r=u.editor.utils,e=u.editor.ui.Stateful,f=u.editor.ui.uiUtils,i=u.editor.ui.UIBase,t=u.editor.ui.PastePicker=function(n){this.initOptions(n),this.initPastePicker()};t.prototype={initPastePicker:function(){this.initUIBase(),this.Stateful_init()},getHtmlTpl:function(){return'<div class="edui-pasteicon" onclick="$$._onClick(this)"></div><div class="edui-pastecontainer"><div class="edui-title">'+this.editor.getLang("pasteOpt")+'</div><div class="edui-button"><div title="'+this.editor.getLang("pasteSourceFormat")+'" onclick="$$.format(false)" stateful><div class="edui-richtxticon"></div></div><div title="'+this.editor.getLang("tagFormat")+'" onclick="$$.format(2)" stateful><div class="edui-tagicon"></div></div><div title="'+this.editor.getLang("pasteTextFormat")+'" onclick="$$.format(true)" stateful><div class="edui-plaintxticon"></div></div></div></div></div>'},getStateDom:function(){return this.target},format:function(n){this.editor.ui._isTransfer=!0,this.editor.fireEvent("pasteTransfer",n)},_onClick:function(t){var i=n.getNextDomNode(t),u=f.getViewportRect().height,r=f.getClientRect(i);i.style.top=r.top+r.height>u?-r.height-t.offsetHeight+"px":"",/hidden/ig.test(n.getComputedStyle(i,"visibility"))?(i.style.visibility="visible",n.addClass(t,"edui-state-opened")):(i.style.visibility="hidden",n.removeClasses(t,"edui-state-opened"))},_UIBase_render:i.prototype.render},r.inherits(t,i),r.extend(t.prototype,e,!0)})(),(function(){var t=u.editor.utils,r=u.editor.ui.uiUtils,i=u.editor.ui.UIBase,n=u.editor.ui.Toolbar=function(n){this.initOptions(n),this.initToolbar()};n.prototype={items:null,initToolbar:function(){this.items=this.items||[],this.initUIBase()},add:function(n,t){t===undefined?this.items.push(n):this.items.splice(t,0,n)},getHtmlTpl:function(){for(var t=[],n=0;n<this.items.length;n++)t[n]=this.items[n].renderHtml();return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+t.join("")+"</div>"},postRender:function(){for(var t=this.getDom(),n=0;n<this.items.length;n++)this.items[n].postRender();r.makeUnselectable(t)},_onMouseDown:function(n){var i=n.target||n.srcElement,t=i&&i.tagName&&i.tagName.toLowerCase();if(t=="input"||t=="object"||t=="object")return!1}},t.inherits(n,i)})(),(function(){var e=u.editor.utils,r=u.editor.dom.domUtils,i=u.editor.ui.uiUtils,o=u.editor.ui.UIBase,t=u.editor.ui.Popup,h=u.editor.ui.Stateful,c=u.editor.ui.CellAlignPicker,f=u.editor.ui.Menu=function(n){this.initOptions(n),this.initMenu()},s={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return!0}},n;f.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[],this.initPopup(),this.initItems()},initItems:function(){for(var t,i=0;i<this.items.length;i++)t=this.items[i],t=="-"?this.items[i]=this.getSeparator():t instanceof n||(t.editor=this.editor,t.theme=this.editor.options.theme,this.items[i]=this.createItem(t))},getSeparator:function(){return s},createItem:function(t){return t.menu=this,new n(t)},_Popup_getContentHtmlTpl:t.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){var t,n,i;if(this.items.length==0)return this._Popup_getContentHtmlTpl();for(t=[],n=0;n<this.items.length;n++)i=this.items[n],t[n]=i.renderHtml();return'<div class="%%-body">'+t.join("")+"</div>"},_Popup_postRender:t.prototype.postRender,postRender:function(){for(var u=this,t,n=0;n<this.items.length;n++)t=this.items[n],t.ownerMenu=this,t.postRender();r.on(this.getDom(),"mouseover",function(n){n=n||event;var r=n.relatedTarget||n.fromElement,t=u.getDom();!i.contains(t,r)&&t!==r&&u.fireEvent("over")});this._Popup_postRender()},queryAutoHide:function(n){var t,r;if(n){if(i.contains(this.getDom(),n))return!1;for(t=0;t<this.items.length;t++){r=this.items[t];if(r.queryAutoHide(n)===!1)return!1}}},clearItems:function(){for(var n,t=0;t<this.items.length;t++)n=this.items[t],clearTimeout(n._showingTimer),clearTimeout(n._closingTimer),n.subMenu&&n.subMenu.destroy();this.items=[]},destroy:function(){this.getDom()&&r.remove(this.getDom()),this.clearItems()},dispose:function(){this.destroy()}},e.inherits(f,t),n=u.editor.ui.MenuItem=function(n){this.initOptions(n),this.initUIBase(),this.Stateful_init();if(this.subMenu&&!(this.subMenu instanceof f))if(n.className&&n.className.indexOf("aligntd")!=-1){var i=this;this.subMenu.selected=this.editor.queryCommandValue("cellalignment"),this.subMenu=new t({content:new c(this.subMenu),parentMenu:i,editor:i.editor,destroy:function(){this.getDom()&&r.remove(this.getDom())}}),this.subMenu.addListener("postRenderAfter",function(){r.on(this.getDom(),"mouseover",function(){i.addState("opened")})})}else this.subMenu=new f(this.subMenu)},n.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:!0,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div></div>"},postRender:function(){var n=this;this.addListener("over",function(){n.ownerMenu.fireEvent("submenuover",n),n.subMenu&&n.delayShowSubMenu()}),this.subMenu&&(this.getDom().className+=" edui-hassubmenu",this.subMenu.render(),this.addListener("out",function(){n.delayHideSubMenu()}),this.subMenu.addListener("over",function(){clearTimeout(n._closingTimer),n._closingTimer=null,n.addState("opened")}),this.ownerMenu.addListener("hide",function(){n.hideSubMenu()}),this.ownerMenu.addListener("submenuover",function(t,i){i!==n&&n.delayHideSubMenu()}),this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide,this.subMenu.queryAutoHide=function(t){return t&&i.contains(n.getDom(),t)?!1:this._bakQueryAutoHide(t)}),this.getDom().style.tabIndex="-1",i.makeUnselectable(this.getDom()),this.Stateful_postRender()},delayShowSubMenu:function(){var n=this;n.isDisabled()||(n.addState("opened"),clearTimeout(n._showingTimer),clearTimeout(n._closingTimer),n._closingTimer=null,n._showingTimer=setTimeout(function(){n.showSubMenu()},250))},delayHideSubMenu:function(){var n=this;n.isDisabled()||(n.removeState("opened"),clearTimeout(n._showingTimer),n._closingTimer||(n._closingTimer=setTimeout(function(){n.hasState("opened")||n.hideSubMenu(),n._closingTimer=null},400)))},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(n){if(this.subMenu&&this.hasState("opened"))return this.subMenu.queryAutoHide(n)},_onClick:function(n,i){if(this.hasState("disabled"))return;this.fireEvent("click",n,i)!==!1&&(this.subMenu?this.showSubMenu():t.postHide(n))},showSubMenu:function(){var n=i.getClientRect(this.getDom());n.right-=5,n.left+=2,n.width-=7,n.top-=4,n.bottom+=4,n.height+=8,this.subMenu.showAnchorRect(n,!0,!0)},hideSubMenu:function(){this.subMenu.hide()}},e.inherits(n,o),e.extend(n.prototype,h,!0)})(),(function(){var i=u.editor.utils,r=u.editor.ui.uiUtils,f=u.editor.ui.Menu,n=u.editor.ui.SplitButton,t=u.editor.ui.Combox=function(n){this.initOptions(n),this.initCombox()};t.prototype={uiName:"combox",onbuttonclick:function(){this.showPopup()},initCombox:function(){var i=this,n,t;for(this.items=this.items||[],n=0;n<this.items.length;n++)t=this.items[n],t.uiName="listitem",t.index=n,t.onclick=function(){i.selectByIndex(this.index)};this.popup=new f({items:this.items,uiName:"list",editor:this.editor,captureWheel:!0,combox:this}),this.initSplitButton()},_SplitButton_postRender:n.prototype.postRender,postRender:function(){this._SplitButton_postRender(),this.setLabel(this.label||""),this.setValue(this.initValue||"")},showPopup:function(){var n=r.getClientRect(this.getDom());n.top+=1,n.bottom-=1,n.height-=2,this.popup.showAnchorRect(n)},getValue:function(){return this.value},setValue:function(n){var t=this.indexByValue(n);t!=-1?(this.selectedIndex=t,this.setLabel(this.items[t].label),this.value=this.items[t].value):(this.selectedIndex=-1,this.setLabel(this.getLabelForUnknowValue(n)),this.value=n)},setLabel:function(n){this.getDom("button_body").innerHTML=n,this.label=n},getLabelForUnknowValue:function(n){return n},indexByValue:function(n){for(var t=0;t<this.items.length;t++)if(n==this.items[t].value)return t;return-1},getItem:function(n){return this.items[n]},selectByIndex:function(n){n<this.items.length&&this.fireEvent("select",n)!==!1&&(this.selectedIndex=n,this.value=this.items[n].value,this.setLabel(this.items[n].label))}},i.inherits(t,n)})(),(function(){var i=u.editor.utils,t=u.editor.dom.domUtils,n=u.editor.ui.uiUtils,s=u.editor.ui.Mask,c=u.editor.ui.UIBase,r=u.editor.ui.Button,h=u.editor.ui.Dialog=function(n){if(n.name){var r=n.name,t=n.cssRules;n.className||(n.className="edui-for-"+r),t&&(n.cssRules=".edui-default .edui-for-"+r+" .edui-dialog-content  {"+t+"}")}this.initOptions(i.extend({autoReset:!0,draggable:!0,onok:function(){},oncancel:function(){},onclose:function(n,t){return t?this.onok():this.oncancel()},holdScroll:!1},n)),this.initDialog()},e,o,f;h.prototype={draggable:!1,uiName:"dialog",initDialog:function(){var u=this,t=this.editor.options.theme,n;this.cssRules&&i.cssRule("edui-customize-"+this.name+"-style",this.cssRules),this.initUIBase(),this.modalMask=e||(e=new s({className:"edui-dialog-modalmask",theme:t,onclick:function(){f&&f.close(!1)}})),this.dragMask=o||(o=new s({className:"edui-dialog-dragmask",theme:t})),this.closeButton=new r({className:"edui-dialog-closebutton",title:u.closeDialog,theme:t,onclick:function(){u.close(!1)}}),this.fullscreen&&this.initResizeEvent();if(this.buttons)for(n=0;n<this.buttons.length;n++)this.buttons[n]instanceof r||(this.buttons[n]=new r(i.extend(this.buttons[n],{editor:this.editor},!0)))},initResizeEvent:function(){var i=this;t.on(window,"resize",function(){if(i._hidden||i._hidden===undefined)return;i.__resizeTimer&&window.clearTimeout(i.__resizeTimer),i.__resizeTimer=window.setTimeout(function(){i.__resizeTimer=null;var r=i.getDom(),u=i.getDom("content"),f=UE.ui.uiUtils.getClientRect(r),e=UE.ui.uiUtils.getClientRect(u),t=n.getViewportRect();u.style.width=t.width-f.width+e.width+"px",u.style.height=t.height-f.height+e.height+"px",r.style.width=t.width+"px",r.style.height=t.height+"px",i.fireEvent("resize")},100)})},fitSize:function(){var t=this.getDom("body"),n=this.mesureSize();return t.style.width=n.width+"px",t.style.height=n.height+"px",n},safeSetOffset:function(t){var o=this,e=o.getDom(),u=n.getViewportRect(),i=n.getClientRect(e),f=t.left,r;f+i.width>u.right&&(f=u.right-i.width),r=t.top,r+i.height>u.bottom&&(r=u.bottom-i.height),e.style.left=Math.max(f,0)+"px",e.style.top=Math.max(r,0)+"px"},showAtCenter:function(){var r=n.getViewportRect(),i,u,f,e;if(this.fullscreen)i=this.getDom(),u=this.getDom("content"),i.style.display="block",f=UE.ui.uiUtils.getClientRect(i),e=UE.ui.uiUtils.getClientRect(u),i.style.left="-100000px",u.style.width=r.width-f.width+e.width+"px",u.style.height=r.height-f.height+e.height+"px",i.style.width=r.width+"px",i.style.height=r.height+"px",i.style.left=0,this._originalContext={html:{overflowX:document.documentElement.style.overflowX,overflowY:document.documentElement.style.overflowY},body:{overflowX:document.body.style.overflowX,overflowY:document.body.style.overflowY}},document.documentElement.style.overflowX="hidden",document.documentElement.style.overflowY="hidden",document.body.style.overflowX="hidden",document.body.style.overflowY="hidden";else{this.getDom().style.display="";var s=this.fitSize(),o=this.getDom("titlebar").offsetHeight|0,l=r.width/2-s.width/2,c=r.height/2-(s.height-o)/2-o,h=this.getDom();this.safeSetOffset({left:Math.max(l|0,0),top:Math.max(c|0,0)}),t.hasClass(h,"edui-state-centered")||(h.className+=" edui-state-centered")}this._show()},getContentHtml:function(){var n="";return typeof this.content=="string"?n=this.content:this.iframeUrl&&(n='<span id="'+this.id+'_contmask" class="dialogcontmask"></span><iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>'),n},getHtmlTpl:function(){var i="",t,n;if(this.buttons){for(t=[],n=0;n<this.buttons.length;n++)t[n]=this.buttons[n].renderHtml();i='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+t.join("")+"</div></div>"}return'<div id="##" class="%%"><div '+(this.fullscreen?'class="%%-wrap edui-dialog-fullscreen-flag"':'class="%%"')+'><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span></div>"+this.closeButton.renderHtml()+'</div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+i+"</div></div></div>"},postRender:function(){var i,r;this.modalMask.getDom()||(this.modalMask.render(),this.modalMask.hide()),this.dragMask.getDom()||(this.dragMask.render(),this.dragMask.hide()),i=this,this.addListener("show",function(){i.modalMask.show(this.getDom().style.zIndex-2)}),this.addListener("hide",function(){i.modalMask.hide()});if(this.buttons)for(r=0;r<this.buttons.length;r++)this.buttons[r].postRender();t.on(window,"resize",function(){setTimeout(function(){i.isHidden()||i.safeSetOffset(n.getClientRect(i.getDom()))})});this._hide()},mesureSize:function(){var t=this.getDom("body"),r=n.getClientRect(this.getDom("content")).width,i=t.style;return i.width=r,n.getClientRect(t)},_onTitlebarMouseDown:function(i){if(this.draggable){var f,e=n.getViewportRect(),u=this;n.startDrag(i,{ondragstart:function(){f=n.getClientRect(u.getDom()),u.getDom("contmask").style.visibility="visible",u.dragMask.show(u.getDom().style.zIndex-1)},ondragmove:function(n,t){var r=f.left+n,i=f.top+t;u.safeSetOffset({left:r,top:i})},ondragstop:function(){u.getDom("contmask").style.visibility="hidden",t.removeClasses(u.getDom(),["edui-state-centered"]),u.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml(),this.fireEvent("dialogafterreset")},_show:function(){this._hidden&&(this.getDom().style.display="",this.editor.container.style.zIndex&&(this.getDom().style.zIndex=this.editor.container.style.zIndex*1+10),this._hidden=!1,this.fireEvent("show"),u.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4)},isHidden:function(){return this._hidden},_hide:function(){if(!this._hidden){var n=this.getDom();n.style.display="none",n.style.zIndex="",n.style.width="",n.style.height="",this._hidden=!0,this.fireEvent("hide")}},open:function(){if(this.autoReset)try{this.reset()}catch(t){this.render(),this.open()}this.showAtCenter();if(this.iframeUrl)try{this.getDom("iframe").focus()}catch(n){}f=this},_onCloseButtonClick:function(){this.close(!1)},close:function(n){var u,i,r;this.fireEvent("close",n)!==!1&&(this.fullscreen&&(document.documentElement.style.overflowX=this._originalContext.html.overflowX,document.documentElement.style.overflowY=this._originalContext.html.overflowY,document.body.style.overflowX=this._originalContext.body.overflowX,document.body.style.overflowY=this._originalContext.body.overflowY,delete this._originalContext),this._hide(),u=this.getDom("content"),i=this.getDom("iframe"),u&&i&&(r=i.contentDocument||i.contentWindow.document,r&&(r.body.innerHTML=""),t.remove(u)))}},i.inherits(h,c)})(),(function(){var t=u.editor.utils,r=u.editor.ui.Menu,i=u.editor.ui.SplitButton,n=u.editor.ui.MenuButton=function(n){this.initOptions(n),this.initMenuButton()};n.prototype={initMenuButton:function(){var n=this;this.uiName="menubutton",this.popup=new r({items:n.items,className:n.className,editor:n.editor}),this.popup.addListener("show",function(){for(var i=this,t=0;t<i.items.length;t++)i.items[t].removeState("checked"),i.items[t].value==n._value&&(i.items[t].addState("checked"),this.value=n._value)}),this.initSplitButton()},setValue:function(n){this._value=n}},t.inherits(n,i)})(),(function(){var t=u.editor.utils,r=u.editor.ui.Popup,i=u.editor.ui.SplitButton,n=u.editor.ui.MultiMenuPop=function(n){this.initOptions(n),this.initMultiMenu()};n.prototype={initMultiMenu:function(){var n=this;this.popup=new r({content:"",editor:n.editor,iframe_rendered:!1,onshow:function(){this.iframe_rendered||(this.iframe_rendered=!0,this.getDom("content").innerHTML='<iframe id="'+n.id+'_iframe" src="'+n.iframeUrl+'" frameborder="0"></iframe>',n.editor.container.style.zIndex&&(this.getDom().style.zIndex=n.editor.container.style.zIndex*1+1))}}),this.onbuttonclick=function(){this.showPopup()},this.initSplitButton()}},t.inherits(n,i)})(),(function(){function o(t){var f=t.target||t.srcElement,u=n.findParent(f,function(t){return n.hasClass(t,"edui-shortcutmenu")||n.hasClass(t,"edui-popup")},!0),i,r;if(!u)for(i=0;r=h[i++];)r.hide()}var t=u.editor.ui,l=t.UIBase,s=t.uiUtils,f=u.editor.utils,n=u.editor.dom.domUtils,h=[],c,i=!1,e=t.ShortCutMenu=function(n){this.initOptions(n),this.initShortCutMenu()};e.postHide=o,e.prototype={isHidden:!0,SPACE:5,initShortCutMenu:function(){this.items=this.items||[],this.initUIBase(),this.initItems(),this.initEvent(),h.push(this)},initEvent:function(){var t=this,u=t.editor.document;n.on(u,"mousemove",function(n){if(t.isHidden===!1){if(t.getSubMenuMark()||t.eventType=="contextmenu")return;var o=!0,u=t.getDom(),h=u.offsetWidth,s=u.offsetHeight,e=h/2+t.SPACE,f=s/2,r=Math.abs(n.screenX-t.left),i=Math.abs(n.screenY-t.top);clearTimeout(c),c=setTimeout(function(){i>0&&i<f?t.setOpacity(u,"1"):i>f&&i<f+70?(t.setOpacity(u,"0.5"),o=!1):i>f+70&&i<f+140&&t.hide(),o&&r>0&&r<e?t.setOpacity(u,"1"):r>e&&r<e+70?t.setOpacity(u,"0.5"):r>e+70&&r<e+140&&t.hide()})}});if(r.chrome)n.on(u,"mouseout",function(n){var i=n.relatedTarget||n.toElement;(i==null||i.tagName=="HTML")&&t.hide()});t.editor.addListener("afterhidepop",function(){t.isHidden||(i=!0)})},initItems:function(){var n,r,i;if(f.isArray(this.items))for(n=0,r=this.items.length;n<r;n++)i=this.items[n].toLowerCase(),t[i]&&(this.items[n]=new t[i](this.editor),this.items[n].className+=" edui-shortcutsubmenu ")},setOpacity:function(n,t){r.ie&&r.version<9?n.style.filter="alpha(opacity = "+parseFloat(t)*100+");":n.style.opacity=t},getSubMenuMark:function(){var u,f,t,r;for(i=!1,u=s.getFixedLayer(),f=n.getElementsByTagName(u,"div",function(t){return n.hasClass(t,"edui-shortcutsubmenu edui-popup")}),t=0;r=f[t++];)r.style.display!="none"&&(i=!0);return i},show:function(t,i){function o(n){n.left<0&&(n.left=0),n.top<0&&(n.top=0),u.style.cssText="position:absolute;left:"+n.left+"px;top:"+n.top+"px;"}function h(n){n.tagName||(n=n.getDom()),f.left=parseInt(n.style.left),f.top=parseInt(n.style.top),f.top-=u.offsetHeight+15,o(f)}var r=this,f={},u=this.getDom(),c=s.getFixedLayer(),e;r.eventType=t.type,u.style.cssText="display:block;left:-9999px",t.type=="contextmenu"&&i?(e=n.getElementsByTagName(c,"div","edui-contextmenu")[0],e?h(e):r.editor.addListener("aftershowcontextmenu",function(n,t){h(t)})):(f=s.getViewportOffsetByEvent(t),f.top-=u.offsetHeight+r.SPACE,f.left+=r.SPACE+20,o(f),r.setOpacity(u,.2)),r.isHidden=!1,r.left=t.screenX+u.offsetWidth/2-r.SPACE,r.top=t.screenY-u.offsetHeight/2-r.SPACE,r.editor&&(u.style.zIndex=r.editor.container.style.zIndex*1+10,c.style.zIndex=u.style.zIndex-1)},hide:function(){this.getDom()&&(this.getDom().style.display="none"),this.isHidden=!0},postRender:function(){if(f.isArray(this.items))for(var t=0,n;n=this.items[t++];)n.postRender()},getHtmlTpl:function(){var n,t;if(f.isArray(this.items)){for(n=[],t=0;t<this.items.length;t++)n[t]=this.items[t].renderHtml();n=n.join("")}else n=this.items;return'<div id="##" class="%% edui-toolbar" data-src="shortcutmenu" onmousedown="return false;" onselectstart="return false;" >'+n+"</div>"}},f.inherits(e,l);n.on(document,"mousedown",function(n){o(n)});n.on(window,"scroll",function(n){o(n)})})(),(function(){var t=u.editor.utils,i=u.editor.ui.UIBase,n=u.editor.ui.Breakline=function(n){this.initOptions(n),this.initSeparator()};n.prototype={uiName:"Breakline",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return"<br/>"}},t.inherits(n,i)})(),(function(){var t=u.editor.utils,r=u.editor.dom.domUtils,i=u.editor.ui.UIBase,n=u.editor.ui.Message=function(n){this.initOptions(n),this.initMessage()};n.prototype={initMessage:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-message %%"> <div id="##_closer" class="edui-message-closer">\u00d7</div> <div id="##_body" class="edui-message-body edui-message-type-info"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-message-content">  </div> </div></div>'},reset:function(n){var t=this;n.keepshow||(clearTimeout(this.timer),t.timer=setTimeout(function(){t.hide()},n.timeout||4e3)),n.content!==undefined&&t.setContent(n.content),n.type!==undefined&&t.setType(n.type),t.show()},postRender:function(){var t=this,n=this.getDom("closer");n&&r.on(n,"click",function(){t.hide()})},setContent:function(n){this.getDom("content").innerHTML=n},setType:function(n){n=n||"info";var t=this.getDom("body");t.className=t.className.replace(/edui-message-type-[\w-]+/,"edui-message-type-"+n)},getContent:function(){return this.getDom("content").innerHTML},getType:function(){var n=this.getDom("body").match(/edui-message-type-([\w-]+)/);return n?n[1]:""},show:function(){this.getDom().style.display="block"},hide:function(){var n=this.getDom();n&&(n.style.display="none",n.parentNode&&n.parentNode.removeChild(n))}},t.inherits(n,i)})(),(function(){var f=u.editor.utils,n=u.editor.ui,b=n.Dialog,o,y,h,e,t,s,i,p,w,l,c,v,a;for(n.buttons={},n.Dialog=function(n){var t=new b(n);return t.addListener("hide",function(){var n,u,i;if(t.editor){n=t.editor;try{r.gecko?(u=n.window.scrollY,i=n.window.scrollX,n.body.focus(),n.window.scrollTo(i,u)):n.focus()}catch(f){}}}),t},o={anchor:"~/dialogs/anchor/anchor.html",insertimage:"~/dialogs/image/image.html",link:"~/dialogs/link/link.html",spechars:"~/dialogs/spechars/spechars.html",searchreplace:"~/dialogs/searchreplace/searchreplace.html",map:"~/dialogs/map/map.html",gmap:"~/dialogs/gmap/gmap.html",insertvideo:"~/dialogs/video/video.html",help:"~/dialogs/help/help.html",preview:"~/dialogs/preview/preview.html",emotion:"~/dialogs/emotion/emotion.html",wordimage:"~/dialogs/wordimage/wordimage.html",attachment:"~/dialogs/attachment/attachment.html",insertframe:"~/dialogs/insertframe/insertframe.html",edittip:"~/dialogs/table/edittip.html",edittable:"~/dialogs/table/edittable.html",edittd:"~/dialogs/table/edittd.html",webapp:"~/dialogs/webapp/webapp.html",snapscreen:"~/dialogs/snapscreen/snapscreen.html",scrawl:"~/dialogs/scrawl/scrawl.html",music:"~/dialogs/music/music.html",template:"~/dialogs/template/template.html",background:"~/dialogs/background/background.html",charts:"~/dialogs/charts/charts.html"},y=["undo","redo","formatmatch","bold","italic","underline","fontborder","touppercase","tolowercase","strikethrough","subscript","superscript","source","indent","outdent","blockquote","pasteplain","pagebreak","selectall","print","horizontal","removeformat","time","date","unlink","insertparagraphbeforetable","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","mergecells","deletetable","drafts"],e=0;t=y[e++];)t=t.toLowerCase(),n[t]=function(t){return function(i){var r=new n.Button({className:"edui-for-"+t,title:i.options.labelMap[t]||i.getLang("labelMap."+t)||"",onclick:function(){i.execCommand(t)},theme:i.options.theme,showText:!1});return n.buttons[t]=r,i.addListener("selectionchange",function(n,u,f){var e=i.queryCommandState(t);e==-1?(r.setDisabled(!0),r.setChecked(!1)):f||(r.setDisabled(!1),r.setChecked(e))}),r}}(t);n.cleardoc=function(t){var i=new n.Button({className:"edui-for-cleardoc",title:t.options.labelMap.cleardoc||t.getLang("labelMap.cleardoc")||"",theme:t.options.theme,onclick:function(){confirm(t.getLang("confirmClear"))&&t.execCommand("cleardoc")}});return n.buttons.cleardoc=i,t.addListener("selectionchange",function(){i.setDisabled(t.queryCommandState("cleardoc")==-1)}),i},n.dzzfile=function(t){var i=new n.Button({className:"edui-for-dzzfile",title:t.options.labelMap.dzzfile||t.getLang("labelMap.dzzfile")||"",theme:t.options.theme,onclick:function(){t.execCommand("dzzfile")}});return n.buttons.dzzfile=i,t.addListener("selectionchange",function(){i.setDisabled(t.queryCommandState("dzzfile")==-1)}),i},n.insertcharts=function(t){var i=new n.Button({className:"edui-for-insertcharts",title:t.options.labelMap.insertcharts||t.getLang("labelMap.insertcharts")||"",theme:t.options.theme,onclick:function(){var n=t.options.chartsTmpl||'<table data-chart="title:\u5b63\u5ea6\u9500\u552e\u62a5\u8868;subTitle:;xTitle:\u6708\u4efd;yTitle:\u91d1\u989d\uff08\u5143\uff09;suffix:\u5143;tip:;dataFormat:1;chartType:4"><tbody><tr><th width="90"><br></th><th width="90">1\u6708</th><th width="90">2\u6708</th><th width="90">3\u6708</th></tr><tr><th valign="null" width="90">\u90e8\u95e81</th><td valign="top" width="55">24593</td><td valign="top" width="55">24308</td><td valign="top" width="55">24932</td></tr><tr><th valign="null" width="90">\u90e8\u95e82</th><td valign="top" width="55">13658</td><td valign="top" width="55">16541</td><td valign="top" width="55">13600</td></tr><tr><th valign="null" width="90">\u90e8\u95e83</th><td valign="top" width="55">9980</td><td valign="top" width="55">89700</td><td valign="top" width="55">12380</td></tr></tbody></table>';t.execCommand("insertHtml",n)}});return n.buttons.insertcharts=i,t.addListener("selectionchange",function(){i.setDisabled(t.queryCommandState("insertcharts")==-1)}),i},h={justify:["left","right","center","justify"],imagefloat:["none","left","center","right"],directionality:["ltr","rtl"]};for(i in h)(function(t,i){for(var u=0,r;r=i[u++];)(function(i){n[t.replace("float","")+i]=function(r){var u=new n.Button({className:"edui-for-"+t.replace("float","")+i,title:r.options.labelMap[t.replace("float","")+i]||r.getLang("labelMap."+t.replace("float","")+i)||"",theme:r.options.theme,onclick:function(){r.execCommand(t,i)}});return n.buttons[t]=u,r.addListener("selectionchange",function(n,f,e){u.setDisabled(r.queryCommandState(t)==-1),u.setChecked(r.queryCommandValue(t)==i&&!e)}),u}})(r)})(i,h[i]);for(e=0;t=(["backcolor","forecolor"])[e++];)n[t]=function(t){return function(i){var r=new n.ColorButton({className:"edui-for-"+t,color:"default",title:i.options.labelMap[t]||i.getLang("labelMap."+t)||"",editor:i,onpickcolor:function(n,r){i.execCommand(t,r)},onpicknocolor:function(){i.execCommand(t,"default"),this.setColor("transparent"),this.color="default"},onbuttonclick:function(){i.execCommand(t,this.color)}});return n.buttons[t]=r,i.addListener("selectionchange",function(){r.setDisabled(i.queryCommandState(t)==-1)}),r}}(t);s={noOk:["searchreplace","help","spechars","webapp","preview"],ok:["attachment","anchor","link","insertimage","map","gmap","insertframe","wordimage","insertvideo","insertframe","edittip","edittable","edittd","scrawl","template","music","background","charts"]};for(i in s)(function(t,i){for(var e=0,u;u=i[e++];){if(r.opera&&u==="searchreplace")continue;(function(i){n[i]=function(r,u,e){var s,h;return u=u||(r.options.iframeUrlMap||{})[i]||o[i],e=r.options.labelMap[i]||r.getLang("labelMap."+i)||"",u&&(s=new n.Dialog(f.extend({iframeUrl:r.ui.mapUrl(u),editor:r,className:"edui-for-"+i,title:e,holdScroll:i==="insertimage",fullscreen:/charts|preview/.test(i),closeDialog:r.getLang("closeDialog")},t=="ok"?{buttons:[{className:"edui-okbutton",label:r.getLang("ok"),editor:r,onclick:function(){s.close(!0)}},{className:"edui-cancelbutton",label:r.getLang("cancel"),editor:r,onclick:function(){s.close(!1)}}]}:{})),r.ui._dialogs[i+"Dialog"]=s),h=new n.Button({className:"edui-for-"+i,title:e,onclick:function(){if(s)switch(i){case"wordimage":var n=r.execCommand("wordimage");n&&n.length&&(s.render(),s.open());break;case"scrawl":r.queryCommandState("scrawl")!=-1&&(s.render(),s.open());break;default:s.render(),s.open()}},theme:r.options.theme,disabled:i=="scrawl"&&r.queryCommandState("scrawl")==-1||i=="charts"}),n.buttons[i]=h,r.addListener("selectionchange",function(){var t={edittable:1},n;if(i in t)return;n=r.queryCommandState(i),h.getDom()&&(h.setDisabled(n==-1),h.setChecked(n))}),h}})(u.toLowerCase())}})(i,s[i]);for(n.snapscreen=function(t,i,r){var f,u;return r=t.options.labelMap.snapscreen||t.getLang("labelMap.snapscreen")||"",f=new n.Button({className:"edui-for-snapscreen",title:r,onclick:function(){t.execCommand("snapscreen")},theme:t.options.theme}),n.buttons.snapscreen=f,i=i||(t.options.iframeUrlMap||{}).snapscreen||o.snapscreen,i&&(u=new n.Dialog({iframeUrl:t.ui.mapUrl(i),editor:t,className:"edui-for-snapscreen",title:r,buttons:[{className:"edui-okbutton",label:t.getLang("ok"),editor:t,onclick:function(){u.close(!0)}},{className:"edui-cancelbutton",label:t.getLang("cancel"),editor:t,onclick:function(){u.close(!1)}}]}),u.render(),t.ui._dialogs.snapscreenDialog=u),t.addListener("selectionchange",function(){f.setDisabled(t.queryCommandState("snapscreen")==-1)}),f},n.insertcode=function(t,i,r){var e,u;return i=t.options.insertcode||[],r=t.options.labelMap.insertcode||t.getLang("labelMap.insertcode")||"",e=[],f.each(i,function(n,i){e.push({label:n,value:i,theme:t.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" >'+(this.label||"")+"</div>"}})}),u=new n.Combox({editor:t,items:e,onselect:function(n,i){t.execCommand("insertcode",this.items[i].value)},onbuttonclick:function(){this.showPopup()},title:r,initValue:r,className:"edui-for-insertcode",indexByValue:function(n){if(n)for(var t=0,i;i=this.items[t];t++)if(i.value.indexOf(n)!=-1)return t;return-1}}),n.buttons.insertcode=u,t.addListener("selectionchange",function(n,i,f){var o,e;if(!f){o=t.queryCommandState("insertcode");if(o==-1)u.setDisabled(!0);else{u.setDisabled(!1),e=t.queryCommandValue("insertcode");if(!e){u.setValue(r);return}e&&(e=e.replace(/['"]/g,"").split(",")[0]),u.setValue(e)}}}),u},n.fontfamily=function(t,i,r){var o,e,s,h,u;i=t.options.fontfamily||[],r=t.options.labelMap.fontfamily||t.getLang("labelMap.fontfamily")||"";if(!i.length)return;for(o=0,s=[];e=i[o];o++)h=t.getLang("fontfamily")[e.name]||"",(function(n,i){s.push({label:n,value:i,theme:t.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+f.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})})(e.label||h,e.val);return u=new n.Combox({editor:t,items:s,onselect:function(n,i){t.execCommand("FontFamily",this.items[i].value)},onbuttonclick:function(){this.showPopup()},title:r,initValue:r,className:"edui-for-fontfamily",indexByValue:function(n){if(n)for(var t=0,i;i=this.items[t];t++)if(i.value.indexOf(n)!=-1)return t;return-1}}),n.buttons.fontfamily=u,t.addListener("selectionchange",function(n,i,r){var e,f;r||(e=t.queryCommandState("FontFamily"),e==-1?u.setDisabled(!0):(u.setDisabled(!1),f=t.queryCommandValue("FontFamily"),f&&(f=f.replace(/['"]/g,"").split(",")[0]),u.setValue(f)))}),u},n.fontsize=function(t,i,r){var e,f,o,u;r=t.options.labelMap.fontsize||t.getLang("labelMap.fontsize")||"",i=i||t.options.fontsize||[];if(!i.length)return;for(e=[],f=0;f<i.length;f++)o=i[f]+"px",e.push({label:o,value:o,theme:t.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||"")+"</div>"}});return u=new n.Combox({editor:t,items:e,title:r,initValue:r,onselect:function(n,i){t.execCommand("FontSize",this.items[i].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"}),n.buttons.fontsize=u,t.addListener("selectionchange",function(n,i,r){if(!r){var f=t.queryCommandState("FontSize");f==-1?u.setDisabled(!0):(u.setDisabled(!1),u.setValue(t.queryCommandValue("FontSize")))}}),u},n.paragraph=function(t,i,r){var o,e,u;r=t.options.labelMap.paragraph||t.getLang("labelMap.paragraph")||"",i=t.options.paragraph||[];if(f.isEmptyObject(i))return;o=[];for(e in i)o.push({value:e,label:i[e]||t.getLang("paragraph")[e],theme:t.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}});return u=new n.Combox({editor:t,items:o,title:r,initValue:r,className:"edui-for-paragraph",onselect:function(n,i){t.execCommand("Paragraph",this.items[i].value)},onbuttonclick:function(){this.showPopup()}}),n.buttons.paragraph=u,t.addListener("selectionchange",function(n,i,r){var o,f,e;r||(o=t.queryCommandState("Paragraph"),o==-1?u.setDisabled(!0):(u.setDisabled(!1),f=t.queryCommandValue("Paragraph"),e=u.indexByValue(f),e!=-1?u.setValue(f):u.setValue(u.initValue)))}),u},n.customstyle=function(t){var o=t.options.customstyle||[],e=t.options.labelMap.customstyle||t.getLang("labelMap.customstyle")||"",u,s,r,f,i;if(!o.length)return;for(u=t.getLang("customstyle"),s=0,r=[];f=o[s++];)(function(n){var i={};i.label=n.label?n.label:u[n.name],i.style=n.style,i.className=n.className,i.tag=n.tag,r.push({label:i.label,value:i,theme:t.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+i.tag+" "+(i.className?' class="'+i.className+'"':"")+(i.style?' style="'+i.style+'"':"")+">"+i.label+"</"+i.tag+"></div>"}})})(f);return i=new n.Combox({editor:t,items:r,title:e,initValue:e,className:"edui-for-customstyle",onselect:function(n,i){t.execCommand("customstyle",this.items[i].value)},onbuttonclick:function(){this.showPopup()},indexByValue:function(n){for(var i=0,t;t=this.items[i++];)if(t.label==n)return i-1;return-1}}),n.buttons.customstyle=i,t.addListener("selectionchange",function(n,r,u){var o,f,e;u||(o=t.queryCommandState("customstyle"),o==-1?i.setDisabled(!0):(i.setDisabled(!1),f=t.queryCommandValue("customstyle"),e=i.indexByValue(f),e!=-1?i.setValue(f):i.setValue(i.initValue)))}),i},n.inserttable=function(t,i,r){r=t.options.labelMap.inserttable||t.getLang("labelMap.inserttable")||"";var u=new n.TableButton({editor:t,title:r,className:"edui-for-inserttable",onpicktable:function(n,i,r){t.execCommand("InsertTable",{numRows:r,numCols:i,border:1})},onbuttonclick:function(){this.showPopup()}});return n.buttons.inserttable=u,t.addListener("selectionchange",function(){u.setDisabled(t.queryCommandState("inserttable")==-1)}),u},n.lineheight=function(t){var e=t.options.lineheight||[],f,u,r,i;if(!e.length)return;for(f=0,r=[];u=e[f++];)r.push({label:u,value:u,theme:t.options.theme,onclick:function(){t.execCommand("lineheight",this.value)}});return i=new n.MenuButton({editor:t,className:"edui-for-lineheight",title:t.options.labelMap.lineheight||t.getLang("labelMap.lineheight")||"",items:r,onbuttonclick:function(){var n=t.queryCommandValue("LineHeight")||this.value;t.execCommand("LineHeight",n)}}),n.buttons.lineheight=i,t.addListener("selectionchange",function(){var r=t.queryCommandState("LineHeight"),n;r==-1?i.setDisabled(!0):(i.setDisabled(!1),n=t.queryCommandValue("LineHeight"),n&&i.setValue((n+"").replace(/cm/,"")),i.setChecked(r))}),i},p=["top","bottom"],w=0;l=p[w++];)(function(t){n["rowspacing"+t]=function(i){var o=i.options["rowspacing"+t]||[],e,f,u,r;if(!o.length)return null;for(e=0,u=[];f=o[e++];)u.push({label:f,value:f,theme:i.options.theme,onclick:function(){i.execCommand("rowspacing",this.value,t)}});return r=new n.MenuButton({editor:i,className:"edui-for-rowspacing"+t,title:i.options.labelMap["rowspacing"+t]||i.getLang("labelMap.rowspacing"+t)||"",items:u,onbuttonclick:function(){var n=i.queryCommandValue("rowspacing",t)||this.value;i.execCommand("rowspacing",n,t)}}),n.buttons[t]=r,i.addListener("selectionchange",function(){var u=i.queryCommandState("rowspacing",t),n;u==-1?r.setDisabled(!0):(r.setDisabled(!1),n=i.queryCommandValue("rowspacing",t),n&&r.setValue((n+"").replace(/%/,"")),r.setChecked(u))}),r}})(l);for(c=["insertorderedlist","insertunorderedlist"],v=0;a=c[v++];)(function(t){n[t]=function(i){var e=i.options[t],o=function(){i.execCommand(t,this.value)},f=[],u,r;for(u in e)f.push({label:e[u]||i.getLang()[t][u]||"",value:u,theme:i.options.theme,onclick:o});return r=new n.MenuButton({editor:i,className:"edui-for-"+t,title:i.getLang("labelMap."+t)||"",items:f,onbuttonclick:function(){var n=i.queryCommandValue(t)||this.value;i.execCommand(t,n)}}),n.buttons[t]=r,i.addListener("selectionchange",function(){var u=i.queryCommandState(t),n;u==-1?r.setDisabled(!0):(r.setDisabled(!1),n=i.queryCommandValue(t),r.setValue(n),r.setChecked(u))}),r}})(a);n.fullscreen=function(t,i){i=t.options.labelMap.fullscreen||t.getLang("labelMap.fullscreen")||"";var r=new n.Button({className:"edui-for-fullscreen",title:i,theme:t.options.theme,onclick:function(){t.ui&&t.ui.setFullScreen(!t.ui.isFullScreen()),this.setChecked(t.ui.isFullScreen())}});return n.buttons.fullscreen=r,t.addListener("selectionchange",function(){var n=t.queryCommandState("fullscreen");r.setDisabled(n==-1),r.setChecked(t.ui.isFullScreen())}),r},n.emotion=function(t,i){var r="emotion",u=new n.MultiMenuPop({title:t.options.labelMap[r]||t.getLang("labelMap."+r+"")||"",editor:t,className:"edui-for-"+r,iframeUrl:t.ui.mapUrl(i||(t.options.iframeUrlMap||{})[r]||o[r])});return n.buttons[r]=u,t.addListener("selectionchange",function(){u.setDisabled(t.queryCommandState(r)==-1)}),u},n.autotypeset=function(t){var i=new n.AutoTypeSetButton({editor:t,title:t.options.labelMap.autotypeset||t.getLang("labelMap.autotypeset")||"",className:"edui-for-autotypeset",onbuttonclick:function(){t.execCommand("autotypeset")}});return n.buttons.autotypeset=i,t.addListener("selectionchange",function(){i.setDisabled(t.queryCommandState("autotypeset")==-1)}),i},n.simpleupload=function(t){var r="simpleupload",i=new n.Button({className:"edui-for-"+r,title:t.options.labelMap[r]||t.getLang("labelMap."+r)||"",onclick:function(){},theme:t.options.theme,showText:!1});return n.buttons[r]=i,t.addListener("ready",function(){var r=i.getDom("body"),n=r.children[0];t.fireEvent("simpleuploadbtnready",n)}),t.addListener("selectionchange",function(n,u,f){var e=t.queryCommandState(r);e==-1?(i.setDisabled(!0),i.setChecked(!1)):f||(i.setDisabled(!1),i.setChecked(e))}),i}})(),(function(){function f(n){this.initOptions(n),this.initEditorUI()}var i=u.editor.utils,s=u.editor.ui.uiUtils,o=u.editor.ui.UIBase,n=u.editor.dom.domUtils,e=[],t;f.prototype={uiName:"editor",initEditorUI:function(){function s(n,t){var i;n.setOpt({wordCount:!0,maximumWords:1e4,wordCountMsg:n.options.wordCountMsg||n.getLang("wordCountMsg"),wordOverFlowMsg:n.options.wordOverFlowMsg||n.getLang("wordOverFlowMsg")});var r=n.options,f=r.maximumWords,o=r.wordCountMsg,e=r.wordOverFlowMsg,u=t.getDom("wordcount");if(!r.wordCount)return;i=n.getContentLength(!0),i>f?(u.innerHTML=e,n.fireEvent("wordcountoverflow")):u.innerHTML=o.replace("{#leave}",f-i).replace("{#count}",i)}var t,f,r,e,o,i;this.editor.ui=this,this._dialogs={},this.initUIBase(),this._initToolbars(),t=this.editor,f=this,t.addListener("ready",function(){t.getDialog=function(n){return t.ui._dialogs[n+"Dialog"]};n.on(t.window,"scroll",function(n){u.editor.ui.Popup.postHide(n)});t.ui._actualFrameWidth=t.options.initialFrameWidth,UE.browser.ie&&UE.browser.version===6&&t.container.ownerDocument.execCommand("BackgroundImageCache",!1,!0),t.options.elementPathEnabled&&(t.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">'+t.getLang("elementPathTip")+":</div>");if(t.options.wordCount){function i(){s(t,f),n.un(t.document,"click",arguments.callee)}n.on(t.document,"click",i);t.ui.getDom("wordcount").innerHTML=t.getLang("wordCountTip")}t.ui._scale(),t.options.scaleEnabled?(t.autoHeightEnabled&&t.disableAutoHeight(),f.enableScale()):f.disableScale(),!t.options.elementPathEnabled&&!t.options.wordCount&&!t.options.scaleEnabled&&(t.ui.getDom("elementpath").style.display="none",t.ui.getDom("wordcount").style.display="none",t.ui.getDom("scale").style.display="none");if(!t.selection.isFocus())return;t.fireEvent("selectionchange",!1,!0)}),t.addListener("mousedown",function(n,t){var i=t.target||t.srcElement;u.editor.ui.Popup.postHide(t,i),u.editor.ui.ShortCutMenu.postHide(t)}),t.addListener("delcells",function(){UE.ui.edittip&&new UE.ui.edittip(t),t.getDialog("edittip").open()}),e=!1,t.addListener("afterpaste",function(){if(t.queryCommandState("pasteplain"))return;u.editor.ui.PastePicker&&(r=new u.editor.ui.Popup({content:new u.editor.ui.PastePicker({editor:t}),editor:t,className:"edui-wordpastepop"}),r.render()),e=!0}),t.addListener("afterinserthtml",function(){clearTimeout(o),o=setTimeout(function(){var u,f,i;r&&(e||t.ui._isTransfer)&&(r.isHidden()?(u=n.createElement(t.document,"span",{style:"line-height:0px;",innerHTML:"\ufeff"}),f=t.selection.getRange(),f.insertNode(u),i=c(u,"firstChild","previousSibling"),i&&r.showAnchor(i.nodeType==3?i.parentNode:i),n.remove(u)):r.show(),delete t.ui._isTransfer,e=!1)},200)}),t.addListener("contextmenu",function(n,t){u.editor.ui.Popup.postHide(t)}),t.addListener("keydown",function(n,t){r&&r.dispose(t);var i=t.keyCode||t.which;t.altKey&&i==90&&UE.ui.buttons.fullscreen.onclick()}),t.addListener("wordcount",function(){s(this,f)}),t.addListener("selectionchange",function(){t.options.elementPathEnabled&&f[(t.queryCommandState("elementpath")==-1?"dis":"en")+"ableElementPath"](),t.options.scaleEnabled&&f[(t.queryCommandState("scale")==-1?"dis":"en")+"ableScale"]()}),i=new u.editor.ui.Popup({editor:t,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide(),t.ui._dialogs.linkDialog.open()},_onImgEditButtonClick:function(n){this.hide(),t.ui._dialogs[n]&&t.ui._dialogs[n].open()},_onImgSetFloat:function(n){this.hide(),t.execCommand("imagefloat",n)},_setIframeAlign:function(t){var u=i.anchorEl,r=u.cloneNode(!0);switch(t){case-2:r.setAttribute("align","");break;case-1:r.setAttribute("align","left");break;case 1:r.setAttribute("align","right")}u.parentNode.insertBefore(r,u),n.remove(u),i.anchorEl=r,i.showAnchor(i.anchorEl)},_updateIframe:function(){var r=t._iframe=i.anchorEl;n.hasClass(r,"ueditor_baidumap")?(t.selection.getRange().selectNode(r).select(),t.ui._dialogs.mapDialog.open(),i.hide()):(t.ui._dialogs.insertframeDialog.open(),i.hide())},_onRemoveButtonClick:function(n){t.execCommand(n),this.hide()},queryAutoHide:function(r){if(r&&r.ownerDocument==t.document)if(r.tagName.toLowerCase()=="img"||n.findParentByTagName(r,"a",!0))return r!==i.anchorEl;return u.editor.ui.Popup.prototype.queryAutoHide.call(this,r)}}),i.render(),t.options.imagePopup&&(t.addListener("mouseover",function(n,r){var f,u;r=r||window.event,f=r.target||r.srcElement,t.ui._dialogs.insertframeDialog&&/iframe/ig.test(f.tagName)&&(u=i.formatHtml("<nobr>"+t.getLang("property")+': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">'+t.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">'+t.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">'+t.getLang("justifyright")+'</span>&nbsp;&nbsp; <span onclick="$$._updateIframe( this);" class="edui-clickable">'+t.getLang("modify")+"</span></nobr>"),u?(i.getDom("content").innerHTML=u,i.anchorEl=f,i.showAnchor(i.anchorEl)):i.hide())}),t.addListener("selectionchange",function(r,u){var e,s,h,c;if(!u)return;var o="",l="",f=t.selection.getRange().getClosedNode(),a=t.ui._dialogs;if(f&&f.tagName=="IMG"){e="insertimageDialog",(f.className.indexOf("edui-faked-video")!=-1||f.className.indexOf("edui-upload-video")!=-1)&&(e="insertvideoDialog"),f.className.indexOf("edui-faked-webapp")!=-1&&(e="webappDialog"),f.src.indexOf("http://api.map.baidu.com")!=-1&&(e="mapDialog"),f.className.indexOf("edui-faked-music")!=-1&&(e="musicDialog"),f.src.indexOf("http://maps.google.com/maps/api/staticmap")!=-1&&(e="gmapDialog"),f.getAttribute("anchorname")&&(e="anchorDialog",o=i.formatHtml("<nobr>"+t.getLang("property")+': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">'+t.getLang("modify")+"</span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick('anchor') class=\"edui-clickable\">"+t.getLang("delete")+"</span></nobr>")),f.getAttribute("word_img")&&(t.word_img=[f.getAttribute("word_img")],e="wordimageDialog"),(n.hasClass(f,"loadingclass")||n.hasClass(f,"loaderrorclass"))&&(e="");if(!a[e])return;l="<nobr>"+t.getLang("property")+': <span onclick=$$._onImgSetFloat("none") class="edui-clickable">'+t.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">'+t.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">'+t.getLang("justifyright")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">'+t.getLang("justifycenter")+"</span>&nbsp;&nbsp;<span onclick=\"$$._onImgEditButtonClick('"+e+'\');" class="edui-clickable">'+t.getLang("modify")+"</span></nobr>",!o&&(o=i.formatHtml(l))}t.ui._dialogs.linkDialog&&(s=t.queryCommandValue("link"),s&&(h=s.getAttribute("_href")||s.getAttribute("href",2))&&(c=h,h.length>30&&(c=h.substring(0,20)+"..."),o&&(o+='<div style="height:5px;"></div>'),o+=i.formatHtml("<nobr>"+t.getLang("anthorMsg")+': <a target="_blank" href="'+h+'" title="'+h+'" >'+c+'</a> <span class="edui-clickable" onclick="$$._onEditButtonClick();">'+t.getLang("modify")+'</span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> '+t.getLang("clear")+"</span></nobr>"),i.showAnchor(s))),o?(i.getDom("content").innerHTML=o,i.anchorEl=f||s,i.showAnchor(i.anchorEl)):i.hide()}))},_initToolbars:function(){for(var f=this.editor,c=this.toolbars||[],e=[],h,r,s,n,t,o=0;o<c.length;o++){for(h=c[o],r=new u.editor.ui.Toolbar({theme:f.options.theme}),s=0;s<h.length;s++){n=h[s],t=null;if(typeof n=="string"){n=n.toLowerCase(),n=="|"&&(n="Separator"),n=="||"&&(n="Breakline"),u.editor.ui[n]&&(t=new u.editor.ui[n](f));if(n=="fullscreen"){e&&e[0]?e[0].items.splice(0,0,t):t&&r.items.splice(0,0,t);continue}}else t=n;t&&t.id&&r.add(t)}e[o]=r}i.each(UE._customizeUI,function(n,t){var u,i;if(n.id&&n.id!=f.key)return!1;u=n.execFn.call(f,f,t),u&&(i=n.index,i===undefined&&(i=r.items.length),r.add(u,i))}),this.toolbars=e},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox">'+(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+"</div></div>":"")+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">'+this.editor.getLang("clickToUpload")+'</div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div><div id="##_message_holder" class="%%-messageholder"></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td><td id="##_scale" class="%%-scale"><div class="%%-icon"></div></td></tr></table></div><div id="##_scalelayer"></div></div>'},showWordImageDialog:function(){this._dialogs.wordimageDialog.open()},renderToolbarBoxHtml:function(){for(var t=[],n=0;n<this.toolbars.length;n++)t.push(this.toolbars[n].renderHtml());return t.join("")},setFullScreen:function(n){var t=this.editor,i=t.container.parentNode.parentNode,o,s,f;if(this._fullscreen!=n){this._fullscreen=n,this.editor.fireEvent("beforefullscreenchange",n),u.editor.browser.gecko&&(o=t.selection.getRange().createBookmark());if(n){while(i.tagName!="BODY")s=u.editor.dom.domUtils.getComputedStyle(i,"position"),e.push(s),i.style.position="static",i=i.parentNode;this._bakscrollContainerOverflow=jQuery(this.editor.options.scrollContainer).css("overflow"),this._bakHtmlOverflow=document.documentElement.style.overflow,this._bakBodyOverflow=document.body.style.overflow,this._bakAutoHeight=this.editor.autoHeightEnabled,this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop),this._bakEditorContaninerWidth=t.iframe.parentNode.offsetWidth,this._bakAutoHeight&&(t.autoHeightEnabled=!1,this.editor.disableAutoHeight()),jQuery(this.editor.options.scrollContainer).css("overflow","hidden"),document.documentElement.style.overflow="hidden",window.scrollTo(0,window.scrollY),this._bakCssText=this.getDom().style.cssText,this._bakCssText1=this.getDom("iframeholder").style.cssText,t.iframe.parentNode.style.width="",this._updateFullScreen()}else{while(i.tagName!="BODY")i.style.position=e.shift(),i=i.parentNode;this.getDom().style.cssText=this._bakCssText,this.getDom("iframeholder").style.cssText=this._bakCssText1,this._bakAutoHeight&&(t.autoHeightEnabled=!0,this.editor.enableAutoHeight()),this._bakscrollContainerOverflow&&jQuery(this.editor.options.scrollContainer).css("overflow",this._bakscrollContainerOverflow),document.documentElement.style.overflow=this._bakHtmlOverflow,document.body.style.overflow=this._bakBodyOverflow,t.iframe.parentNode.style.width=this._bakEditorContaninerWidth+"px",window.scrollTo(0,this._bakScrollTop)}r.gecko&&t.body.contentEditable==="true"&&(f=document.createElement("input"),document.body.appendChild(f),t.body.contentEditable=!1,setTimeout(function(){f.focus(),setTimeout(function(){t.body.contentEditable=!0,t.fireEvent("fullscreenchanged",n),t.selection.getRange().moveToBookmark(o).select(!0),u.editor.dom.domUtils.remove(f),n&&window.scroll(0,0)},0)},0)),t.body.contentEditable==="true"&&(this.editor.fireEvent("fullscreenchanged",n),this.triggerLayout())}},_updateFullScreen:function(){if(this._fullscreen){var n=this.editor.options.scrollContainer||"body",t=jQuery(n).offset();this.getDom().style.cssText="border:0;position:absolute;left:0;top:"+(this.editor.options.topOffset||0)+"px;width:"+jQuery(n).width()+"px;height:"+jQuery(n).height()+"px;z-index:"+(this.getDom().style.zIndex*1+100),s.setViewportOffset(this.getDom(),{left:t.left,top:t.top}),this.editor.setHeight(jQuery(n).height()-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight-(this.editor.options.topOffset||0),!0);if(r.gecko)try{window.onresize()}catch(i){}}},_updateElementPath:function(){var u=this.getDom("elementpath"),r,t,n,i;if(this.elementPathEnabled&&(r=this.editor.queryCommandValue("elementpath"))){for(t=[],n=0;i=r[n];n++)t[n]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+n+'&quot;);">'+i+"</span>");u.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">'+this.editor.getLang("elementPathTip")+": "+t.join(" &gt; ")+"</div>"}else u.style.display="none"},disableElementPath:function(){var n=this.getDom("elementpath");n.innerHTML="",n.style.display="none",this.elementPathEnabled=!1},enableElementPath:function(){var n=this.getDom("elementpath");n.style.display="",this.elementPathEnabled=!0,this._updateElementPath()},_scale:function(){function y(){v=n.getXY(h),a||(a=t.options.minFrameHeight+p.offsetHeight+d.offsetHeight),u.style.cssText="position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:"+h.offsetWidth+"px;height:"+h.offsetHeight+"px;z-index:"+(t.options.zIndex+1);n.on(f,"mousemove",b);n.on(w,"mouseup",s);n.on(f,"mouseup",s)}function b(n){g();var t=n||window.event;k=t.pageX||f.documentElement.scrollLeft+t.clientX,nt=t.pageY||f.documentElement.scrollTop+t.clientY,c=k-v.x,l=nt-v.y,c>=tt&&(o=!0,u.style.width=c+"px"),l>=a&&(o=!0,u.style.height=l+"px")}function s(){o&&(o=!1,t.ui._actualFrameWidth=u.offsetWidth-2,h.style.width=t.ui._actualFrameWidth+"px",t.setHeight(u.offsetHeight-d.offsetHeight-p.offsetHeight-2,!0)),u&&(u.style.display="none"),g(),n.un(f,"mousemove",b),n.un(w,"mouseup",s),n.un(f,"mouseup",s)}function g(){r.ie?f.selection.clear():window.getSelection().removeAllRanges()}var f=document,t=this.editor,h=t.container,w=t.document,p=this.getDom("toolbarbox"),d=this.getDom("bottombar"),e=this.getDom("scale"),u=this.getDom("scalelayer"),o=!1,v=null,a=0,tt=t.options.minFrameWidth,k=0,nt=0,c=0,l=0,i=this;this.editor.addListener("fullscreenchanged",function(t,r){if(r)i.disableScale();else if(i.editor.options.scaleEnabled){i.enableScale();var u=i.editor.document.createElement("span");i.editor.body.appendChild(u),i.editor.body.style.height=Math.max(n.getXY(u).y,i.editor.iframe.offsetHeight-20)+"px",n.remove(u)}}),this.enableScale=function(){if(t.queryCommandState("source")==1)return;e.style.display="",this.scaleEnabled=!0;n.on(e,"mousedown",y)},this.disableScale=function(){e.style.display="none",this.scaleEnabled=!1,n.un(e,"mousedown",y)}},isFullScreen:function(){return this._fullscreen},postRender:function(){var n;for(o.prototype.postRender.call(this),n=0;n<this.toolbars.length;n++)this.toolbars[n].postRender();var f=this,t,r=u.editor.dom.domUtils,i=function(){clearTimeout(t),t=setTimeout(function(){f._updateFullScreen()})};r.on(window,"resize",i);f.addListener("destroy",function(){r.un(window,"resize",i),clearTimeout(t)})},showToolbarMsg:function(n,t){this.getDom("toolbarmsg_label").innerHTML=n,this.getDom("toolbarmsg").style.display="";if(!t){var i=this.getDom("upload_dialog");i.style.display="none"}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(n){return n?n.replace("~/",this.editor.options.UEDITOR_HOME_URL||""):""},triggerLayout:function(){var n=this.getDom();n.style.zoom=n.style.zoom=="1"?"100%":"1"}},i.inherits(f,u.editor.ui.UIBase),t={},UE.ui.Editor=function(r){var u=new UE.Editor(r),e;return u.options.editor=u,e=u.render,u.render=function(r){r.constructor===String&&(u.key=r,t[r]=u),i.domReady(function(){function t(){var o,c,t,l,a,h,i,s;for(u.setOpt({labelMap:u.options.labelMap||u.getLang("labelMap")}),new f(u.options),r&&(r.constructor===String&&(r=document.getElementById(r)),r&&r.getAttribute("name")&&(u.options.textarea=r.getAttribute("name")),r&&/script|textarea/ig.test(r.tagName)&&(o=document.createElement("div"),r.parentNode.insertBefore(o,r),c=r.value||r.innerHTML,u.options.initialContent=/^[\t\r\n ]*$/.test(c)?u.options.initialContent:c.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><"),r.className&&(o.className=r.className),r.style.cssText&&(o.style.cssText=r.style.cssText),/textarea/i.test(r.tagName)?(u.textarea=r,u.textarea.style.display="none"):r.parentNode.removeChild(r),r.id&&(o.id=r.id,n.removeAttributes(r,"id")),r=o,r.innerHTML="")),n.addClass(r,"edui-"+u.options.theme),u.ui.render(r),t=u.options,u.container=u.ui.getDom(),l=n.findParents(r,!0),a=[],i=0;s=l[i];i++)a[i]=s.style.display,s.style.display="block";for(t.initialFrameWidth?t.minFrameWidth=t.initialFrameWidth:(t.minFrameWidth=t.initialFrameWidth=r.offsetWidth,h=r.style.width,/%$/.test(h)&&(t.initialFrameWidth=h)),t.initialFrameHeight?t.minFrameHeight=t.initialFrameHeight:t.initialFrameHeight=t.minFrameHeight=r.offsetHeight,i=0;s=l[i];i++)s.style.display=a[i];r.style.height&&(r.style.height="");try{u.container.style.width=t.initialFrameWidth+(/%$/.test(t.initialFrameWidth)?"":"px")}catch(v){}u.container.style.zIndex=t.zIndex,e.call(u,u.ui.getDom("iframeholder")),u.fireEvent("afteruiready")}u.langIsReady?t():u.addListener("langReady",t)})},u},UE.getEditor=function(n,i){var r=t[n];return r||(r=t[n]=new UE.ui.Editor(i),r.render(n)),r},UE.delEditor=function(n){var i;(i=t[n])&&(i.key&&i.destroy(),delete t[n])},UE.registerUI=function(n,t,r,u){i.each(n.split(/\s+/),function(n){UE._customizeUI[n]={id:u,execFn:t,index:r}})}})(),UE.registerUI("message",function(n){function f(){var n=i.ui.getDom("toolbarbox");n&&(r.style.top=n.offsetHeight+3+"px"),r.style.zIndex=Math.max(i.options.zIndex,i.iframe.style.zIndex)+1}var s=u.editor.ui,o=s.Message,r,e=[],i=n;i.addListener("ready",function(){r=document.getElementById(i.ui.id+"_message_holder"),f(),setTimeout(function(){f()},500)}),i.addListener("showmessage",function(n,u){u=t.isString(u)?{content:u}:u;var s=new o({timeout:u.timeout,type:u.type,content:u.content,keepshow:u.keepshow,editor:i}),h=u.id||"msg_"+(+new Date).toString(36);return s.render(r),e[h]=s,s.reset(u),f(),h}),i.addListener("updatemessage",function(n,i,u){u=t.isString(u)?{content:u}:u;var f=e[i];f.render(r),f&&f.reset(u)}),i.addListener("hidemessage",function(n,t){var i=e[t];i&&i.hide()})}),UE.registerUI("autosave",function(n){var i=null,t=null;n.on("afterautosave",function(){clearTimeout(i),i=setTimeout(function(){t&&n.trigger("hidemessage",t),t=n.trigger("showmessage",{content:n.getLang("autosave.success"),timeout:2e3})},2e3)})})})()